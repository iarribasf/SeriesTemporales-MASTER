<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Iván Arribas (Depto. Análisis Económico. Universitat de València)" />


<title>Series Temporales: Procesos ARIMA</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>


<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Series Temporales</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01-Guia-curso.html">
    <span class="fa fa-graduation-cap"></span>
     
    Guía del curso
  </a>
</li>
<li>
  <a href="02-Logistica.html">
    <span class="fa fa-laptop"></span>
     
    Logística
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Diapos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Teoría</li>
    <li>
      <a href="03-01-Tema1.html">Tema 1: Introducción</a>
    </li>
    <li>
      <a href="03-02-Tema2.html">Tema 2: Alisado</a>
    </li>
    <li>
      <a href="03-03-Tema3.html">Tema 3: Procesos estocásticos</a>
    </li>
    <li>
      <a href="03-04-Tema4.html">Tema 4: ARIMA</a>
    </li>
    <li>
      <a href="03-05-Tema5.html">Tema 5: SARIMA</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Ejemplo de aplicación</li>
    <li>
      <a href="03-06-Ejemplo1.html">Ejemplo Tema 1</a>
    </li>
    <li>
      <a href="03-07-Ejemplo2.html">Ejemplo Tema 2</a>
    </li>
    <li>
      <a href="03-08-Ejemplo3.html">Ejemplo Tema 3</a>
    </li>
    <li>
      <a href="03-09-Ejemplo4.html">Ejemplo Tema 4</a>
    </li>
    <li>
      <a href="03-10-Ejemplo5.html">Ejemplo Tema 5</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otro ejemplo</li>
    <li>
      <a href="03-11-Ejemplo-Pasajeros.html">Ejemplo de Pasajeros</a>
    </li>
  </ul>
</li>
<li>
  <a href="04-Recursos-R.html">
    <span class="fa fa-code"></span>
     
    Recursos de R
  </a>
</li>
<li>
  <a href="05-Practica.html">
    <span class="fa fa-edit"></span>
     
    Practica
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R</li>
    <li>
      <a href="https://cran.r-project.org">Dónde está R</a>
    </li>
    <li>
      <a href="https://rstudio.com">Donde está RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Markdown</li>
    <li>
      <a href="https://bookdown.org/yihui/rmarkdown/">Markdown</a>
    </li>
    <li>
      <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otros</li>
    <li>
      <a href="https://www.r-bloggers.com">Blog sobre R</a>
    </li>
    <li>
      <a href="https://bookdown.org">Libros online que debes conocer</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Series Temporales: Procesos ARIMA</h1>
<h3 class="subtitle">Máster de Bioestadística (Modelización Estadística)</h3>
<h4 class="author">Iván Arribas (Depto. Análisis Económico. Universitat de València)</h4>

</div>


<div id="introducción" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>Los <strong>modelos ARIMA</strong> han mostrado ser uno se los métodos de ajuste de series temporales más valiosos desde que fueran formalizados en 1976 por Box y Jenkins, en su libro <a href="http://www.amazon.com/Time-Analysis-Forecasting-George-Box/dp/0470272848">Time series analysis, forecasting and control</a>. Además, dieron las pautas a seguir en el ajuste de una serie temporal para alcanzar buenas predicciones (véase epígrafe 5).</p>
<p>En este tema y el siguiente, definiremos estos procesos y aprenderemos a identificarlos, estimarlos y hacer predicciones.</p>
<p><strong>Los procesos ARIMA son ahora el tronco de una amplia familia de procesos</strong> que requieren menos hipótesis para su aplicación: ARCH, GARCH, NGARCH, IGARCH, EGARCH, GARCH-M, QGARCH, GJR-GARCH, TGARCH, fGARCH…</p>
<p><strong>Los procesos ARIMA y los métodos de Alisado Exponencial son complementarios</strong>:</p>
<ul>
<li>Los modelos de Alisado lineales son casos especiales de modelos Arima,</li>
<li>Los modelos de Alisado no lineales no tienen su contrapartida en modelos Arima</li>
<li>Muchos modelos Arima no tiene contrapartida en los modelos de Alisado.</li>
</ul>
<p><br />
<br />
</p>
</div>
<div id="operador-retardo" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Operador Retardo</h1>
<p>Definimos el <strong>operador retardo</strong> <span class="math inline">\(L\)</span> como <span class="math inline">\(Ly_t = y_{t-1}\)</span>, es decir, retrasa un periodo la serie. En inglés se denomina <em>lag operator</em> (L) o <em>backward shift</em> (B)</p>
<p>Así, se tiene que <span class="math display">\[L^k y_t  = y_{t-k}.\]</span> y por tanto que <span class="math display">\[
\begin{aligned}
  \nabla y_t &amp; =  y_t - y_{t-1} = y_t - Ly_t = (1-L)y_t \\
  \nabla^d y_t &amp; =  (1-L)^d y_t \\
  \nabla_m y_t &amp; =  (1-L^m) y_t \\
  \nabla_m^D y_t &amp; =  (1-L^m)^D y_t
\end{aligned}
\]</span></p>
La siguiente tabla muestra un sencillo ejemplo del efecto del operador retardo sobre la serie <span class="math inline">\(y_t\)</span>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">lag1_y</th>
<th align="right">lag2_y</th>
<th align="right">lag3_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<p><br />
<br />
</p>
</div>
<div id="hipótesis" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Hipótesis</h1>
<p><br />
</p>
<div id="sobre-el-proceso-estocástico" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Sobre el proceso estocástico</h2>
<p>A lo largo de este tema asumiremos que:</p>
<ul>
<li><p><span class="math inline">\(\{y_t\}_{t=1}^T\)</span> es una realización de un proceso estocástico desconocido.</p></li>
<li><p>El proceso estocástico es <strong>estacionario en sentido amplio</strong>: <span class="math display">\[E[y_t]  = \mu &lt; \infty \;\;\; \forall t,\]</span> <span class="math display">\[Cov[y_t, y_{t-k}]  = \gamma_k  \;\;\; \forall k.\]</span></p></li>
<li><p>El proceso estocástico es <strong>ergódico</strong>, o su condición suficiente: <span class="math display">\[\lim_{k \rightarrow \infty} \gamma_k  = 0.\]</span></p></li>
</ul>
<p><br />
</p>
</div>
<div id="sobre-el-vector-de-residuos" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Sobre el vector de residuos</h2>
<p>También asumiremos que el residuo del modelo <span class="math inline">\(\{\varepsilon_t\}_{t=1}^T\)</span> es <strong>ruido blanco</strong>:</p>
<ul>
<li>Media cero: <span class="math inline">\(E[\varepsilon_t]=0\)</span></li>
</ul>
<ul>
<li>Varianza constante (homocedástico): <span class="math inline">\(E[\varepsilon_t^2]=\sigma^2\)</span></li>
</ul>
<ul>
<li>Incorrelación: <span class="math inline">\(E[\varepsilon_t \cdot \varepsilon_{s}]=0 \;\;\; t \neq s\)</span></li>
</ul>
<ul>
<li>Distribución Normal: <span class="math inline">\(\varepsilon_t \sim N\)</span></li>
</ul>
<p>Es decir, <span class="math inline">\(\varepsilon_t \sim N(0,\sigma^2)\)</span> i.i.d.</p>
<p><br />
<br />
</p>
</div>
</div>
<div id="procesos-arima" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Procesos ARIMA</h1>
<p>ARIMA surge de combinar las siglas de tres procesos diferentes: <strong>AR</strong> de AutoRegresive, <strong>I</strong> de Integrated y <strong>MA</strong> de Moving Average. Veamos cada uno de estos tres conceptos por separado y luego su combinación.</p>
<p><br />
</p>
<div id="procesos-autorregresivos-arp" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Procesos autorregresivos AR(p)</h2>
<div id="definición" class="section level3 unnumbered">
<h3 class="unnumbered">Definición</h3>
<p>El modelo general <strong>autorregresivo de orden p</strong>, <span class="math inline">\(y_t \sim AR(p)\)</span> viene definido por <span class="math display">\[y_t=c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \ldots + \phi_p y_{t-p} + \varepsilon_t,\]</span> que usando el operador retardo queda <span class="math display">\[(1 - \phi_1 L - \phi_2 L^2 - \ldots - \phi_p L^p)y_t = c + \varepsilon_t\]</span></p>
</div>
<div id="propiedades" class="section level3 unnumbered">
<h3 class="unnumbered">Propiedades</h3>
<p>El proceso es <strong>estacionario</strong> si quedan fuera del círculo de radio la unidad todas las raíces del polinomio autorregresivo <span class="math display">\[\Phi_p(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p.\]</span></p>
<p>Es <strong>invertible</strong> siempre.</p>
<ul>
<li><p>Podemos transformar el proceso AR(p) en un proceso donde <span class="math inline">\(y_t\)</span> depende de la suma infinita de errores pasados, MA(<span class="math inline">\(\infty\)</span>).</p></li>
<li><p>Si conocemos las p primeras autocorrelaciones, podemos estimar los p parámetros del modelo. Por ejemplo, para un proceso AR(2) se verifica que: <span class="math display">\[\rho_1 = \phi_1 + \phi_2 \rho_1\]</span> <span class="math display">\[\rho_2 = \phi_1 \rho_1 + \phi_2\]</span></p>
<p>Estas ecuaciones se denominan <strong>Ecuaciones de Yule-Walker</strong>.</p>
<p>Observa que si tenemos una estimación de las dos primeras autocorrelaciones, estas ecuaciones nos permiten obtener una estimación de los coeficientes del proceso AR(2) como una aplicación del método de los momentos.</p></li>
</ul>
<p><strong>Sobre todo</strong>,</p>
<ul>
<li>La FAC del proceso decae <em>exponencialmente</em> a partir del orden p</li>
<li>La FACP verifica que los p primeros valores son no nulos y todos los demás valen cero.</li>
</ul>
</div>
<div id="ejemplos" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplos</h3>
<ul>
<li><span class="math inline">\(y_t \sim AR(1): \;\;y_t = c + \phi_1 y_{t-1} + \varepsilon_t\)</span> o <span class="math inline">\((1 - \phi_1 L)y_t = c + \varepsilon_t\)</span></li>
<li><span class="math inline">\(y_t \sim AR(2): \;\;y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \varepsilon_t\)</span> o <span class="math inline">\((1 - \phi_1 L - \phi_2 L^2)y_t = c + \varepsilon_t\)</span></li>
</ul>
</div>
<div id="simulación-de-procesos-autorregresivos" class="section level3 unnumbered">
<h3 class="unnumbered">Simulación de procesos autorregresivos</h3>
<p>Las figuras 1 y 2 muestran dos simulaciones del proceso AR(1) <span class="math inline">\(y_t = 0.8y_{t-1} + \varepsilon_t\)</span>, la primera con 20 datos y la segunda con 100 datos. En ambos casos <span class="math inline">\(\varepsilon_t\)</span> se distribuye como una normal con media cero y varianza la unidad. (Todas las simulaciones se han realizado con la función <code>arima.sim</code> de la librería <code>stats</code>.)</p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /><img src="03-04-Tema4_files/figure-html/unnamed-chunk-3-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Las figuras 3 y 4 muestran dos simulaciones de procesos AR(2), ambas con 100 datos. En la primera se tiene que <span class="math inline">\(y_t = 0.5y_{t-1} + 0.4 y_{t-2}+ \varepsilon_t\)</span> y en la segunda <span class="math inline">\(y_t = 0.9y_{t-1} - 0.5 y_{t-2}+ \varepsilon_t\)</span>.</p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;" /><img src="03-04-Tema4_files/figure-html/unnamed-chunk-4-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
</div>
<div id="procesos-en-medias-móviles-maq" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Procesos en medias móviles MA(q)</h2>
<div id="definición-1" class="section level3 unnumbered">
<h3 class="unnumbered">Definición</h3>
<p>El modelo general <strong>en medias móviles de orden q</strong>, <span class="math inline">\(y_t \sim MA(q)\)</span> viene definido por <span class="math display">\[y_t=c + \varepsilon_t + \theta_1 \varepsilon_{t-1} + \theta_2 \varepsilon_{t-2} + \ldots + \theta_q \varepsilon_{t-q},\]</span> que usando el operador retardo queda <span class="math display">\[y_t = c + (1 + \theta_1 L + \theta_2 L^2 + \ldots + \theta_q L^q) \varepsilon_t\]</span></p>
</div>
<div id="propiedades-1" class="section level3 unnumbered">
<h3 class="unnumbered">Propiedades</h3>
<p>El proceso es <strong>invertible</strong> si quedan fuera del círculo de radio la unidad todas las raíces del polinomio en medias móviles <span class="math display">\[\Theta_q(z) = 1 + \theta_1 z + \theta_2 z^2 + \ldots + \theta_q z^q.\]</span></p>
<ul>
<li>Podemos transformar el proceso MA(q) en un proceso AR(<span class="math inline">\(\infty\)</span>).</li>
<li>Si conocemos las q primeras autocorrelaciones, podemos estimar los q parámetros del modelo. Por ejemplo, para un proceso MA(2) se verifica que: <span class="math display">\[\rho_1 = \frac{\theta_1 + \theta_1\theta_2}{1 + \theta_1^2 + \theta_2^2}\]</span> <span class="math display">\[\rho_2 = \frac{\theta_2}{1 + \theta_1^2 + \theta_2^2}\]</span></li>
</ul>
<p>Es <strong>estacionario</strong> siempre.</p>
<p><strong>Sobre todo</strong>,</p>
<ul>
<li>La FAC verifica que los q primeros valores son no nulos y todos los demás valen cero.</li>
<li>La FACP decae <em>exponencialmente</em> a partir del orden q.</li>
</ul>
</div>
<div id="ejemplos-1" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplos</h3>
<ul>
<li><span class="math inline">\(y_t \sim MA(1): \;\;y_t = c + \varepsilon_t + \theta_1 \varepsilon_{t-1}\)</span> o <span class="math inline">\(y_t = c + (1 + \theta_1 L)\varepsilon_t\)</span></li>
<li><span class="math inline">\(y_t \sim MA(2): \;\;y_t=c + \varepsilon_t + \theta_1 \varepsilon_{t-1} + \theta_2 \varepsilon_{t-2}\)</span> o <span class="math inline">\(y_t = c + (1 + \theta_1 L + \theta_2 L^2)\varepsilon_t\)</span></li>
</ul>
</div>
<div id="simulación-de-procesos-en-medias-móviles" class="section level3 unnumbered">
<h3 class="unnumbered">Simulación de procesos en medias móviles</h3>
<p>Las figuras 5 y 6 ofrecen dos simulaciones del proceso MA(1) <span class="math inline">\(y_t = 0.8\varepsilon_{t-1} + \varepsilon_t\)</span>, la primera con 20 datos y la segunda con 100 datos. En ambos casos <span class="math inline">\(\varepsilon_t\)</span> se distribuye como una normal con media cero y varianza la unidad.</p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;" /><img src="03-04-Tema4_files/figure-html/unnamed-chunk-6-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Veamos ahora dos simulaciones de procesos MA(2), ambas con 100 datos (figuras 7 y 8). En la primera se tiene que <span class="math inline">\(y_t = 0.5\varepsilon_{t-1} + 0.4 \varepsilon_{t-2}+ \varepsilon_t\)</span> y en la segunda <span class="math inline">\(y_t = 0.9\varepsilon_{t-1} - 0.5 \varepsilon_{t-2}+ \varepsilon_t\)</span>.</p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;" /><img src="03-04-Tema4_files/figure-html/unnamed-chunk-7-2.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
</div>
<div id="procesos-armapq" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> Procesos ARMA(p,q)</h2>
<div id="definición-2" class="section level3 unnumbered">
<h3 class="unnumbered">Definición</h3>
<p>El modelo general <span class="math inline">\(y_t \sim ARMA(p,q)\)</span> viene dado por <span class="math display">\[y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \ldots + \phi_p y_{t-p}  + 
        \theta_1 \varepsilon_{t-1} + \theta_2 \varepsilon_{t-2} + \ldots +
        \theta_q \varepsilon_{t-q}+ \varepsilon_t,\]</span> que usando el operador retardo queda <span class="math display">\[(1 - \phi_1 L - \ldots - \phi_p L^p)y_t = c + (1 + \theta_1 L + \ldots + \theta_q L^q) \varepsilon_t.\]</span></p>
<p>El proceso más simple es el ARMA(1,1), <span class="math inline">\(y_t = c + \phi_1 y_{t-1} + \theta_1 \varepsilon_{t-1} + \varepsilon_{t}\)</span>.</p>
</div>
<div id="propiedades-2" class="section level3 unnumbered">
<h3 class="unnumbered">Propiedades</h3>
<p>El proceso es <strong>estacionario</strong> si quedan fuera del círculo de radio la unidad todas las raíces del polinomio <span class="math display">\[\Phi_p(z) = 1 - \phi_1 z - \phi_2 z^2 - \ldots - \phi_p z^p.\]</span> El proceso es <strong>invertible</strong> si quedan fuera del círculo de radio la unidad todas las raíces del polinomio <span class="math display">\[\Theta_q(z) = 1 + \theta_1 z + \theta_2 z^2 + \ldots + \theta_q z^q.\]</span> <strong>Sobre todo</strong>,</p>
<ul>
<li>La FAC decae exponencialmente a partir del orden p.</li>
<li>La FACP decae exponencialmente a partir del orden q.</li>
</ul>
</div>
<div id="ejemplos-2" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplos</h3>
<ul>
<li><span class="math inline">\(y_t \sim ARMA(1, 1): \;\;y_t = c + \phi_1 y_{t-1} + \theta_1 \varepsilon_{t-1} + \varepsilon_{t}\)</span> o <span class="math inline">\((1 - \phi_1 L)y_t = c + (1 + \theta_1 L)\varepsilon_t\)</span>.</li>
<li><span class="math inline">\(y_t \sim ARMA(0, 0): \;\;y_t = c + \varepsilon_{t}\)</span>. Si <span class="math inline">\(c = 0\)</span>, a este proceso se le denomina <strong>ruido blanco</strong>.</li>
</ul>
</div>
<div id="simulación-de-procesos-arma" class="section level3 unnumbered">
<h3 class="unnumbered">Simulación de procesos ARMA</h3>
<p>Las figuras 9 a 11 muestran las FAC y FACP de tres simulaciones de tamaño 200 para procesos ARMA(1,1), ARMA(2,1) y ARMA(1,2). En todos los casos <span class="math inline">\(\varepsilon_t\)</span> se distribuye como una normal con media cero y varianza la unidad.</p>
<p><span class="math inline">\(y_t = 0.7y_{t-1} + 0.6\varepsilon_{t-1} + \varepsilon_t\)</span></p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(y_t = 0.7y_{t-1}- 0.5y_{t-2} + 0.6\varepsilon_{t-1} + \varepsilon_t\)</span></p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(y_t = 0.6y_{t-1} + 0.5\varepsilon_{t-1} + 0.3\varepsilon_{t-2} + \varepsilon_t\)</span></p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
</div>
<div id="proceso-arimapdq" class="section level2" number="4.4">
<h2 number="4.4"><span class="header-section-number">4.4</span> Proceso ARIMA(p,d,q)</h2>
<p><strong>Si la serie <span class="math inline">\(y_t\)</span> no es estacionaria pero tras diferenciarla <span class="math inline">\(d\)</span> veces se hace estacionaria, diremos que la serie es integrada de orden <span class="math inline">\(d\)</span></strong>: <span class="math inline">\(y_t \sim I(d)\)</span>. Por tanto,</p>
<ul>
<li>una serie estacionaria se indicará como <span class="math inline">\(y_t \sim I(0)\)</span></li>
<li><span class="math inline">\(y_t \sim I(d)\)</span> es equivalente a <span class="math inline">\(\nabla^d y_t = (1 - L)^d y_t \sim I(0)\)</span></li>
</ul>
<p>Una serie <span class="math inline">\(y_t\)</span> sigue un proceso <strong><span class="math inline">\(ARIMA(p,d,q)\)</span></strong> si:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(y_t \sim I(d)\)</span> (hay que diferenciarla <span class="math inline">\(d\)</span> veces para hacerla estacionaria), y</li>
<li><span class="math inline">\(\nabla^d y_t \sim ARMA(p,q)\)</span>.</li>
</ol>
<p>Entonces, podemos escribir: <span class="math display">\[\begin{equation*}
\begin{array}{c@{\qquad}c@{\quad}ccc}
  y_t \sim  ARIMA(p,d,q): &amp; (1 - \phi_1 L - \ldots - \phi_p L^p) &amp; (1- L)^d y_t &amp; = &amp; c + (1 + \theta_1 L + \ldots + \theta_q L^q) \varepsilon_t \\ 
                          &amp; \uparrow                            &amp; \uparrow      &amp;   &amp; \uparrow \\
                          &amp; AR(p)                               &amp; I(d)          &amp;   &amp; MA(q) 
\end{array}
\end{equation*}\]</span></p>
<div id="ejemplos-3" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplos</h3>
<ul>
<li><span class="math inline">\(y_t \sim ARIMA(1, 1, 1): \;\;(1 - \phi_1 L)(1- L) y_t = c + (1 + \theta_1 L) \varepsilon_t\)</span> o <span class="math inline">\(y_t = c + y_{t-1} + \phi_1(y_{t-1} - y_{t-2}) + \theta_1 \varepsilon_{t-1} + \varepsilon_t\)</span>.</li>
<li><span class="math inline">\(y_t \sim ARIMA(0, 1, 0): \;\;(1- L) y_t = c + \varepsilon_t\)</span> o <span class="math inline">\(y_t = c + y_{t-1} + \varepsilon_t\)</span>. Si <span class="math inline">\(c=0\)</span>, tenemos un <strong>paseo aleatorio</strong>; si <span class="math inline">\(c \neq 0\)</span>, tenemos un <strong>paseo aleatorio con deriva</strong>.</li>
</ul>
</div>
<div id="simulación-de-procesos-no-estacionarios" class="section level3 unnumbered">
<h3 class="unnumbered">Simulación de procesos no estacionarios</h3>
<p>Veamos la FAC de tres series simuladas no estacionarias: un paseo aleatorio, un paseo aleatorio con deriva y un modelo lineal. Sus FAC son indistinguibles, pero los tres casos revelan claramente su carácter no estacionario.</p>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="aproximación-de-box-jenkins" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Aproximación de Box-Jenkins</h1>
<p>La siguiente figura muestra el flujo de procesos asociado a la modelización por modelos ARIMA, con cuatro grandes áreas:</p>
<ul>
<li><p><strong>Identificación</strong>, que requiere primero transformar la serie para que sea estacionaria y ergódica, para después identificar los valores de p y q.</p>
<p>La FAC y la función de autocorrelación parcial teóricas son diferentes en cada tipo de proceso. Idealmente, su estimación a partir de la serie temporal podría servir de ayuda en la identificación del proceso estocástico. En la práctica, la funciones estimadas son tan diferentes de las teóricas que resultan de muy poca ayuda.</p>
<p>Haremos uso de algunas funciones de <em>auto</em> identificación que nos ayudaran en este punto.</p></li>
<li><p><strong>Estimación</strong> de los parámetros del modelo, incluidas las variables de intervención y obtención del error. El método usual de estimación de los parámetros es por máxima verosimilitud.</p></li>
<li><p><strong>Validación</strong> de las hipótesis sobre el residuo, contraste de significatividad de los parámetros estimados y comprobación de que no hay más intervención.</p>
<p>Si la validación no se pasa, puede ser necesario volver al proceso inicial y realizar una nueva identificación del modelo.</p></li>
<li><p><strong>Predicción</strong> e interpretación del modelo válido. Si las predicciones se alejan de los valores reales más de lo esperado o presentan sesgo, puede ser necesario identificar y estimar un nuevo modelo.</p></li>
</ul>
<p><img src="imagenes/BoxJenkins.png" alt="Aproximación Box-Jenkins" /></p>
<p><br />
<br />
</p>
</div>
<div id="ejemplos-4" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Ejemplos</h1>
<p><br />
</p>
<div id="títulos-de-libros-y-panfletos" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Títulos de libros y panfletos</h2>
<p>Vamos a aplicar la metodología de Box-Jenkins a la serie Libros (número de títulos publicados anualmente en España desde 1993 hasta 2018).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>libros <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/libros.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>libros <span class="ot">&lt;-</span> <span class="fu">ts</span>(libros[, <span class="dv">2</span>], <span class="at">start =</span> <span class="dv">1993</span>, <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(libros,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 13. Títulos publicados&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="transformación-de-la-serie" class="section level3 unnumbered">
<h3 class="unnumbered">Transformación de la serie</h3>
<p>El primer paso es transformar la serie original para que sea estacionaria. En el tema 3 ya vimos que la primera diferencia de la serie Libros es estacionaria y ergódica. Es decir, <span class="math inline">\(d=1\)</span> o <span class="math inline">\(libros_t \sim I(1)\)</span>. Como recordatorio, la figura 14 muestra la gráfica temporal y la FAC para la serie original y su primera diferencia.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(libros, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Libros&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">diff</span>(libros), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Diferencia libros&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(libros, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(<span class="fu">diff</span>(libros), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="identificación" class="section level3 unnumbered">
<h3 class="unnumbered">Identificación</h3>
<p>Tras diferenciar la serie, vamos a identificar los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a partir de las FAC y FACP de la serie diferenciada (figura 15).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtsdisplay</span>(<span class="fu">diff</span>(libros), <span class="at">main =</span> <span class="st">&quot;Figura 15. Libros (primera diferencia)&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-17-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Observamos que:</p>
<ul>
<li>En la FAC ninguna autocorrelación sobrepasa las líneas que marcan el intervalo de confianza al 95%.</li>
<li>En la FACP tampoco las autocorrelaciones parciales sobrepasan el intervalo de confianza.</li>
</ul>
<p>Parece, por tanto, ruido blanco, <span class="math inline">\(p=q=0\)</span>. La identificación inicial es <span class="math inline">\(libros_t \sim ARIMA(0,1,0)\)</span>, paseo aleatorio, que inicialmente asumiremos con deriva: <span class="math display">\[libros_t = c + libros_{t-1} + \varepsilon_t\]</span></p>
</div>
<div id="estimación" class="section level3 unnumbered">
<h3 class="unnumbered">Estimación</h3>
<p>Aunque existe la función <code>arima</code> de <code>stats</code>, vamos a usar la función <code>Arima</code> de la librería <code>forecast</code> para estimar el modelo identificado por ser más versátil. El argumento <code>order</code> indica los valores de (p, d , q) como un vector y el argumento lógico <code>include.constant</code> fuerza a que se incluya la constante <span class="math inline">\(c\)</span> en el modelo. (Mira en la ayuda de la función <code>Arima</code> la diferencia entre los argumentos <code>include.mean</code>, <code>include.drift</code> e <code>include.constant</code>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>arima010 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(libros, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>arima010</span></code></pre></div>
<pre><code>Series: libros 
ARIMA(0,1,0) with drift 

Coefficients:
         drift
       856.880
s.e.  1190.255

sigma^2 estimated as 36893303:  log likelihood=-252.76
AIC=509.51   AICc=510.06   BIC=511.95</code></pre>
<p>La deriva no parece ser significativa, dado que su valor estimado no es mayor que dos veces el error estándar (s.e.). Una forma rápida, aunque imprecisa, de determinar si un coeficiente es relevante (significativo) es compararlo con su error estándar (standard error, s.e). Si el coeficiente es mayor que dos veces su error estándar, hay evidencia de que es significativo. En la tabla <code>Coefficients</code> tienes en la primera fila el nombre de los coeficientes (<code>ar</code> en lugar de <span class="math inline">\(\phi\)</span> y <code>ma</code> en lugar de <span class="math inline">\(\theta\)</span>; su valor aparece en la segunda fila de la tabla; y los errores estándar en la tercera fila (encabezada por s.e.). Con esta regla, parece que la constante no es significativa.</p>
<p>Ahora bien, a fin de poner un poco de <em>objetividad</em> en esta decisión, podemos aplicar la prueba de Wald, que permite contrastar si un subconjunto de coeficientes es significativo (se precisa la librería <code>aod</code>). Esta función requiere de tres argumentos: el vector de coeficientes (<code>b</code>), su matriz de covarianzas (<code>Sigma</code>) y la posición de los coeficientes cuya significatividad conjunta deseamos contrastar (<code>Terms</code>). Los dos primeros argumentos los podemos obtener del objeto <code>arima010</code> con las funciones <code>coef</code> y <code>vcov</code>.</p>
<p>Vamos a usar la función <code>test.wald</code> para contrastar si la contante (primer y único coeficiente del modelo) es significativo.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima010), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima010), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Terms =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 0.52, df = 1, P(&gt; X2) = 0.47</code></pre>
<p>Como el valor de p, igual a 0.472 es mayor que la significatividad <span class="math inline">\(\alpha =\)</span> 0.05, se concluye que la constante no es significativa, no hay deriva.</p>
<p>Re-estimamos el modelo como un paseo aleatorio sin deriva,</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>arima010 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(libros, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">include.constant =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>arima010</span></code></pre></div>
<pre><code>Series: libros 
ARIMA(0,1,0) 

sigma^2 estimated as 36151817:  log likelihood=-253.01
AIC=508.03   AICc=508.2   BIC=509.25</code></pre>
<p>Nuestro modelo estimado es: <span class="math inline">\(\widehat{libros}_t = libros_{t-1}\)</span> ¡el método ingenuo I!</p>
</div>
<div id="validación" class="section level3 unnumbered">
<h3 class="unnumbered">Validación</h3>
<p>Veamos si el residuo verifica todas las hipótesis indicadas en el epígrafe 3.2</p>
<div id="media-cero" class="section level4 unnumbered">
<h4 class="unnumbered">Media cero</h4>
<p>No se puede contrastar si el residuo tiene <strong>media cero</strong>, pero el error medio es <span class="math inline">\(ME=\)</span> 825.49, relativamente bajo en comparación con el valor medio de la serie.</p>
<p>Además, tenemos las diferentes medidas de bondad del ajuste. En media nos equivocamos en 5896 títulos (RMSE) y el error porcentual medio (MAPE) es 7%.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima010)</span></code></pre></div>
<pre><code>                 ME    RMSE     MAE  MPE MAPE MASE  ACF1
Training set 825.49 5895.88 4450.03 1.23 7.02 0.96 -0.04</code></pre>
<p><br />
</p>
</div>
<div id="incorrelación" class="section level4 unnumbered">
<h4 class="unnumbered">Incorrelación</h4>
<p>Lo veremos con el test de Box-Ljung</p>
<ul>
<li>La hipótesis nula es <span class="math inline">\(H_0: \rho_1 = ... = \rho_k = 0\)</span></li>
<li>El valor de p = 0.895 es mayor que el nivel de significatividad 0.05. No se rechaza la hipótesis de incorrelación, hasta el orden <span class="math inline">\(k = 2\)</span>.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima010)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error, <span class="at">lag =</span> <span class="dv">2</span>,<span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error
X-squared = 0.22095, df = 2, p-value = 0.8954</code></pre>
<p>La elección de dos retardos para la prueba, fijado con el parámetros <code>lag = 2</code>, es bastante arbitraria. Sería mejor realizar la prueba para un rango de valores de <span class="math inline">\(k\)</span>:</p>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">valor.de.p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.828</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.895</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.965</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.989</td>
</tr>
</tbody>
</table>
</div>
<p><br />
</p>
</div>
<div id="homocedasticidad-varianza-constante" class="section level4 unnumbered">
<h4 class="unnumbered">Homocedasticidad (varianza constante)</h4>
<p>Lo veremos con el test de Box-Ljung para el residuo al cuadrado. La hipótesis nula seria que las primeras <span class="math inline">\(k\)</span> autocorrelaciones estimadas sobre el cuadrado del residuo son cero.</p>
<p>El valor de p = 0.405 es mayor que el nivel de significatividad 0.05. No se rechaza la hipótesis de homocedasticidad, hasta el orden 2.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error^2
X-squared = 1.8092, df = 2, p-value = 0.4047</code></pre>
<p>De nuevo, la elección de dos retardos es totalmente arbitraria y sería mejor realizar la prueba para un rango de valores de <span class="math inline">\(k\)</span>.</p>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">valor.de.p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.399</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.405</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.311</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.137</td>
</tr>
</tbody>
</table>
</div>
<p><br />
</p>
</div>
<div id="normalidad" class="section level4 unnumbered">
<h4 class="unnumbered">Normalidad</h4>
<p>Recuerda que todos las pruebas de normalidad son muy sensibles al tamaño de la muestra. Siempre es recomendable empezar por un análisis gráfico (histograma, gráfico PP, gráfico QQ).</p>
<p>Sin embargo, cuando es necesario un criterio más objetivo o se precisa de un proceso automático, entonces si la muestra es reducida (30 a 50 observaciones según autores) se aplica la prueba de Shapiro-Wilk; en otro caso se aplica la prueba de Jarque-Bera (<code>tseries</code>) o Kolmogorov-Smirnov. En nuestro ejemplo, con 26 datos, lo correcto es aplicar la prueba de Shapiro-Wilk. También hemos aplicado Jarque-Bera para que veas como la conclusión difiere según la prueba empleada.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(error)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  error
W = 0.90133, p-value = 0.01676</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(error)</span></code></pre></div>
<pre><code>
    Jarque Bera Test

data:  error
X-squared = 3.7073, df = 2, p-value = 0.1567</code></pre>
<p><br />
</p>
</div>
<div id="intervención" class="section level4 unnumbered">
<h4 class="unnumbered">Intervención</h4>
<p>Se analiza si para algún año se observa un error atípico (por ejemplo 3 veces superior al error estándar). La figura 16 muestra que en este caso en dos periodos, años 2008 y 2013, el residuo sobrepasa los dos errores estándar pero queda lejos de los tres errores estándar así que asumiremos que no hay valores atípicos.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 16. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1993</span>, <span class="dv">2019</span>, <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-28-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="predicción" class="section level3 unnumbered">
<h3 class="unnumbered">Predicción</h3>
<p>Una vez validado el modelo podemos pasar a realizar <strong>predicciones</strong>, en este caso a 5 años vista.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>parima010 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima010, <span class="at">h =</span> <span class="dv">5</span>, <span class="at">level =</span> <span class="dv">95</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>parima010</span></code></pre></div>
<pre><code>     Point Forecast    Lo 95    Hi 95
2019          62180 50395.45 73964.55
2020          62180 45514.12 78845.88
2021          62180 41768.55 82591.45
2022          62180 38610.89 85749.11
2023          62180 35828.94 88531.06</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(parima010, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Títulos&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figure 17. Libros (1993-2018) y predicción (2019-2023)&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1993</span>, <span class="dv">2023</span>, <span class="dv">2</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-30-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>La figura 17 muestra la serie, la previsión y el intervalo de confianza al 95%. La predicción es constante e igual al último dato. En las series diferenciadas el intervalo de confianza de las predicciones crece muy rápidamente porque los errores se van acumulando sin ningún tipo de amortiguamiento.</p>
</div>
<div id="identificación-automática" class="section level3 unnumbered">
<h3 class="unnumbered">Identificación automática</h3>
<p>El paquete <code>forecast</code> dispone de la función <code>auto.arima()</code> que localiza el mejor modelo basándose en el AIC corregido para pequeñas muestras (<code>AICc</code>). No hay que fiarse ciegamente de los resultados de esta función, pero ayuda en la identificación. Básicamente el algoritmo seguido es el siguiente:</p>
<ol style="list-style-type: decimal">
<li>Determina el orden de diferenciación regular <span class="math inline">\(0 \leq d \leq 2\)</span> usando la función <code>ndiffs</code>, que usa la prueba KPSS repetidas veces.</li>
<li>Tras diferenciar la serie:
<ul>
<li>se estiman una serie de modelos básicos predeterminados.</li>
<li>se usa el criterio AICc para seleccionar el mejor de estos modelos.</li>
<li>a partir del modelo seleccionado, se hacen pequeñas variaciones modificando en una unidad <em>p</em> y <em>q</em> y añadiendo/quitando la constante y se vuelve a seleccionar el mejor de los nuevos modelos.</li>
</ul></li>
<li>Se repite el paso 2 hasta que no se puede mejorar el AICc.</li>
</ol>
<p>Cuando usemos esta función, debemos tener cuenta que:</p>
<ul>
<li>La función <code>auto.arima</code> no permite contante si la suma de las diferenciaciones es 2 o superior.</li>
<li>Si se desea hacer una búsqueda exhaustiva entre todos los posibles modelos se debe usar el argumento <code>stepwise = FALSE</code>.</li>
<li>Si se desea que el cálculo de AICc sea exacto (por defecto para ganar tiempo calcula una aproximación), se debe usar el argumento <code>approximation = FALSE</code>.</li>
<li>Si se desea ver para todos los modelos analizados el valor de AICc, se debe incluir el argumento <code>trace = TRUE</code>.</li>
</ul>
<p>La función <code>auto.arima</code> tiende a sobre-parametrizar los modelos y es muy recomendable <em>ayudarla</em> indicando las diferenciaciones, los posibles valores extremos…</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(libros, <span class="at">trace =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>
 ARIMA(2,1,2) with drift         : Inf
 ARIMA(0,1,0) with drift         : 510.0603
 ARIMA(1,1,0) with drift         : 512.623
 ARIMA(0,1,1) with drift         : 512.6173
 ARIMA(0,1,0)                    : 508.2017
 ARIMA(1,1,1) with drift         : Inf

 Best model: ARIMA(0,1,0)                    </code></pre>
<pre><code>Series: libros 
ARIMA(0,1,0) 

sigma^2 estimated as 36151817:  log likelihood=-253.01
AIC=508.03   AICc=508.2   BIC=509.25</code></pre>
<p>Observa como la identificación automática da como mejor modelo un ARIMA(0,1,0), que es el habíamos identificado, y como segunda opción el mismo modelo, pero con deriva.</p>
<p><br />
</p>
</div>
</div>
<div id="aforo-de-vehículos" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Aforo de vehículos</h2>
<p>Vamos a aplicar de nuevo la metodología de Box-Jenkins a la serie <strong>aforo de vehículos</strong> por Oropesa, carretera N-340, km. 996,48 (fuente Ministerio de Fomento). La serie es anual de 1960 a 2018 (59 datos).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>aforo <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/aforo_oropesa.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>aforo <span class="ot">&lt;-</span> <span class="fu">ts</span>(aforo, <span class="at">start =</span> <span class="dv">1960</span>, <span class="at">freq =</span> <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(aforo, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Vehículos (000)&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 18. Aforo de vehículos en N-340, Oropesa&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-32-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>En este ejemplo incluiremos, por primera vez, intervención y veremos como <strong>la presencia de valores atípicos puede distorsionar el proceso de identificación</strong>. Por ello, es conveniente realizar en paralelo ambas actividades, identificar el proceso y detectar valores atípicos.</p>
<div id="transformación-de-la-serie-1" class="section level3 unnumbered">
<h3 class="unnumbered">Transformación de la serie</h3>
<p>La figura 18 muestra que la serie Aforo no es estacionaria. Así, el primer paso es transformar la serie original para que lo sea. La figura 19 no deja claro si la primera diferencia es suficiente para alcanzar la estacionariedad (gráficos de la segunda columna) o si es necesaria una segunda diferenciación (gráficos de la tercera columna). Diferenciar más veces de las necesarias puede dificultar la identificación y la interpretación. Además, la función <code>ndiffs</code> aconseja una diferenciación. Así, optamos por fijar <span class="math inline">\(d = 1\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(aforo, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Aforo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">diff</span>(aforo), </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Una diferencia de Aforo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">diff</span>(aforo, <span class="at">differences =</span> <span class="dv">2</span>), </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Dos diferencias de Aforo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(aforo, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(<span class="fu">diff</span>(aforo), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(<span class="fu">diff</span>(aforo, <span class="at">differences =</span> <span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-34-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(aforo)</span></code></pre></div>
<pre><code>[1] 1</code></pre>
</div>
<div id="identificación-1" class="section level3 unnumbered">
<h3 class="unnumbered">Identificación</h3>
<p>Veamos ahora a identificar los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a partir de la FAC y la FACP. La FAC podemos considerar que tiene una sola autocorrelación significativa en el orden 1, y la FACP que presenta decrecimiento. Podría tratarse de un proceso MA(1).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtsdisplay</span>(<span class="fu">diff</span>(aforo, <span class="at">differences =</span> <span class="dv">1</span>), </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;Figura 20. Aforo (una diferencia)&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-36-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>¿Qué recomienda <code>auto.arima</code>? Sugiere un proceso ARIMA(2,1,2), con todos los coeficientes aparentemente significativos.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(aforo)</span></code></pre></div>
<pre><code>Series: aforo 
ARIMA(2,1,2) 

Coefficients:
         ar1      ar2      ma1     ma2
      1.3262  -0.6626  -1.2701  0.9032
s.e.  0.1487   0.1277   0.0854  0.1718

sigma^2 estimated as 660067:  log likelihood=-469.83
AIC=949.66   AICc=950.81   BIC=959.96</code></pre>
<p>Vamos a ver la gráfica de los residuos del modelo ARIMA(2,1,2), vamos a identificar los valores extremos (intervención) y vamos a solicitar una vez más la auto-identificación pero incluyendo las variables ficticias asociadas a cada valor extremo.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>arima212 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(aforo, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima212)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 21. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1960</span>, <span class="dv">2014</span>, <span class="dv">4</span>)) </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co">#time(error)[abs(error) &gt; 2.5*sderror]</span></span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-38-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Se identifican dos posibles valores extremos en los años 1979 y 2011. Así, creamos una variable ficticia asociada a cada año, que las denominaremos d1979 y d2011, y las incluimos en la auto-identificación.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>d1979 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(<span class="fu">time</span>(error) <span class="sc">==</span> <span class="dv">1979</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>d2011 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(<span class="fu">time</span>(error) <span class="sc">==</span> <span class="dv">2011</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(aforo,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">xreg =</span> <span class="fu">cbind</span>(d1979,  d2011))</span></code></pre></div>
<pre><code>Series: aforo 
Regression with ARIMA(2,1,0) errors 

Coefficients:
         ar1     ar2      d1979       d2011
      0.1851  0.4432  -1717.785  -1194.8504
s.e.  0.1189  0.1215    492.910    459.3367

sigma^2 estimated as 602926:  log likelihood=-466.48
AIC=942.96   AICc=944.11   BIC=953.26</code></pre>
<p>Observa como la inclusión de intervención modifica la auto-identificación, que ahora es un proceso ARIMA(2,1,0).</p>
</div>
<div id="estimación-1" class="section level3 unnumbered">
<h3 class="unnumbered">Estimación</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>arima210 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(aforo, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xreg =</span> <span class="fu">cbind</span>(d1979,  d2011))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>arima210</span></code></pre></div>
<pre><code>Series: aforo 
Regression with ARIMA(2,1,0) errors 

Coefficients:
         ar1     ar2      d1979       d2011
      0.1851  0.4432  -1717.785  -1194.8504
s.e.  0.1189  0.1215    492.910    459.3367

sigma^2 estimated as 602926:  log likelihood=-466.48
AIC=942.96   AICc=944.11   BIC=953.26</code></pre>
<p>Se puede comprobar que todas las variables son significativas.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ancho <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">nchar</span>(<span class="fu">names</span>(<span class="fu">coef</span>(arima210)))) <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">coef</span>(arima210))) {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  wt <span class="ot">&lt;-</span> <span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima210), </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima210), </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Terms =</span> i)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Coeficiente: &quot;</span>, <span class="fu">format</span>(<span class="fu">names</span>(<span class="fu">coef</span>(arima210))[i], <span class="at">width =</span> ancho), <span class="st">&quot;valor de p: &quot;</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatC</span>(wt<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">3</span>], <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>
Coeficiente:  ar1     valor de p:  0.1197
Coeficiente:  ar2     valor de p:  0.0003
Coeficiente:  d1979   valor de p:  0.0005
Coeficiente:  d2011   valor de p:  0.0093</code></pre>
<p>Las dos variables de intervención son significativas y el coeficiente <span class="math inline">\(\phi_2\)</span> (<code>ar2</code>) también. No es significativo el coeficiente <span class="math inline">\(\phi_1\)</span> (<code>ar1</code>), pero no lo podemos eliminar. Los modelos Arima son modelos jerárquicos donde la presencia de un coeficiente significativo de cierto orden exige que los coeficiente de orden inferior estén presentes, sean o no significativos. En nuestro caso, como el coeficiente <span class="math inline">\(\phi_2\)</span> es significativo, se debe dejar en el modelo el coeficiente <span class="math inline">\(\phi_1\)</span>.</p>
</div>
<div id="validación-1" class="section level3 unnumbered">
<h3 class="unnumbered">Validación</h3>
<p>Veamos que el residuo verifica todas las hipótesis.</p>
<div id="intervención-1" class="section level4 unnumbered">
<h4 class="unnumbered">Intervención</h4>
<p>La figura 22 muestra que para ningún año se observa un error atípico. Si se incluye una intervención asociada al residuo más elevado en 1984, no resulta significativa.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima210)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 22. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1960</span>, <span class="dv">2014</span>, <span class="dv">4</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-42-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="medidas-de-error" class="section level4 unnumbered">
<h4 class="unnumbered">Medidas de error</h4>
<p>El error medio es 743 miles de vehículos (RMSE) y el error porcentual medio (MAPE) es 5.72%.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima210)</span></code></pre></div>
<pre><code>                ME   RMSE    MAE  MPE MAPE MASE ACF1
Training set 52.11 742.85 539.95 1.38 5.72 0.78 0.03</code></pre>
<p><br />
</p>
</div>
<div id="incorrelación-homocedasticidad-y-normalidad" class="section level4 unnumbered">
<h4 class="unnumbered">Incorrelación, Homocedasticidad y Normalidad</h4>
<p>Veamos ahora si el residuo es ruido blanco:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error
X-squared = 0.16342, df = 2, p-value = 0.9215</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) </span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error^2
X-squared = 2.3442, df = 2, p-value = 0.3097</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(error)</span></code></pre></div>
<pre><code>
    Jarque Bera Test

data:  error
X-squared = 2.1105, df = 2, p-value = 0.3481</code></pre>
<p>Las hipótesis de incorrelación y homocedasticidad se aceptan. También se aceptarían para otros valores de <span class="math inline">\(k\)</span> razonables. Igualmente, se acepta la hipótesis de normalidad.</p>
<p><br />
</p>
<p>Confirmamos que <span class="math inline">\(aforo_t \sim ARIMA(2,1,0)\)</span> con intervención.</p>
</div>
</div>
<div id="interpretación-del-modelo" class="section level3 unnumbered">
<h3 class="unnumbered">Interpretación del modelo</h3>
<p>El <strong>modelo teórico</strong> es <span class="math inline">\(aforo_t \sim ARIMA(2,1,0) + d1979 + d2011\)</span>: <span class="math display">\[(1 - \phi_1 L - \phi_2 L^2)(1 - L)aforo_t =  \varepsilon_t + \gamma_1 \cdot d1979 + \gamma_2 \cdot d2011.\]</span></p>
<p>Si desarrollamos, queda: <span class="math display">\[aforo_t = aforo_{t-1} + \phi_1(aforo_{t-1}-aforo_{t-2}) + \phi_2(aforo_{t-2}-aforo_{t-3}) + \gamma_1 \cdot d1979 +  \gamma_2 \cdot d2011 + \varepsilon_t.\]</span></p>
<p>Finalmente, el <strong>modelo estimado</strong> es: <span class="math display">\[\widehat{aforo}_t = aforo_{t-1} + 0.19(aforo_{t-1}-aforo_{t-2}) + 0.44(aforo_{t-2}-aforo_{t-3}) -1718 \cdot d1979 -1195 \cdot d2011\]</span> Cada año el aforo es el mismo que el aforo del año pasado más un 19% del último incremento observado y un 44% del incremento anterior.</p>
<p>Respecto de la intervención, en 1979 hubo un 1.7 millones menos de vehículos de lo esperado y en 2011 1.2 millones menos.</p>
</div>
<div id="predicción-1" class="section level3 unnumbered">
<h3 class="unnumbered">Predicción</h3>
<p>Como hemos incluido dos variables ficticias en el ajuste, de cara a predecir el aforo hemos de indicar cuales serán los valores futuros para estas variables. En este caso serán ceros puesto que son intervenciones que no responden a efectos calendario.</p>
<p>En <code>R</code> esto se hace incluyendo en el comando <code>forecast</code> el argumento <code>xreg = cbind(rep(0, 5), rep(0, 5))</code> que añade cinco ceros por cada variable de intervención porque la predicción va a ser a cinco años vista.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>parima210 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima210, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">h =</span> <span class="dv">5</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">level =</span> <span class="dv">95</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xreg =</span> <span class="fu">cbind</span>(<span class="at">d1979=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">d1981=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>)))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>parima210</span></code></pre></div>
<pre><code>     Point Forecast    Lo 95    Hi 95
2019       9939.091 8417.211 11460.97
2020       9998.585 7638.731 12358.44
2021      10065.036 6605.162 13524.91
2022      10103.703 5659.374 14548.03
2023      10140.311 4687.351 15593.27</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(parima210, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;Vehículos (000)&#39;</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;Figura 23. Aforo (1960-2018) y predicción (2019-2023)&#39;</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1960</span>, <span class="dv">2023</span>, <span class="dv">4</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-47-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
<div id="validación-con-origen-de-predicción-móvil" class="section level3 unnumbered">
<h3 class="unnumbered">Validación con origen de predicción móvil</h3>
<p>Vamos a calcular el error extra-muestral según el horizonte temporal de previsión. En este caso, la presencia de variables de intervención y la posibilidad de que la función <code>Arima</code> falle a la hora de estimar los parámetros hace el código algo más complejo.</p>
<p>Asumiremos que se precisan 30 años para estimar el modelo, fijaremos el horizonte temporal en 5 años y calcularemos el error MAPE, que para la predicción intra-muestral era de 5.7%.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">30</span>                  </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">5</span>                    </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">length</span>(aforo)     </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> T <span class="sc">-</span> k <span class="sc">-</span> h    </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>mapeArima <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, s <span class="sc">+</span> <span class="dv">1</span>, h)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(d1979, d2011))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>s) {</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  train.set <span class="ot">&lt;-</span> <span class="fu">subset</span>(aforo, <span class="at">start =</span> i <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  test.set <span class="ot">&lt;-</span>  <span class="fu">subset</span>(aforo, <span class="at">start =</span> i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k <span class="sc">+</span> h) </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k),])</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  hay <span class="ot">&lt;-</span> <span class="fu">colSums</span>(X.train)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> X.train[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[(i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> k <span class="sc">+</span> h),])</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> X.test[, hay<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">Arima</span>(train.set, </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xreg=</span><span class="fu">as.matrix</span>(X.train)))</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">Arima</span>(train.set, </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.element</span>(<span class="st">&quot;try-error&quot;</span>, <span class="fu">class</span>(fit))) {</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(X.train) <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>      fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h, <span class="at">xreg =</span> <span class="fu">as.matrix</span>(X.test)) <span class="cf">else</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>        fcast <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> h)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>      mapeArima[i <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">abs</span>(test.set <span class="sc">-</span> fcast<span class="sc">$</span>mean)<span class="sc">/</span>test.set</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>mapeArima <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(mapeArima, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>mapeArima</span></code></pre></div>
<pre><code>[1]  5.782527  9.589675 14.774650 19.458344 23.278878</code></pre>
<p>El error de previsión extra-muestral crece notablemente con el horizonte temporal. El error de las previsiones a un año vista es del 5.8%, prácticamente igual al error intra-muestral, pero para dos años vista casi alcanza el 10% y a cinco años vista supera el 20%.</p>
<p><br />
</p>
</div>
</div>
<div id="consumo-de-alimentos-en-el-hogar-per-cápita" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Consumo de alimentos en el hogar per cápita</h2>
<p>Analizaremos el <strong>consumo alimentario en hogar per cápita</strong> en España. Esta serie está construida a partir de la serie de consumo alimentario en hogar (disponible en el Ministerio de Agricultura, Alimentación y Medio Ambiente), y la serie de población (disponible en el Instituto Nacional de Estadística). Es una serie anual de 1987 a 2018 (32 datos) y la unidad es el Kg per cápita. La figura 24 muestra que es una serie estacionaria.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>alimentospc <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/alimentacionpc.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>alimentospc <span class="ot">&lt;-</span> <span class="fu">ts</span>(alimentospc, <span class="at">start =</span> <span class="dv">1987</span>, <span class="at">freq =</span> <span class="dv">1</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(alimentospc, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Kg per cápita&quot;</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">700</span>),</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 24. Consumo alimentario en hogar&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-49-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div id="transformación-de-la-serie-2" class="section level3 unnumbered">
<h3 class="unnumbered">Transformación de la serie</h3>
<p>La figura 25 indica que la serie original ya es estacionaria. El contraste KPSS así lo confirma, por tanto asumimos que <span class="math inline">\(d=0\)</span> o <span class="math inline">\(alimentospc_t \sim I(0)\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(alimentospc, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Alimentos&quot;</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">diff</span>(alimentospc), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Diferencia alimentos&quot;</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(alimentospc, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(<span class="fu">diff</span>(alimentospc), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;FAC&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-51-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ndiffs</span>(alimentospc)</span></code></pre></div>
<pre><code>[1] 0</code></pre>
</div>
<div id="identificación-2" class="section level3 unnumbered">
<h3 class="unnumbered">Identificación</h3>
<p>Para identificar los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> analizaremos la FAC y la FACP y veremos que nos sugiere <code>auto.arima</code> :</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtsdisplay</span>(alimentospc, <span class="at">main =</span> <span class="st">&quot;Figura 26. Consumo de alimentos per cápita&quot;</span>)</span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(alimentospc)</span></code></pre></div>
<pre><code>Series: alimentospc 
ARIMA(1,0,0) with non-zero mean 

Coefficients:
         ar1      mean
      0.6477  639.2512
s.e.  0.1561    5.7083

sigma^2 estimated as 153:  log likelihood=-125.13
AIC=256.26   AICc=257.12   BIC=260.66</code></pre>
<p>Es difícil realizar una identificación a partir del análisis de la FAC y FACP. La identificación automática sugiere un proceso AR(1) con constante y ambos coeficientes parecen significativos –su valor supera dos veces su error estándar.</p>
<p>Vamos a ver la gráfica de los residuos de este proceso para identificar rápidamente si hay valores extremos (figura 27).</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>arima100 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(alimentospc, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima100)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 27. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1987</span>, <span class="dv">2018</span>, <span class="dv">3</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Hay dos posibles valores extremos en los años 1995 y 2009. Además, tras incluirlas y estimar el nuevo modelo aparece otra variable de intervención para 1993. Aunque ninguna supera las 2.5 desviaciones típicas, su efecto es significativo.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>d1993 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span> (<span class="fu">time</span>(alimentospc) <span class="sc">==</span> <span class="dv">1993</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>d1995 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span> (<span class="fu">time</span>(alimentospc) <span class="sc">==</span> <span class="dv">1995</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>d2009 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span> (<span class="fu">time</span>(alimentospc) <span class="sc">==</span> <span class="dv">2009</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>arima100 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(alimentospc, </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">TRUE</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xreg =</span> <span class="fu">cbind</span>(d1993, d1995, d2009))</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>arima100</span></code></pre></div>
<pre><code>Series: alimentospc 
Regression with ARIMA(1,0,0) errors 

Coefficients:
         ar1  intercept    d1993     d1995    d2009
      0.7954   639.1924  21.9437  -15.8735  21.3839
s.e.  0.1383     7.2190   7.2137    7.2139   7.2137

sigma^2 estimated as 100.5:  log likelihood=-116.96
AIC=245.92   AICc=249.28   BIC=254.71</code></pre>
</div>
<div id="validación-2" class="section level3 unnumbered">
<h3 class="unnumbered">Validación</h3>
<div id="coeficientes-significativos" class="section level4 unnumbered">
<h4 class="unnumbered">Coeficientes significativos</h4>
<p>Tanto <span class="math inline">\(\phi_1\)</span> como el intercepto <span class="math inline">\(\mu\)</span> y las variables de intervención son significativas.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>ancho <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">nchar</span>(<span class="fu">names</span>(<span class="fu">coef</span>(arima100)))) <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">coef</span>(arima100))) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  wt <span class="ot">&lt;-</span> <span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima100), </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima100), </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Terms =</span> i)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Coeficiente: &quot;</span>, <span class="fu">format</span>(<span class="fu">names</span>(<span class="fu">coef</span>(arima100))[i], <span class="at">width =</span> ancho), <span class="st">&quot;valor de p: &quot;</span>, </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formatC</span>(wt<span class="sc">$</span>result<span class="sc">$</span>chi2[<span class="dv">3</span>], <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>))</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>
Coeficiente:  ar1         valor de p:  0.0000
Coeficiente:  intercept   valor de p:  0.0000
Coeficiente:  d1993       valor de p:  0.0024
Coeficiente:  d1995       valor de p:  0.0278
Coeficiente:  d2009       valor de p:  0.0030</code></pre>
<p><br />
</p>
</div>
<div id="medidas-de-error-1" class="section level4 unnumbered">
<h4 class="unnumbered">Medidas de error</h4>
<p>El error medio es <span class="math inline">\(RMSE=\)</span> 9 kilos per cápita y el error porcentual medio es <span class="math inline">\(MAPE=\)</span> 1.2%.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima100)</span></code></pre></div>
<pre><code>                ME RMSE  MAE   MPE MAPE MASE ACF1
Training set -1.29 9.21 7.59 -0.22 1.19  0.8 0.04</code></pre>
<p><br />
</p>
</div>
<div id="incorrelación-homocedasticidad-y-normalidad-1" class="section level4 unnumbered">
<h4 class="unnumbered">Incorrelación, Homocedasticidad y Normalidad</h4>
<p>Veamos ahora si el residuo es ruido blanco:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima100)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error
X-squared = 0.96523, df = 2, p-value = 0.6172</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) </span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error^2
X-squared = 4.699, df = 2, p-value = 0.09542</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(error)</span></code></pre></div>
<pre><code>
    Jarque Bera Test

data:  error
X-squared = 0.35877, df = 2, p-value = 0.8358</code></pre>
<p>Las hipótesis de incorrelación y homocedasticidad se aceptan. También se aceptarían para otros valores de <span class="math inline">\(k\)</span> razonables.</p>
<p>La hipótesis de normalidad también es acepta al 5%.</p>
</div>
</div>
<div id="interpretación-del-modelo-1" class="section level3 unnumbered">
<h3 class="unnumbered">Interpretación del modelo</h3>
<p>El <strong>modelo teórico</strong> identificado es: <span class="math display">\[(1 - \phi_1 L) alimentospc_t = c + \gamma_1 d1993 + \gamma_2 d1995 + \gamma_3 d2009 + \varepsilon_t,\]</span> que desarrollando queda: <span class="math display">\[alimentospc_t = c + \phi_1 alimentospc_{t-1} + \gamma_1 d1993 + \gamma_2 d1995 + \gamma_3 d2009 + \varepsilon_t.\]</span></p>
<p>Finalmente, el <strong>modelo estimado</strong> es: <span class="math display">\[\widehat{alimentospc}_t = 129.5 + 0.80 \cdot alimentospc_{t-1} + 21.94\cdot d1993 - 15.87\cdot d1995 +21.38\cdot d2009\]</span></p>
<p><strong>Observación</strong>: El término contante <span class="math inline">\(\mu\)</span> que estima R no el valor “c” que hemos visto en la teoría. Para convertir la contante estimada por R en “c” hemos de multiplicarla por el polinomio autorregresivo. En este caso, <span class="math display">\[c = (1 - \phi_1)\cdot\mu = (1 - 0.7974)\cdot639.1924 = 129.5\]</span></p>
<p>Cada año el consumo de alimentos per cápita en el hogar es 129.5 kilos más un 80% del consumo del año pasado.</p>
<p>En 1993 y 2009 el consumo medio de alimentos per cápita fue entre 21 y 22 kg. superior a los esperado, mientras que el 1995 fue 16 kg. menor de lo esperado.</p>
</div>
<div id="predicciones-de-la-serie" class="section level3 unnumbered">
<h3 class="unnumbered">Predicciones de la serie</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>parima100 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima100, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">h =</span> <span class="dv">5</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">level =</span> <span class="dv">95</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xreg =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>)))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>parima100</span></code></pre></div>
<pre><code>     Point Forecast    Lo 95    Hi 95
2019       621.4614 601.8087 641.1140
2020       625.0895 599.9784 650.2006
2021       627.9752 599.9549 655.9956
2022       630.2705 600.5563 659.9846
2023       632.0961 601.3586 662.8336</code></pre>
<p>Puedes comprobar que cada valor de la predicción se ha obtenido a partir del modelo estimado, donde <span class="math inline">\(alimentospc_{t-1}\)</span> se sustituye por la predicción del año precedente.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(parima100, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Kilos per cápita&quot;</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Figura 28. Consumo de alimentos y predicción&quot;</span>) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1987</span>, <span class="dv">2023</span>, <span class="dv">4</span>)) </span></code></pre></div>
<p><img src="03-04-Tema4_files/figure-html/unnamed-chunk-62-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
</div>
</div>
<div id="comparación-con-alisado-exponencial" class="section level2" number="6.4">
<h2 number="6.4"><span class="header-section-number">6.4</span> Comparación con alisado exponencial</h2>
<p>Veamos una comparativa, para los tres ejemplos vistos, entre los resultados obtenidos con ARIMA y con Alisado exponencial.</p>
<ul>
<li>Libros:
<ul>
<li><p>MAPE ARIMA: <span class="math inline">\(7.02\%\)</span> - ARIMA(0,1,0) sin deriva</p></li>
<li><p>MAPE ETS: <span class="math inline">\(7.05\%\)</span> - ETS(M,N,N), <span class="math inline">\(\alpha=1\)</span></p></li>
<li><p>Ambos métodos han estimado el mismo modelo.</p></li>
</ul></li>
</ul>
<ul>
<li>Aforo:
<ul>
<li><p>MAPE ARIMA: <span class="math inline">\(5.72\%\)</span> - ARIMA(2,1,0) sin deriva, con intervención</p></li>
<li><p>MAPE ETS: <span class="math inline">\(6.18\%\)</span> - ETS(M,A,N), <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=0.10\)</span></p></li>
<li><p>Cada método estima un modelo diferente</p></li>
<li><p>ARIMA tiene menor error a costa de incluir variables de intervención</p></li>
</ul></li>
</ul>
<ul>
<li>Alimentos per cápita:
<ul>
<li><p>MAPE ARIMA: <span class="math inline">\(1.19\%\)</span> - ARIMA(1,0,0) con constante e intervención</p></li>
<li><p>MAPE ETS: <span class="math inline">\(1.43\%\)</span> - ETS(M,N,N), <span class="math inline">\(\alpha = 0.98\)</span></p></li>
<li><p>Cada método ha estimado un modelo diferente</p></li>
<li><p>ARIMA tiene menor error a costa de incluir variables de intervención</p></li>
</ul></li>
</ul>
<p><br />
<br />
</p>
</div>
</div>
<div id="resumen-de-los-comandos-utilizados" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Resumen de los comandos utilizados</h1>
<table>
<thead>
<tr class="header">
<th align="left">Función</th>
<th align="left">Paquete</th>
<th align="left">Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>arima.sim</code></td>
<td align="left">stats</td>
<td align="left">genera una simulación de un proceso ARIMA</td>
</tr>
<tr class="even">
<td align="left"><code>Arima</code></td>
<td align="left">forecast</td>
<td align="left">estima un proceso ARIMA</td>
</tr>
<tr class="odd">
<td align="left"><code>auto.arima</code></td>
<td align="left">forecast</td>
<td align="left">identificación automática de un modelo ARIMA</td>
</tr>
<tr class="even">
<td align="left"><code>wald.test</code></td>
<td align="left">aod</td>
<td align="left">contrasta la significatividad conjunta de varios parámetros</td>
</tr>
<tr class="odd">
<td align="left"><code>forecast</code></td>
<td align="left">forecast</td>
<td align="left">realiza una predicción de un modelo</td>
</tr>
<tr class="even">
<td align="left"><code>Box.test</code></td>
<td align="left">stats</td>
<td align="left">prueba de independencia de una serie temporal</td>
</tr>
<tr class="odd">
<td align="left"><code>shapiro.test</code></td>
<td align="left">stats</td>
<td align="left">prueba de normalidad de Shapiro-Wilks</td>
</tr>
<tr class="even">
<td align="left"><code>jarque.bera.test</code></td>
<td align="left">tseries</td>
<td align="left">prueba de normalidad de Jarque-Bera</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
</div>
<div id="referencias" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Referencias</h1>
<ul>
<li>Box, G. E.P. y Jenkins, G. (1976). <em>Time Series Analysis: Forecasting and Control</em> Editado por Holden-Day, San Francisco, CA</li>
</ul>
<p><br />
<br />
<br />
<br />
</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiU2VyaWVzIFRlbXBvcmFsZXM6IFByb2Nlc29zIEFSSU1BIgpzdWJ0aXRsZTogIk3DoXN0ZXIgZGUgQmlvZXN0YWTDrXN0aWNhIChNb2RlbGl6YWNpw7NuIEVzdGFkw61zdGljYSkiCmF1dGhvcjogIkl2w6FuIEFycmliYXMgKERlcHRvLiBBbsOhbGlzaXMgRWNvbsOzbWljby4gVW5pdmVyc2l0YXQgZGUgVmFsw6huY2lhKSIKb3V0cHV0OiAKICBodG1sX2RvY3VtZW50OgogICAgdGhlbWU6IGNlcnVsZWFuCiAgICBoaWdobGlnaHQ6IHB5Z21lbnRzIAogICAgZmlnX2NhcHRpb246IGZhbHNlCiAgICBkZl9wcmludDoga2FibGUKICAgIHRvYzogdHJ1ZQogICAgdG9jX2RlcHRoOiAyCiAgICB0b2NfZmxvYXQ6IAogICAgICBjb2xsYXBzZWQ6IHRydWUKICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQogICAgc2VsZl9jb250YWluZWQ6IHRydWUKICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgpgYGB7ciBjaHVua19zZXR1cCwgZWNobyA9IEZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQod2FybmluZyA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgCiAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIiwgCiAgICAgICAgICAgICAgICAgICAgICBmaWcuc2hvdyA9ICJob2xkIiwKICAgICAgICAgICAgICAgICAgICAgIGZpZy5oZWlnaHQgPSA0LAogICAgICAgICAgICAgICAgICAgICAgZmlnLndpZHRoID0gOCwKICAgICAgICAgICAgICAgICAgICAgIG91dC53aWR0aCA9ICI4MCUiKSAKYGBgCgpgYGB7ciBsaWJyZXJpYXMsIGVjaG8gPSBGQUxTRX0KbGlicmFyeShmb3JlY2FzdCkKbGlicmFyeShnZ3Bsb3QyKTsgdGhlbWVfc2V0KHRoZW1lX2J3KCkpCmxpYnJhcnkoZ3JpZEV4dHJhKQpsaWJyYXJ5KGdyaWQpCmxpYnJhcnkodHNlcmllcykKbGlicmFyeShhb2QpCmBgYAoKCiMgSW50cm9kdWNjacOzbgoKTG9zIF9fbW9kZWxvcyBBUklNQV9fIGhhbiBtb3N0cmFkbyBzZXIgdW5vIHNlIGxvcyBtw6l0b2RvcyBkZSBhanVzdGUgZGUgc2VyaWVzIHRlbXBvcmFsZXMgbcOhcyB2YWxpb3NvcyBkZXNkZSBxdWUgZnVlcmFuIGZvcm1hbGl6YWRvcyBlbiAxOTc2IHBvciBCb3ggeSBKZW5raW5zLCBlbiBzdSBsaWJybyBbVGltZSBzZXJpZXMgYW5hbHlzaXMsIGZvcmVjYXN0aW5nIGFuZCBjb250cm9sXShodHRwOi8vd3d3LmFtYXpvbi5jb20vVGltZS1BbmFseXNpcy1Gb3JlY2FzdGluZy1HZW9yZ2UtQm94L2RwLzA0NzAyNzI4NDgpLiBBZGVtw6FzLCBkaWVyb24gbGFzIHBhdXRhcyBhIHNlZ3VpciBlbiBlbCBhanVzdGUgZGUgdW5hIHNlcmllIHRlbXBvcmFsIHBhcmEgYWxjYW56YXIgYnVlbmFzIHByZWRpY2Npb25lcyAodsOpYXNlIGVww61ncmFmZSA1KS4KCkVuIGVzdGUgdGVtYSB5IGVsIHNpZ3VpZW50ZSwgZGVmaW5pcmVtb3MgZXN0b3MgcHJvY2Vzb3MgeSBhcHJlbmRlcmVtb3MgYSBpZGVudGlmaWNhcmxvcywgZXN0aW1hcmxvcyB5IGhhY2VyIHByZWRpY2Npb25lcy4KCl9fTG9zIHByb2Nlc29zIEFSSU1BIHNvbiBhaG9yYSBlbCB0cm9uY28gZGUgdW5hIGFtcGxpYSBmYW1pbGlhIGRlIHByb2Nlc29zX18gcXVlIHJlcXVpZXJlbiBtZW5vcyBoaXDDs3Rlc2lzIHBhcmEgc3UgYXBsaWNhY2nDs246IEFSQ0gsIEdBUkNILCBOR0FSQ0gsICBJR0FSQ0gsIEVHQVJDSCwgR0FSQ0gtTSwgUUdBUkNILCBHSlItR0FSQ0gsIFRHQVJDSCwgZkdBUkNILi4uCgpfX0xvcyBwcm9jZXNvcyBBUklNQSB5IGxvcyBtw6l0b2RvcyBkZSBBbGlzYWRvIEV4cG9uZW5jaWFsIHNvbiBjb21wbGVtZW50YXJpb3NfXzoKCiogTG9zIG1vZGVsb3MgZGUgQWxpc2FkbyBsaW5lYWxlcyBzb24gY2Fzb3MgZXNwZWNpYWxlcyBkZSBtb2RlbG9zIEFyaW1hLAoqIExvcyBtb2RlbG9zIGRlIEFsaXNhZG8gbm8gbGluZWFsZXMgbm8gdGllbmVuIHN1IGNvbnRyYXBhcnRpZGEgZW4gbW9kZWxvcyBBcmltYQoqIE11Y2hvcyBtb2RlbG9zIEFyaW1hIG5vIHRpZW5lIGNvbnRyYXBhcnRpZGEgZW4gbG9zIG1vZGVsb3MgZGUgQWxpc2Fkby4gIAoKXApcCgojIE9wZXJhZG9yIFJldGFyZG8KCkRlZmluaW1vcyBlbCBfX29wZXJhZG9yIHJldGFyZG9fXyAkTCQgY29tbyAkTHlfdCA9IHlfe3QtMX0kLCBlcyBkZWNpciwgcmV0cmFzYSB1biBwZXJpb2RvIGxhIHNlcmllLiBFbiBpbmdsw6lzIHNlIGRlbm9taW5hIF9sYWcgb3BlcmF0b3JfIChMKSBvIF9iYWNrd2FyZCBzaGlmdF8gKEIpCgpBc8OtLCBzZSB0aWVuZSBxdWUKJCRMXmsgeV90ICA9IHlfe3Qta30uJCQKeSBwb3IgdGFudG8gcXVlCiQkClxiZWdpbnthbGlnbmVkfQogIFxuYWJsYSB5X3QgJiA9ICB5X3QgLSB5X3t0LTF9ID0geV90IC0gTHlfdCA9ICgxLUwpeV90IFxcCiAgXG5hYmxhXmQgeV90ICYgPSAgKDEtTCleZCB5X3QgXFwKICBcbmFibGFfbSB5X3QgJiA9ICAoMS1MXm0pIHlfdCBcXAogIFxuYWJsYV9tXkQgeV90ICYgPSAgKDEtTF5tKV5EIHlfdApcZW5ke2FsaWduZWR9CiQkCgpMYSBzaWd1aWVudGUgdGFibGEgbXVlc3RyYSB1biBzZW5jaWxsbyBlamVtcGxvIGRlbCBlZmVjdG8gZGVsIG9wZXJhZG9yIHJldGFyZG8gc29icmUgbGEgc2VyaWUgJHlfdCQKYGBge3IsIGVjaG89RkFMU0V9CmRhdGEuZnJhbWUoeSA9IDE6NywgbGFnMV95ID0gYyhOQSwgMTo2KSwgbGFnMl95ID0gYyhOQSxOQSwxOjUpLCBsYWczX3kgPSBjKE5BLE5BLE5BLDE6NCkgKQpgYGAKClwKXAoKIyBIaXDDs3Rlc2lzCgpcCgojIyBTb2JyZSBlbCBwcm9jZXNvIGVzdG9jw6FzdGljbwoKQSBsbyBsYXJnbyBkZSBlc3RlIHRlbWEgYXN1bWlyZW1vcyBxdWU6CgoqICRce3lfdFx9X3t0PTF9XlQkIGVzIHVuYSByZWFsaXphY2nDs24gZGUgdW4gcHJvY2VzbyBlc3RvY8Ohc3RpY28gZGVzY29ub2NpZG8uCiAgICAKKiBFbCBwcm9jZXNvIGVzdG9jw6FzdGljbyBlcyBfX2VzdGFjaW9uYXJpbyBlbiBzZW50aWRvIGFtcGxpb19fOgokJEVbeV90XSAgPSBcbXUgPCBcaW5mdHkgXDtcO1w7IFxmb3JhbGwgdCwkJAokJENvdlt5X3QsIHlfe3Qta31dICA9IFxnYW1tYV9rICBcO1w7XDsgXGZvcmFsbCBrLiQkCiAgICAgCiogRWwgcHJvY2VzbyBlc3RvY8Ohc3RpY28gZXMgX19lcmfDs2RpY29fXywgbyBzdSBjb25kaWNpw7NuIHN1ZmljaWVudGU6IAokJFxsaW1fe2sgXHJpZ2h0YXJyb3cgXGluZnR5fSBcZ2FtbWFfayAgPSAwLiQkCgpcCgojIyBTb2JyZSBlbCB2ZWN0b3IgZGUgcmVzaWR1b3MKClRhbWJpw6luIGFzdW1pcmVtb3MgcXVlIGVsIHJlc2lkdW8gZGVsIG1vZGVsbyAkXHtcdmFyZXBzaWxvbl90XH1fe3Q9MX1eVCQgZXMgX19ydWlkbyBibGFuY29fXzoKCiogTWVkaWEgY2VybzogJEVbXHZhcmVwc2lsb25fdF09MCQKClx2c3BhY2V7MC4zY219CgoqIFZhcmlhbnphIGNvbnN0YW50ZSAoaG9tb2NlZMOhc3RpY28pOiAkRVtcdmFyZXBzaWxvbl90XjJdPVxzaWdtYV4yJAoKXHZzcGFjZXswLjNjbX0KCiogSW5jb3JyZWxhY2nDs246ICRFW1x2YXJlcHNpbG9uX3QgXGNkb3QgXHZhcmVwc2lsb25fe3N9XT0wIFw7XDtcOyB0IFxuZXEgcyQKClx2c3BhY2V7MC4zY219CgoqIERpc3RyaWJ1Y2nDs24gTm9ybWFsOiAkXHZhcmVwc2lsb25fdCBcc2ltIE4kCgpcdnNwYWNlezAuM2NtfQoKRXMgZGVjaXIsICRcdmFyZXBzaWxvbl90IFxzaW0gTigwLFxzaWdtYV4yKSQgaS5pLmQuCgpcClwKCiMgUHJvY2Vzb3MgQVJJTUEKCkFSSU1BIHN1cmdlIGRlIGNvbWJpbmFyIGxhcyBzaWdsYXMgZGUgdHJlcyBwcm9jZXNvcyBkaWZlcmVudGVzOiBfX0FSX18gZGUgQXV0b1JlZ3Jlc2l2ZSwgX19JX18gZGUgSW50ZWdyYXRlZCB5IF9fTUFfXyBkZSBNb3ZpbmcgQXZlcmFnZS4gVmVhbW9zIGNhZGEgdW5vIGRlIGVzdG9zIHRyZXMgY29uY2VwdG9zIHBvciBzZXBhcmFkbyB5IGx1ZWdvIHN1IGNvbWJpbmFjacOzbi4gCgpcCgojIyBQcm9jZXNvcyBhdXRvcnJlZ3Jlc2l2b3MgQVIocCkKCiMjIyBEZWZpbmljacOzbiB7LX0KCkVsIG1vZGVsbyBnZW5lcmFsIF9fYXV0b3JyZWdyZXNpdm8gZGUgb3JkZW4gcF9fLCAkeV90IFxzaW0gQVIocCkkIHZpZW5lIGRlZmluaWRvIHBvcgokJHlfdD1jICsgXHBoaV8xIHlfe3QtMX0gKyBccGhpXzIgeV97dC0yfSArIFxsZG90cyArIFxwaGlfcCB5X3t0LXB9ICsgXHZhcmVwc2lsb25fdCwkJApxdWUgdXNhbmRvIGVsIG9wZXJhZG9yIHJldGFyZG8gcXVlZGEKJCQoMSAtIFxwaGlfMSBMIC0gXHBoaV8yIExeMiAtIFxsZG90cyAtIFxwaGlfcCBMXnApeV90ID0gYyArIFx2YXJlcHNpbG9uX3QkJAoKIyMjIFByb3BpZWRhZGVzIHstfQoKRWwgcHJvY2VzbyBlcyBfX2VzdGFjaW9uYXJpb19fIHNpIHF1ZWRhbiBmdWVyYSBkZWwgY8OtcmN1bG8gZGUgcmFkaW8gbGEgdW5pZGFkIHRvZGFzIGxhcyByYcOtY2VzIGRlbCBwb2xpbm9taW8gYXV0b3JyZWdyZXNpdm8KJCRcUGhpX3AoeikgPSAxIC0gXHBoaV8xIHogLSBccGhpXzIgel4yIC0gXGxkb3RzIC0gXHBoaV9wIHpecC4kJAoKRXMgX19pbnZlcnRpYmxlX18gc2llbXByZS4KCiogUG9kZW1vcyB0cmFuc2Zvcm1hciBlbCBwcm9jZXNvIEFSKHApIGVuIHVuIHByb2Nlc28gZG9uZGUgJHlfdCQgZGVwZW5kZSBkZSBsYSBzdW1hIGluZmluaXRhIGRlIGVycm9yZXMgcGFzYWRvcywgTUEoJFxpbmZ0eSQpLgoqIFNpIGNvbm9jZW1vcyBsYXMgcCBwcmltZXJhcyBhdXRvY29ycmVsYWNpb25lcywgcG9kZW1vcyBlc3RpbWFyIGxvcyBwIHBhcsOhbWV0cm9zIGRlbCBtb2RlbG8uIFBvciBlamVtcGxvLCBwYXJhIHVuIHByb2Nlc28gQVIoMikgc2UgdmVyaWZpY2EgcXVlOgokJFxyaG9fMSA9IFxwaGlfMSArIFxwaGlfMiBccmhvXzEkJAokJFxyaG9fMiA9IFxwaGlfMSBccmhvXzEgKyBccGhpXzIkJAoKICBFc3RhcyBlY3VhY2lvbmVzIHNlIGRlbm9taW5hbiBfX0VjdWFjaW9uZXMgZGUgWXVsZS1XYWxrZXJfXy4KICAKICBPYnNlcnZhIHF1ZSBzaSB0ZW5lbW9zIHVuYSBlc3RpbWFjacOzbiBkZSBsYXMgZG9zIHByaW1lcmFzIGF1dG9jb3JyZWxhY2lvbmVzLCBlc3RhcyBlY3VhY2lvbmVzIG5vcyBwZXJtaXRlbiBvYnRlbmVyIHVuYSBlc3RpbWFjacOzbiBkZSBsb3MgY29lZmljaWVudGVzIGRlbCBwcm9jZXNvIEFSKDIpIGNvbW8gdW5hIGFwbGljYWNpw7NuIGRlbCBtw6l0b2RvIGRlIGxvcyBtb21lbnRvcy4KCl9fU29icmUgdG9kb19fLAoKKiBMYSBGQUMgZGVsIHByb2Nlc28gZGVjYWUgX2V4cG9uZW5jaWFsbWVudGVfIGEgcGFydGlyIGRlbCBvcmRlbiBwCiogTGEgRkFDUCB2ZXJpZmljYSBxdWUgbG9zIHAgcHJpbWVyb3MgdmFsb3JlcyBzb24gbm8gbnVsb3MgeSB0b2RvcyBsb3MgZGVtw6FzIHZhbGVuIGNlcm8uCgojIyMgRWplbXBsb3Mgey19CgoqICR5X3QgXHNpbSBBUigxKTogXDtcO3lfdCA9IGMgKyBccGhpXzEgeV97dC0xfSArIFx2YXJlcHNpbG9uX3QkIG8gJCgxIC0gXHBoaV8xIEwpeV90ID0gYyArIFx2YXJlcHNpbG9uX3QkCiogJHlfdCBcc2ltIEFSKDIpOiBcO1w7eV90ID0gYyArIFxwaGlfMSB5X3t0LTF9ICsgXHBoaV8yIHlfe3QtMn0gKyBcdmFyZXBzaWxvbl90JCBvICQoMSAtIFxwaGlfMSBMIC0gXHBoaV8yIExeMil5X3QgPSBjICsgXHZhcmVwc2lsb25fdCQKCiMjIyBTaW11bGFjacOzbiBkZSBwcm9jZXNvcyBhdXRvcnJlZ3Jlc2l2b3Mgey19CgpMYXMgZmlndXJhcyAxIHkgMiBtdWVzdHJhbiBkb3Mgc2ltdWxhY2lvbmVzIGRlbCBwcm9jZXNvIEFSKDEpICR5X3QgPSAwLjh5X3t0LTF9ICsgXHZhcmVwc2lsb25fdCQsIGxhIHByaW1lcmEgY29uIDIwIGRhdG9zIHkgbGEgc2VndW5kYSBjb24gMTAwIGRhdG9zLiBFbiBhbWJvcyBjYXNvcyAkXHZhcmVwc2lsb25fdCQgc2UgZGlzdHJpYnV5ZSBjb21vIHVuYSBub3JtYWwgY29uIG1lZGlhIGNlcm8geSB2YXJpYW56YSBsYSB1bmlkYWQuIChUb2RhcyBsYXMgc2ltdWxhY2lvbmVzIHNlIGhhbiByZWFsaXphZG8gY29uIGxhIGZ1bmNpw7NuIGBhcmltYS5zaW1gIGRlIGxhIGxpYnJlcsOtYSBgc3RhdHNgLikKCmBgYHtyLCBlY2hvID0gRkFMU0V9CnNldC5zZWVkKDExMTExNikKeTIwIDwtIGFyaW1hLnNpbShuID0gMjAsIGxpc3QoYXIgPSAwLjgpLCBpbm5vdiA9IHJub3JtKDIwKSkKeTEwMCA8LSBhcmltYS5zaW0obiA9IDEwMCwgbGlzdChhciA9IDAuOCksIGlubm92ID0gcm5vcm0oMTAwKSkKeTEwMGEgPC0gYXJpbWEuc2ltKG4gPSAxMDAsIGxpc3QoYXIgPSBjKDAuNSwgMC40KSksIGlubm92ID0gcm5vcm0oMTAwKSkKeTEwMGIgPC0gYXJpbWEuc2ltKG4gPSAxMDAsIGxpc3QoYXIgPSBjKDAuOSwgLTAuNSkpLCBpbm5vdiA9IHJub3JtKDEwMCkpCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ2d0c2Rpc3BsYXkoeTIwLCBtYWluID0gIkZpZ3VyYSAxLiBBUigxKSAtIG4gPSAyMCIpCmdndHNkaXNwbGF5KHkxMDAsIG1haW4gPSAiRmlndXJhIDIuIEFSKDEpIC0gbiA9IDEwMCIpCmBgYAoKTGFzIGZpZ3VyYXMgMyB5IDQgbXVlc3RyYW4gZG9zIHNpbXVsYWNpb25lcyBkZSBwcm9jZXNvcyBBUigyKSwgYW1iYXMgY29uIDEwMCBkYXRvcy4gRW4gbGEgcHJpbWVyYSBzZSB0aWVuZSBxdWUgJHlfdCA9IDAuNXlfe3QtMX0gKyAwLjQgeV97dC0yfSsgXHZhcmVwc2lsb25fdCQgeSBlbiBsYSBzZWd1bmRhICR5X3QgPSAwLjl5X3t0LTF9IC0gMC41IHlfe3QtMn0rIFx2YXJlcHNpbG9uX3QkLgoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ2d0c2Rpc3BsYXkoeTEwMGEsIG1haW4gPSAiRmlndXJhIDMuIEFSKDIpIC0gbiA9IDEwMCIpCmdndHNkaXNwbGF5KHkxMDBiLCBtYWluID0gIkZpZ3VyYSA0LiBBUigyKSAtIG4gPSAxMDAiKQpgYGAKClwKCiMjIFByb2Nlc29zIGVuIG1lZGlhcyBtw7N2aWxlcyBNQShxKQoKIyMjIERlZmluaWNpw7NuIHstfQoKRWwgbW9kZWxvIGdlbmVyYWwgX19lbiBtZWRpYXMgbcOzdmlsZXMgZGUgb3JkZW4gcV9fLCAkeV90IFxzaW0gTUEocSkkIHZpZW5lIGRlZmluaWRvIHBvcgokJHlfdD1jICsgXHZhcmVwc2lsb25fdCArIFx0aGV0YV8xIFx2YXJlcHNpbG9uX3t0LTF9ICsgXHRoZXRhXzIgXHZhcmVwc2lsb25fe3QtMn0gKyBcbGRvdHMgKyBcdGhldGFfcSBcdmFyZXBzaWxvbl97dC1xfSwkJApxdWUgdXNhbmRvIGVsIG9wZXJhZG9yIHJldGFyZG8gcXVlZGEKJCR5X3QgPSBjICsgKDEgKyBcdGhldGFfMSBMICsgXHRoZXRhXzIgTF4yICsgXGxkb3RzICsgXHRoZXRhX3EgTF5xKSBcdmFyZXBzaWxvbl90JCQKCiMjIyBQcm9waWVkYWRlcyB7LX0KCkVsIHByb2Nlc28gZXMgX19pbnZlcnRpYmxlX18gc2kgcXVlZGFuIGZ1ZXJhIGRlbCBjw61yY3VsbyBkZSByYWRpbyBsYSB1bmlkYWQgdG9kYXMgbGFzIHJhw61jZXMgZGVsIHBvbGlub21pbyBlbiBtZWRpYXMgbcOzdmlsZXMKJCRcVGhldGFfcSh6KSA9IDEgKyBcdGhldGFfMSB6ICsgXHRoZXRhXzIgel4yICsgXGxkb3RzICsgXHRoZXRhX3Egel5xLiQkCgoqIFBvZGVtb3MgdHJhbnNmb3JtYXIgZWwgcHJvY2VzbyBNQShxKSBlbiB1biBwcm9jZXNvIEFSKCRcaW5mdHkkKS4KKiBTaSBjb25vY2Vtb3MgbGFzIHEgcHJpbWVyYXMgYXV0b2NvcnJlbGFjaW9uZXMsIHBvZGVtb3MgZXN0aW1hciBsb3MgcSBwYXLDoW1ldHJvcyBkZWwgbW9kZWxvLiBQb3IgZWplbXBsbywgcGFyYSB1biBwcm9jZXNvIE1BKDIpIHNlIHZlcmlmaWNhIHF1ZToKJCRccmhvXzEgPSBcZnJhY3tcdGhldGFfMSArIFx0aGV0YV8xXHRoZXRhXzJ9ezEgKyBcdGhldGFfMV4yICsgXHRoZXRhXzJeMn0kJAokJFxyaG9fMiA9IFxmcmFje1x0aGV0YV8yfXsxICsgXHRoZXRhXzFeMiArIFx0aGV0YV8yXjJ9JCQKCkVzIF9fZXN0YWNpb25hcmlvX18gc2llbXByZS4KICAgICAKX19Tb2JyZSB0b2RvX18sCgoqIExhIEZBQyB2ZXJpZmljYSBxdWUgbG9zIHEgcHJpbWVyb3MgdmFsb3JlcyBzb24gbm8gbnVsb3MgeSB0b2RvcyBsb3MgZGVtw6FzIHZhbGVuIGNlcm8uCiogTGEgRkFDUCBkZWNhZSBfZXhwb25lbmNpYWxtZW50ZV8gYSBwYXJ0aXIgZGVsIG9yZGVuIHEuCgojIyMgRWplbXBsb3Mgey19CgoqICR5X3QgXHNpbSBNQSgxKTogXDtcO3lfdCA9IGMgKyBcdmFyZXBzaWxvbl90ICsgXHRoZXRhXzEgXHZhcmVwc2lsb25fe3QtMX0kIG8gJHlfdCA9IGMgKyAoMSArIFx0aGV0YV8xIEwpXHZhcmVwc2lsb25fdCQKKiAkeV90IFxzaW0gTUEoMik6IFw7XDt5X3Q9YyArIFx2YXJlcHNpbG9uX3QgKyBcdGhldGFfMSBcdmFyZXBzaWxvbl97dC0xfSArIFx0aGV0YV8yIFx2YXJlcHNpbG9uX3t0LTJ9JCBvICR5X3QgPSBjICsgKDEgKyBcdGhldGFfMSBMICsgXHRoZXRhXzIgTF4yKVx2YXJlcHNpbG9uX3QkCgojIyMgU2ltdWxhY2nDs24gZGUgcHJvY2Vzb3MgZW4gbWVkaWFzIG3Ds3ZpbGVzIHstfQoKTGFzIGZpZ3VyYXMgNSB5IDYgb2ZyZWNlbiBkb3Mgc2ltdWxhY2lvbmVzIGRlbCBwcm9jZXNvIE1BKDEpICR5X3QgPSAwLjhcdmFyZXBzaWxvbl97dC0xfSArIFx2YXJlcHNpbG9uX3QkLCBsYSBwcmltZXJhIGNvbiAyMCBkYXRvcyB5IGxhIHNlZ3VuZGEgY29uIDEwMCBkYXRvcy4gRW4gYW1ib3MgY2Fzb3MgJFx2YXJlcHNpbG9uX3QkIHNlIGRpc3RyaWJ1eWUgY29tbyB1bmEgbm9ybWFsIGNvbiBtZWRpYSBjZXJvIHkgdmFyaWFuemEgbGEgdW5pZGFkLgoKYGBge3IsIGVjaG89RkFMU0V9CnNldC5zZWVkKDY1NDMyMSkKeTIwPC1hcmltYS5zaW0obj0yMCxsaXN0KG1hPTAuOCksIGlubm92PXJub3JtKDIwKSkKeTEwMDwtYXJpbWEuc2ltKG49MTAwLGxpc3QobWE9MC44KSwgaW5ub3Y9cm5vcm0oMTAwKSkKeTEwMGEgPC0gYXJpbWEuc2ltKG4gPSAxMDAsIGxpc3QobWEgPSBjKDAuNSwgMC40KSksIGlubm92ID0gcm5vcm0oMTAwKSkKeTEwMGIgPC0gYXJpbWEuc2ltKG4gPSAxMDAsIGxpc3QobWEgPSBjKDAuOSwgLTAuNSkpLCBpbm5vdiA9IHJub3JtKDEwMCkpCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ2d0c2Rpc3BsYXkoeTIwLG1haW49IkZpZ3VyYSA1LiBNQSgxKSAtIG4gPSAyMCIpCmdndHNkaXNwbGF5KHkxMDAsbWFpbj0iRmlndXJhIDYuIE1BKDEpIC0gbiA9IDEwMCIpCmBgYCAgIAoKVmVhbW9zIGFob3JhIGRvcyBzaW11bGFjaW9uZXMgZGUgcHJvY2Vzb3MgTUEoMiksIGFtYmFzIGNvbiAxMDAgZGF0b3MgKGZpZ3VyYXMgNyB5IDgpLiBFbiBsYSBwcmltZXJhIHNlIHRpZW5lIHF1ZSAkeV90ID0gMC41XHZhcmVwc2lsb25fe3QtMX0gKyAwLjQgXHZhcmVwc2lsb25fe3QtMn0rIFx2YXJlcHNpbG9uX3QkIHkgZW4gbGEgc2VndW5kYSAkeV90ID0gMC45XHZhcmVwc2lsb25fe3QtMX0gLSAwLjUgXHZhcmVwc2lsb25fe3QtMn0rIFx2YXJlcHNpbG9uX3QkLgoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ2d0c2Rpc3BsYXkoeTEwMGEsIG1haW4gPSAiRmlndXJhIDcuIE1BKDIpIC0gbiA9IDEwMCIpCmdndHNkaXNwbGF5KHkxMDBiLCBtYWluID0gIkZpZ3VyYSA4LiBNQSgyKSAtIG4gPSAxMDAiKQpgYGAKClwKCiMjIFByb2Nlc29zIEFSTUEocCxxKQoKIyMjIERlZmluaWNpw7NuIHstfQoKRWwgbW9kZWxvIGdlbmVyYWwgJHlfdCBcc2ltIEFSTUEocCxxKSQgdmllbmUgZGFkbyBwb3IKJCR5X3QgPSBjICsgXHBoaV8xIHlfe3QtMX0gKyBccGhpXzIgeV97dC0yfSArIFxsZG90cyArIFxwaGlfcCB5X3t0LXB9ICArIAogICAgICAgIFx0aGV0YV8xIFx2YXJlcHNpbG9uX3t0LTF9ICsgXHRoZXRhXzIgXHZhcmVwc2lsb25fe3QtMn0gKyBcbGRvdHMgKwogICAgICAgIFx0aGV0YV9xIFx2YXJlcHNpbG9uX3t0LXF9KyBcdmFyZXBzaWxvbl90LCQkCnF1ZSB1c2FuZG8gZWwgb3BlcmFkb3IgcmV0YXJkbyBxdWVkYQokJCgxIC0gXHBoaV8xIEwgLSBcbGRvdHMgLSBccGhpX3AgTF5wKXlfdCA9IGMgKyAoMSArIFx0aGV0YV8xIEwgKyBcbGRvdHMgKyBcdGhldGFfcSBMXnEpIFx2YXJlcHNpbG9uX3QuJCQKCkVsIHByb2Nlc28gbcOhcyBzaW1wbGUgZXMgZWwgQVJNQSgxLDEpLCAkeV90ID0gYyAgKyBccGhpXzEgeV97dC0xfSArIFx0aGV0YV8xIFx2YXJlcHNpbG9uX3t0LTF9ICsgXHZhcmVwc2lsb25fe3R9JC4KCgojIyMgUHJvcGllZGFkZXMgey19CgpFbCBwcm9jZXNvIGVzIF9fZXN0YWNpb25hcmlvX18gc2kgcXVlZGFuIGZ1ZXJhIGRlbCBjw61yY3VsbyBkZSByYWRpbyBsYSB1bmlkYWQgdG9kYXMgbGFzIHJhw61jZXMgZGVsIHBvbGlub21pbwokJFxQaGlfcCh6KSA9IDEgLSBccGhpXzEgeiAtIFxwaGlfMiB6XjIgLSBcbGRvdHMgLSBccGhpX3Agel5wLiQkCkVsIHByb2Nlc28gZXMgX19pbnZlcnRpYmxlX18gc2kgcXVlZGFuIGZ1ZXJhIGRlbCBjw61yY3VsbyBkZSByYWRpbyBsYSB1bmlkYWQgdG9kYXMgbGFzIHJhw61jZXMgZGVsIHBvbGlub21pbwokJFxUaGV0YV9xKHopID0gMSArIFx0aGV0YV8xIHogKyBcdGhldGFfMiB6XjIgKyBcbGRvdHMgKyBcdGhldGFfcSB6XnEuJCQKX19Tb2JyZSB0b2RvX18sCgoqIExhIEZBQyBkZWNhZSBleHBvbmVuY2lhbG1lbnRlIGEgcGFydGlyIGRlbCBvcmRlbiBwLgoqIExhIEZBQ1AgZGVjYWUgZXhwb25lbmNpYWxtZW50ZSBhIHBhcnRpciBkZWwgb3JkZW4gcS4KCiMjIyBFamVtcGxvcyB7LX0KCiogJHlfdCBcc2ltIEFSTUEoMSwgMSk6IFw7XDt5X3QgPSBjICArIFxwaGlfMSB5X3t0LTF9ICsgXHRoZXRhXzEgXHZhcmVwc2lsb25fe3QtMX0gKyBcdmFyZXBzaWxvbl97dH0kIG8gJCgxIC0gXHBoaV8xIEwpeV90ID0gYyArICgxICsgXHRoZXRhXzEgTClcdmFyZXBzaWxvbl90JC4KKiAkeV90IFxzaW0gQVJNQSgwLCAwKTogXDtcO3lfdCA9IGMgKyBcdmFyZXBzaWxvbl97dH0kLiBTaSAkYyA9IDAkLCBhIGVzdGUgcHJvY2VzbyBzZSBsZSBkZW5vbWluYSAqKnJ1aWRvIGJsYW5jbyoqLgoKCiMjIyBTaW11bGFjacOzbiBkZSBwcm9jZXNvcyBBUk1BIHstfQoKTGFzIGZpZ3VyYXMgOSBhIDExIG11ZXN0cmFuIGxhcyBGQUMgeSBGQUNQIGRlIHRyZXMgc2ltdWxhY2lvbmVzIGRlIHRhbWHDsW8gMjAwIHBhcmEgcHJvY2Vzb3MgQVJNQSgxLDEpLCBBUk1BKDIsMSkgeSBBUk1BKDEsMikuIEVuIHRvZG9zIGxvcyBjYXNvcyAkXHZhcmVwc2lsb25fdCQgc2UgZGlzdHJpYnV5ZSBjb21vIHVuYSBub3JtYWwgY29uIG1lZGlhIGNlcm8geSB2YXJpYW56YSBsYSB1bmlkYWQuCgpgYGB7cixlY2hvPUZBTFNFfQpzZXQuc2VlZCg2NTQzMjEpCnkyMDBhIDwtIGFyaW1hLnNpbShuID0gMjAwLGxpc3QoYXIgPSAwLjcsIG1hID0gMC42KSwgaW5ub3YgPSBybm9ybSgyMDApKQp5MjAwYiA8LSBhcmltYS5zaW0obiA9IDIwMCxsaXN0KGFyPWMoMC43LCAtMC41KSwgbWEgPSAwLjYpLCBpbm5vdiA9IHJub3JtKDIwMCkpCnkyMDBjIDwtIGFyaW1hLnNpbShuID0gMjAwLGxpc3QoYXIgPSAwLjYsIG1hID0gYygwLjUsIDAuMykpLCBpbm5vdiA9IHJub3JtKDIwMCkpCmBgYAoKJHlfdCA9IDAuN3lfe3QtMX0gKyAwLjZcdmFyZXBzaWxvbl97dC0xfSArIFx2YXJlcHNpbG9uX3QkCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuaGVpZ2h0PTN9CmdyaWQuYXJyYW5nZSgKICBnZ0FjZih5MjAwYSwgbGFnID0gMTAsIG1haW4gPSAiRmlndXJhIDkuIFByb2Nlc28gQVJNQSgxLCAxKSIsIHhsYWIgPSAiUmV0YXJkbyIsIHlsYWIgPSAiRkFDIiksCiAgZ2dQYWNmKHkyMDBhLCBsYWcgPSAxMCwgbWFpbiA9ICIiLCB4bGFiID0gIlJldGFyZG8iLCB5bGFiID0gIkZBQ1AiKSwKICBucm93ID0gMQopCmBgYAoKJHlfdCA9IDAuN3lfe3QtMX0tIDAuNXlfe3QtMn0gKyAwLjZcdmFyZXBzaWxvbl97dC0xfSArIFx2YXJlcHNpbG9uX3QkCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuaGVpZ2h0PTN9CmdyaWQuYXJyYW5nZSgKICBnZ0FjZih5MjAwYiwgbGFnID0gMTAsIG1haW4gPSAiRmlndXJhIDEwLiBQcm9jZXNvIEFSTUEoMiwgMSkiLCB4bGFiID0gIlJldGFyZG8iLCB5bGFiID0gIkZBQyIpLAogIGdnUGFjZih5MjAwYiwgbGFnID0gMTAsIG1haW4gPSAiIiwgeGxhYiA9ICJSZXRhcmRvIiwgeWxhYiA9ICJGQUNQIiksCiAgbnJvdyA9IDEKKQpgYGAKCiR5X3QgPSAwLjZ5X3t0LTF9ICsgMC41XHZhcmVwc2lsb25fe3QtMX0gKyAwLjNcdmFyZXBzaWxvbl97dC0yfSArIFx2YXJlcHNpbG9uX3QkCgpgYGB7ciwgZWNobyA9IEZBTFNFLCBmaWcuaGVpZ2h0PTN9CmdyaWQuYXJyYW5nZSgKICBnZ0FjZih5MjAwYywgbGFnID0gMTAsIG1haW4gPSAiRmlndXJhIDExLiBQcm9jZXNvIEFSTUEoMSwgMikiLCB4bGFiID0gIlJldGFyZG8iLCB5bGFiID0gIkZBQyIpLAogIGdnUGFjZih5MjAwYywgbGFnID0gMTAsIG1haW4gPSAiIiwgeGxhYiA9ICJSZXRhcmRvIiwgeWxhYiA9ICJGQUNQIiksCiAgbnJvdyA9IDEKKQpgYGAgIAoKXAoKIyMgUHJvY2VzbyBBUklNQShwLGQscSkKCl9fU2kgbGEgc2VyaWUgJHlfdCQgbm8gZXMgZXN0YWNpb25hcmlhIHBlcm8gdHJhcyBkaWZlcmVuY2lhcmxhICRkJCB2ZWNlcyBzZSBoYWNlIGVzdGFjaW9uYXJpYSwgZGlyZW1vcyBxdWUgbGEgc2VyaWUgZXMgaW50ZWdyYWRhIGRlIG9yZGVuICRkJF9fOiAkeV90IFxzaW0gSShkKSQuIFBvciB0YW50bywKCiogdW5hIHNlcmllIGVzdGFjaW9uYXJpYSBzZSBpbmRpY2Fyw6EgY29tbyAkeV90IFxzaW0gSSgwKSQKKiAkeV90IFxzaW0gSShkKSQgZXMgZXF1aXZhbGVudGUgYSAkXG5hYmxhXmQgeV90ID0gKDEgLSBMKV5kIHlfdCBcc2ltIEkoMCkkCgpVbmEgc2VyaWUgJHlfdCQgc2lndWUgdW4gcHJvY2VzbyBfXyRBUklNQShwLGQscSkkX18gc2k6CgoxLiAkeV90IFxzaW0gSShkKSQgKGhheSBxdWUgZGlmZXJlbmNpYXJsYSAkZCQgdmVjZXMgcGFyYSBoYWNlcmxhIGVzdGFjaW9uYXJpYSksIHkKMi4gJFxuYWJsYV5kIHlfdCBcc2ltIEFSTUEocCxxKSQuCiAgICAgIApFbnRvbmNlcywgcG9kZW1vcyBlc2NyaWJpcjogClxiZWdpbntlcXVhdGlvbip9ClxiZWdpbnthcnJheX17Y0B7XHFxdWFkfWNAe1xxdWFkfWNjY30KICB5X3QgXHNpbSAgQVJJTUEocCxkLHEpOiAmICgxIC0gXHBoaV8xIEwgLSBcbGRvdHMgLSBccGhpX3AgTF5wKSAmICgxLSBMKV5kIHlfdCAmID0gJiBjICsgKDEgKyBcdGhldGFfMSBMICsgXGxkb3RzICsgXHRoZXRhX3EgTF5xKSBcdmFyZXBzaWxvbl90IFxcIAogICAgICAgICAgICAgICAgICAgICAgICAgICYgXHVwYXJyb3cgICAgICAgICAgICAgICAgICAgICAgICAgICAgJiBcdXBhcnJvdyAgICAgICYgICAmIFx1cGFycm93IFxcCiAgICAgICAgICAgICAgICAgICAgICAgICAgJiBBUihwKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmIEkoZCkgICAgICAgICAgJiAgICYgTUEocSkgClxlbmR7YXJyYXl9ClxlbmR7ZXF1YXRpb24qfQoKCiMjIyBFamVtcGxvcyB7LX0KCiogJHlfdCBcc2ltIEFSSU1BKDEsIDEsIDEpOiBcO1w7KDEgLSBccGhpXzEgTCkoMS0gTCkgeV90ID0gYyArICgxICsgXHRoZXRhXzEgTCkgXHZhcmVwc2lsb25fdCQgbyAkeV90ID0gYyArIHlfe3QtMX0gKyBccGhpXzEoeV97dC0xfSAtIHlfe3QtMn0pICsgXHRoZXRhXzEgXHZhcmVwc2lsb25fe3QtMX0gKyBcdmFyZXBzaWxvbl90JC4KKiAkeV90IFxzaW0gQVJJTUEoMCwgMSwgMCk6IFw7XDsoMS0gTCkgeV90ID0gYyArIFx2YXJlcHNpbG9uX3QkIG8gJHlfdCA9IGMgKyB5X3t0LTF9ICsgXHZhcmVwc2lsb25fdCQuIFNpICRjPTAkLCB0ZW5lbW9zIHVuICoqcGFzZW8gYWxlYXRvcmlvKio7IHNpICRjIFxuZXEgMCQsIHRlbmVtb3MgdW4gKipwYXNlbyBhbGVhdG9yaW8gY29uIGRlcml2YSoqLgoKIyMjIFNpbXVsYWNpw7NuIGRlIHByb2Nlc29zIG5vIGVzdGFjaW9uYXJpb3Mgey19CgpWZWFtb3MgbGEgRkFDIGRlIHRyZXMgc2VyaWVzIHNpbXVsYWRhcyBubyBlc3RhY2lvbmFyaWFzOiB1biBwYXNlbyBhbGVhdG9yaW8sIHVuIHBhc2VvIGFsZWF0b3JpbyBjb24gZGVyaXZhIHkgdW4gbW9kZWxvIGxpbmVhbC4gU3VzIEZBQyBzb24gaW5kaXN0aW5ndWlibGVzLCBwZXJvIGxvcyB0cmVzIGNhc29zIHJldmVsYW4gY2xhcmFtZW50ZSBzdSBjYXLDoWN0ZXIgbm8gZXN0YWNpb25hcmlvLgoKYGBge3IsIGVjaG8gPSBGQUxTRX0KeTEgPC0gY3Vtc3VtKHJub3JtKDIwMCkpCnkyIDwtIDE6MjAwCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRSwgZmlnLmhlaWdodD02fQpncmlkLmFycmFuZ2UoCiAgZ2dBY2YoeTEsIGxhZyA9IDEwLCBtYWluID0gIkZpZ3VyYSAxMi4gU2VyaWVzIG5vIGVzdGFjaW9uYXJpYXMiLCB4bGFiID0gIlBhc2VvIGFsZWF0b3JpbyIsIHlsYWIgPSAiRkFDIiksCiAgZ2dBY2YoeTIsIGxhZyA9IDEwLCBtYWluID0gIiIsIHhsYWIgPSAiRGV0ZXJtaW5pc3RhIGxpbmVhbCIsIHlsYWIgPSAiIiksCiAgZ2dBY2YoeTEgKyB5MiwgbGFnID0gMTAsIG1haW4gPSAiIiwgeGxhYiA9ICJQYXNlbyBhbGVhdG9yaW8gY29uIGRlcml2YSIsIHlsYWIgPSAiIiksCiAgbnJvdyA9IDMKKQpgYGAgCgpcClwKCiMgQXByb3hpbWFjacOzbiBkZSBCb3gtSmVua2lucwoKTGEgc2lndWllbnRlIGZpZ3VyYSBtdWVzdHJhIGVsIGZsdWpvIGRlIHByb2Nlc29zIGFzb2NpYWRvIGEgbGEgbW9kZWxpemFjacOzbiBwb3IgbW9kZWxvcyBBUklNQSwgY29uIGN1YXRybyBncmFuZGVzIMOhcmVhczoKCiogX19JZGVudGlmaWNhY2nDs25fXywgcXVlIHJlcXVpZXJlIHByaW1lcm8gdHJhbnNmb3JtYXIgbGEgc2VyaWUgcGFyYSBxdWUgc2VhIGVzdGFjaW9uYXJpYSB5IGVyZ8OzZGljYSwgcGFyYSBkZXNwdcOpcyBpZGVudGlmaWNhciBsb3MgdmFsb3JlcyBkZSBwIHkgcS4KCiAgTGEgRkFDIHkgbGEgZnVuY2nDs24gZGUgYXV0b2NvcnJlbGFjacOzbiBwYXJjaWFsIHRlw7NyaWNhcyBzb24gZGlmZXJlbnRlcyBlbiBjYWRhIHRpcG8gZGUgcHJvY2Vzby4gSWRlYWxtZW50ZSwgc3UgZXN0aW1hY2nDs24gYSBwYXJ0aXIgZGUgbGEgc2VyaWUgdGVtcG9yYWwgcG9kcsOtYSBzZXJ2aXIgZGUgYXl1ZGEgZW4gbGEgaWRlbnRpZmljYWNpw7NuIGRlbCBwcm9jZXNvIGVzdG9jw6FzdGljby4gRW4gbGEgcHLDoWN0aWNhLCBsYSBmdW5jaW9uZXMgZXN0aW1hZGFzIHNvbiB0YW4gZGlmZXJlbnRlcyBkZSBsYXMgdGXDs3JpY2FzIHF1ZSByZXN1bHRhbiBkZSBtdXkgcG9jYSBheXVkYS4KCiAgSGFyZW1vcyB1c28gZGUgYWxndW5hcyBmdW5jaW9uZXMgZGUgX2F1dG9fIGlkZW50aWZpY2FjacOzbiBxdWUgbm9zIGF5dWRhcmFuIGVuIGVzdGUgcHVudG8uCiAgCiogX19Fc3RpbWFjacOzbl9fIGRlIGxvcyBwYXLDoW1ldHJvcyBkZWwgbW9kZWxvLCBpbmNsdWlkYXMgbGFzIHZhcmlhYmxlcyBkZSBpbnRlcnZlbmNpw7NuIHkgb2J0ZW5jacOzbiBkZWwgZXJyb3IuIEVsIG3DqXRvZG8gdXN1YWwgZGUgZXN0aW1hY2nDs24gZGUgbG9zIHBhcsOhbWV0cm9zIGVzIHBvciBtw6F4aW1hIHZlcm9zaW1pbGl0dWQuCgoqIF9fVmFsaWRhY2nDs25fXyBkZSBsYXMgaGlww7N0ZXNpcyBzb2JyZSBlbCByZXNpZHVvLCBjb250cmFzdGUgZGUgc2lnbmlmaWNhdGl2aWRhZCBkZSBsb3MgcGFyw6FtZXRyb3MgZXN0aW1hZG9zIHkgY29tcHJvYmFjacOzbiBkZSBxdWUgbm8gaGF5IG3DoXMgaW50ZXJ2ZW5jacOzbi4KCiAgU2kgbGEgdmFsaWRhY2nDs24gbm8gc2UgcGFzYSwgcHVlZGUgc2VyIG5lY2VzYXJpbyB2b2x2ZXIgYWwgcHJvY2VzbyBpbmljaWFsIHkgcmVhbGl6YXIgdW5hIG51ZXZhIGlkZW50aWZpY2FjacOzbiBkZWwgbW9kZWxvLgogIAoqIF9fUHJlZGljY2nDs25fXyBlIGludGVycHJldGFjacOzbiBkZWwgbW9kZWxvIHbDoWxpZG8uIFNpIGxhcyBwcmVkaWNjaW9uZXMgc2UgYWxlamFuIGRlIGxvcyB2YWxvcmVzIHJlYWxlcyBtw6FzIGRlIGxvIGVzcGVyYWRvIG8gcHJlc2VudGFuIHNlc2dvLCBwdWVkZSBzZXIgbmVjZXNhcmlvIGlkZW50aWZpY2FyIHkgZXN0aW1hciB1biBudWV2byBtb2RlbG8uCgohW0Fwcm94aW1hY2nDs24gQm94LUplbmtpbnNdKC4vaW1hZ2VuZXMvQm94SmVua2lucy5wbmcpCgpcClwKCiMgRWplbXBsb3MKClwKCiMjIFTDrXR1bG9zIGRlIGxpYnJvcyB5IHBhbmZsZXRvcwoKVmFtb3MgYSBhcGxpY2FyIGxhIG1ldG9kb2xvZ8OtYSBkZSBCb3gtSmVua2lucyBhIGxhIHNlcmllIExpYnJvcyAobsO6bWVybyBkZSB0w610dWxvcyBwdWJsaWNhZG9zIGFudWFsbWVudGUgZW4gRXNwYcOxYSBkZXNkZSAxOTkzIGhhc3RhIDIwMTgpLgoKCmBgYHtyfQpsaWJyb3MgPC0gcmVhZC5jc3YyKCIuL3Nlcmllcy9saWJyb3MuY3N2IiwgaGVhZGVyID0gVFJVRSkKbGlicm9zIDwtIHRzKGxpYnJvc1ssIDJdLCBzdGFydCA9IDE5OTMsIGZyZXF1ZW5jeSA9IDEpCgphdXRvcGxvdChsaWJyb3MsCiAgICAgICAgIHhsYWIgPSAiIiwgCiAgICAgICAgIHlsYWIgPSAiIiwgCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDEzLiBUw610dWxvcyBwdWJsaWNhZG9zIikKYGBgCgojIyMgVHJhbnNmb3JtYWNpw7NuIGRlIGxhIHNlcmllIHstfQoKRWwgcHJpbWVyIHBhc28gZXMgdHJhbnNmb3JtYXIgbGEgc2VyaWUgb3JpZ2luYWwgcGFyYSBxdWUgc2VhIGVzdGFjaW9uYXJpYS4gRW4gZWwgdGVtYSAzIHlhIHZpbW9zIHF1ZSBsYSBwcmltZXJhIGRpZmVyZW5jaWEgZGUgbGEgc2VyaWUgTGlicm9zIGVzIGVzdGFjaW9uYXJpYSB5IGVyZ8OzZGljYS4gRXMgZGVjaXIsICRkPTEkIG8gJGxpYnJvc190IFxzaW0gSSgxKSQuIENvbW8gcmVjb3JkYXRvcmlvLCBsYSBmaWd1cmEgMTQgbXVlc3RyYSBsYSBncsOhZmljYSB0ZW1wb3JhbCB5IGxhIEZBQyBwYXJhIGxhIHNlcmllIG9yaWdpbmFsIHkgc3UgcHJpbWVyYSBkaWZlcmVuY2lhLiAKCmBgYHtyLCBldmFsID0gRkFMU0V9CmF1dG9wbG90KGxpYnJvcywgeGxhYiA9ICIiLCB5bGFiID0gIiIsIG1haW4gPSAiTGlicm9zIikKYXV0b3Bsb3QoZGlmZihsaWJyb3MpLCB4bGFiID0gIiIsIHlsYWIgPSAiIiwgbWFpbiA9ICJEaWZlcmVuY2lhIGxpYnJvcyIpCmdnQWNmKGxpYnJvcywgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIikKZ2dBY2YoZGlmZihsaWJyb3MpLCB4bGFiID0gIiIsIHlsYWIgPSAiRkFDIiwgbWFpbiA9ICIiKQpgYGAKCmBgYHtyLCBlY2hvID0gRkFMU0V9CmdyaWQuYXJyYW5nZSgKICBhdXRvcGxvdChsaWJyb3MsIHhsYWIgPSAiTGlicm9zIiwgeWxhYiA9ICIiLCBtYWluID0gIkZpZ3VyYSAxNC4gVMOtdHVsb3MgcHVibGljYWRvcyIpLAogIGF1dG9wbG90KGRpZmYobGlicm9zKSwgeGxhYiA9ICJEaWZlcmVuY2lhIGxpYnJvcyIsIHlsYWIgPSAiIiwgbWFpbiA9ICIiKSwKICBnZ0FjZihsaWJyb3MsIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpLAogIGdnQWNmKGRpZmYobGlicm9zKSwgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIiksCiAgbnJvdyA9IDIKKQpgYGAKCiMjIyBJZGVudGlmaWNhY2nDs24gey19CgpUcmFzIGRpZmVyZW5jaWFyIGxhIHNlcmllLCB2YW1vcyBhIGlkZW50aWZpY2FyIGxvcyB2YWxvcmVzIGRlICRwJCB5ICRxJCBhIHBhcnRpciBkZSBsYXMgRkFDIHkgRkFDUCBkZSBsYSBzZXJpZSBkaWZlcmVuY2lhZGEgKGZpZ3VyYSAxNSkuIAoKYGBge3J9IApnZ3RzZGlzcGxheShkaWZmKGxpYnJvcyksIG1haW4gPSAiRmlndXJhIDE1LiBMaWJyb3MgKHByaW1lcmEgZGlmZXJlbmNpYSkiKQpgYGAKCk9ic2VydmFtb3MgcXVlOgoKKiBFbiBsYSBGQUMgbmluZ3VuYSBhdXRvY29ycmVsYWNpw7NuIHNvYnJlcGFzYSBsYXMgbMOtbmVhcyBxdWUgbWFyY2FuIGVsIGludGVydmFsbyBkZSBjb25maWFuemEgYWwgOTUlLgoqIEVuIGxhIEZBQ1AgdGFtcG9jbyBsYXMgYXV0b2NvcnJlbGFjaW9uZXMgcGFyY2lhbGVzIHNvYnJlcGFzYW4gZWwgaW50ZXJ2YWxvIGRlIGNvbmZpYW56YS4KICAgICAgClBhcmVjZSwgcG9yIHRhbnRvLCBydWlkbyBibGFuY28sICRwPXE9MCQuIExhIGlkZW50aWZpY2FjacOzbiBpbmljaWFsIGVzICRsaWJyb3NfdCBcc2ltIEFSSU1BKDAsMSwwKSQsIHBhc2VvIGFsZWF0b3JpbywgcXVlIGluaWNpYWxtZW50ZSBhc3VtaXJlbW9zIGNvbiBkZXJpdmE6CiQkbGlicm9zX3QgPSBjICsgbGlicm9zX3t0LTF9ICsgXHZhcmVwc2lsb25fdCQkCgojIyMgRXN0aW1hY2nDs24gey19CgpBdW5xdWUgZXhpc3RlIGxhIGZ1bmNpw7NuIGBhcmltYWAgZGUgYHN0YXRzYCwgdmFtb3MgYSB1c2FyIGxhIGZ1bmNpw7NuIGBBcmltYWAgZGUgbGEgbGlicmVyw61hIGBmb3JlY2FzdGAgcGFyYSBlc3RpbWFyIGVsIG1vZGVsbyBpZGVudGlmaWNhZG8gcG9yIHNlciBtw6FzIHZlcnPDoXRpbC4gRWwgYXJndW1lbnRvIGBvcmRlcmAgaW5kaWNhIGxvcyB2YWxvcmVzIGRlIChwLCBkICwgcSkgY29tbyB1biB2ZWN0b3IgeSBlbCBhcmd1bWVudG8gbMOzZ2ljbyBgaW5jbHVkZS5jb25zdGFudGAgZnVlcnphIGEgcXVlIHNlIGluY2x1eWEgbGEgY29uc3RhbnRlICRjJCBlbiBlbCBtb2RlbG8uIChNaXJhIGVuIGxhIGF5dWRhIGRlIGxhIGZ1bmNpw7NuIGBBcmltYWAgbGEgZGlmZXJlbmNpYSBlbnRyZSBsb3MgYXJndW1lbnRvcyBgaW5jbHVkZS5tZWFuYCwgYGluY2x1ZGUuZHJpZnRgIGUgYGluY2x1ZGUuY29uc3RhbnRgKS4KCmBgYHtyfQphcmltYTAxMCA8LSBBcmltYShsaWJyb3MsIAogICAgICAgICAgICAgICAgIG9yZGVyPWMoMCwgMSwgMCksIAogICAgICAgICAgICAgICAgIGluY2x1ZGUuY29uc3RhbnQgPSBUUlVFKQphcmltYTAxMApgYGAKCkxhIGRlcml2YSBubyBwYXJlY2Ugc2VyIHNpZ25pZmljYXRpdmEsIGRhZG8gcXVlIHN1IHZhbG9yIGVzdGltYWRvIG5vIGVzIG1heW9yIHF1ZSBkb3MgdmVjZXMgZWwgZXJyb3IgZXN0w6FuZGFyIChzLmUuKS4gVW5hIGZvcm1hIHLDoXBpZGEsIGF1bnF1ZSBpbXByZWNpc2EsIGRlIGRldGVybWluYXIgc2kgdW4gY29lZmljaWVudGUgZXMgcmVsZXZhbnRlIChzaWduaWZpY2F0aXZvKSBlcyBjb21wYXJhcmxvIGNvbiBzdSBlcnJvciBlc3TDoW5kYXIgKHN0YW5kYXJkIGVycm9yLCBzLmUpLiBTaSBlbCBjb2VmaWNpZW50ZSBlcyBtYXlvciBxdWUgZG9zIHZlY2VzIHN1IGVycm9yIGVzdMOhbmRhciwgaGF5IGV2aWRlbmNpYSBkZSBxdWUgZXMgc2lnbmlmaWNhdGl2by4gRW4gbGEgdGFibGEgYENvZWZmaWNpZW50c2AgdGllbmVzIGVuIGxhIHByaW1lcmEgZmlsYSBlbCBub21icmUgZGUgbG9zIGNvZWZpY2llbnRlcyAoYGFyYCBlbiBsdWdhciBkZSAkXHBoaSQgeSBgbWFgIGVuIGx1Z2FyIGRlICRcdGhldGEkOyBzdSB2YWxvciBhcGFyZWNlIGVuIGxhIHNlZ3VuZGEgZmlsYSBkZSBsYSB0YWJsYTsgeSBsb3MgZXJyb3JlcyBlc3TDoW5kYXIgZW4gbGEgdGVyY2VyYSBmaWxhIChlbmNhYmV6YWRhIHBvciBzLmUuKS4gQ29uIGVzdGEgcmVnbGEsIHBhcmVjZSBxdWUgbGEgY29uc3RhbnRlIG5vIGVzIHNpZ25pZmljYXRpdmEuIAoKQWhvcmEgYmllbiwgYSBmaW4gZGUgcG9uZXIgdW4gcG9jbyBkZSBfb2JqZXRpdmlkYWRfIGVuIGVzdGEgZGVjaXNpw7NuLCBwb2RlbW9zIGFwbGljYXIgbGEgcHJ1ZWJhIGRlIFdhbGQsIHF1ZSBwZXJtaXRlIGNvbnRyYXN0YXIgc2kgdW4gc3ViY29uanVudG8gZGUgY29lZmljaWVudGVzIGVzIHNpZ25pZmljYXRpdm8gKHNlIHByZWNpc2EgbGEgbGlicmVyw61hIGBhb2RgKS4gRXN0YSBmdW5jacOzbiByZXF1aWVyZSBkZSB0cmVzIGFyZ3VtZW50b3M6IGVsIHZlY3RvciBkZSBjb2VmaWNpZW50ZXMgKGBiYCksIHN1IG1hdHJpeiBkZSBjb3ZhcmlhbnphcyAoYFNpZ21hYCkgeSBsYSBwb3NpY2nDs24gZGUgbG9zIGNvZWZpY2llbnRlcyBjdXlhIHNpZ25pZmljYXRpdmlkYWQgY29uanVudGEgZGVzZWFtb3MgY29udHJhc3RhciAoYFRlcm1zYCkuIExvcyBkb3MgcHJpbWVyb3MgYXJndW1lbnRvcyBsb3MgcG9kZW1vcyBvYnRlbmVyIGRlbCBvYmpldG8gYGFyaW1hMDEwYCBjb24gbGFzIGZ1bmNpb25lcyBgY29lZmAgeSBgdmNvdmAuIAoKVmFtb3MgYSB1c2FyIGxhIGZ1bmNpw7NuIGB0ZXN0LndhbGRgIHBhcmEgY29udHJhc3RhciBzaSBsYSBjb250YW50ZSAocHJpbWVyIHkgw7puaWNvIGNvZWZpY2llbnRlIGRlbCBtb2RlbG8pIGVzIHNpZ25pZmljYXRpdm8uCiAgCmBgYHtyfQp3YWxkLnRlc3QoYiA9IGNvZWYoYXJpbWEwMTApLCAKICAgICAgICAgIFNpZ21hID0gdmNvdihhcmltYTAxMCksIAogICAgICAgICAgVGVybXMgPSAxKQpgYGAKCkNvbW8gZWwgdmFsb3IgZGUgcCwgaWd1YWwgYSBgciByb3VuZCh3YWxkLnRlc3QoYiA9IGNvZWYoYXJpbWEwMTApLCBTaWdtYSA9IHZjb3YoYXJpbWEwMTApLCBUZXJtcyA9IDEpJHJlc3VsdCRjaGkyWzNdLCAzKWAgZXMgbWF5b3IgcXVlIGxhIHNpZ25pZmljYXRpdmlkYWQgJFxhbHBoYSA9JCAwLjA1LCBzZSBjb25jbHV5ZSBxdWUgbGEgY29uc3RhbnRlIG5vIGVzIHNpZ25pZmljYXRpdmEsIG5vIGhheSBkZXJpdmEuIAoKUmUtZXN0aW1hbW9zIGVsIG1vZGVsbyBjb21vIHVuIHBhc2VvIGFsZWF0b3JpbyBzaW4gZGVyaXZhLAoKYGBge3J9CmFyaW1hMDEwIDwtIEFyaW1hKGxpYnJvcywgCiAgICAgICAgICAgICAgICAgb3JkZXI9YygwLCAxLCAwKSwgCiAgICAgICAgICAgICAgICAgaW5jbHVkZS5jb25zdGFudCA9IEZBTFNFKQphcmltYTAxMApgYGAKCk51ZXN0cm8gbW9kZWxvIGVzdGltYWRvIGVzOiAkXHdpZGVoYXR7bGlicm9zfV90ID0gbGlicm9zX3t0LTF9JCDCoWVsIG3DqXRvZG8gaW5nZW51byBJIQoKIyMjIFZhbGlkYWNpw7NuIHstfQoKVmVhbW9zIHNpIGVsIHJlc2lkdW8gdmVyaWZpY2EgdG9kYXMgbGFzIGhpcMOzdGVzaXMgaW5kaWNhZGFzIGVuIGVsIGVww61ncmFmZSAzLjIKCiMjIyMgTWVkaWEgY2VybyB7LX0KCk5vIHNlIHB1ZWRlIGNvbnRyYXN0YXIgc2kgZWwgcmVzaWR1byB0aWVuZSBfX21lZGlhIGNlcm9fXywgcGVybyBlbCBlcnJvciBtZWRpbyBlcyAkTUU9JCBgciByb3VuZChhY2N1cmFjeShhcmltYTAxMClbMV0sMilgLCByZWxhdGl2YW1lbnRlIGJham8gZW4gY29tcGFyYWNpw7NuIGNvbiBlbCB2YWxvciBtZWRpbyBkZSBsYSBzZXJpZS4KCkFkZW3DoXMsIHRlbmVtb3MgbGFzIGRpZmVyZW50ZXMgbWVkaWRhcyBkZSBib25kYWQgZGVsIGFqdXN0ZS4gRW4gbWVkaWEgbm9zIGVxdWl2b2NhbW9zIGVuIGByIHJvdW5kKGFjY3VyYWN5KGFyaW1hMDEwKVsyXSwwKWAgdMOtdHVsb3MgKFJNU0UpIHkgZWwgZXJyb3IgcG9yY2VudHVhbCBtZWRpbyAoTUFQRSkgZXMgYHIgcm91bmQoYWNjdXJhY3koYXJpbWEwMTApWzVdLDEpYCUuCgpgYGB7cixldmFsPUZBTFNFfQphY2N1cmFjeShhcmltYTAxMCkKYGBgCgpgYGB7cixlY2hvPUZBTFNFfQpyb3VuZChhY2N1cmFjeShhcmltYTAxMCksMikKYGBgCiAgClwKCiMjIyMgSW5jb3JyZWxhY2nDs24gey19ICAgICAKCkxvIHZlcmVtb3MgY29uIGVsIHRlc3QgZGUgQm94LUxqdW5nCgoqIExhIGhpcMOzdGVzaXMgbnVsYSBlcyAkSF8wOiBccmhvXzEgPSAuLi4gPSBccmhvX2sgPSAwJAoqIEVsIHZhbG9yIGRlIHAgPSBgciByb3VuZChCb3gudGVzdChyZXNpZHVhbHMoYXJpbWEwMTApLCBsYWcgPSAyLHR5cGUgPSAiTGp1bmctQm94IikkcC52YWx1ZSwgMylgIGVzIG1heW9yIHF1ZSBlbCBuaXZlbCBkZSBzaWduaWZpY2F0aXZpZGFkIDAuMDUuIE5vIHNlIHJlY2hhemEgbGEgaGlww7N0ZXNpcyBkZSBpbmNvcnJlbGFjacOzbiwgaGFzdGEgZWwgb3JkZW4gJGsgPSAyJC4KCmBgYHtyfQplcnJvciA8LSByZXNpZHVhbHMoYXJpbWEwMTApCkJveC50ZXN0KGVycm9yLCBsYWcgPSAyLHR5cGUgPSAiTGp1bmctQm94IikKYGBgCiAgICAKTGEgZWxlY2Npw7NuIGRlIGRvcyByZXRhcmRvcyBwYXJhIGxhIHBydWViYSwgZmlqYWRvIGNvbiBlbCBwYXLDoW1ldHJvcyBgbGFnID0gMmAsIGVzIGJhc3RhbnRlIGFyYml0cmFyaWEuIFNlcsOtYSBtZWpvciByZWFsaXphciBsYSBwcnVlYmEgcGFyYSB1biByYW5nbyBkZSB2YWxvcmVzIGRlICRrJDoKICAgIApgYGB7cixlY2hvID0gRkFMU0V9CnBwIDwtIHJlcCgwLDQpCmZvciAoaSBpbiAxOjQpIHBwW2ldIDwtIHJvdW5kKEJveC50ZXN0KGVycm9yLCBsYWcgPSBpLCB0eXBlID0gIkxqdW5nLUJveCIpJHAudmFsdWUsIDMpCmRhdGEuZnJhbWUoayA9IDE6NCwgInZhbG9yIGRlIHAiID0gcHApCmBgYAoKXAoKIyMjIyBIb21vY2VkYXN0aWNpZGFkICh2YXJpYW56YSBjb25zdGFudGUpIHstfSAKCkxvIHZlcmVtb3MgY29uIGVsIHRlc3QgZGUgQm94LUxqdW5nIHBhcmEgZWwgcmVzaWR1byBhbCBjdWFkcmFkby4gTGEgaGlww7N0ZXNpcyBudWxhIHNlcmlhIHF1ZSBsYXMgcHJpbWVyYXMgJGskIGF1dG9jb3JyZWxhY2lvbmVzIGVzdGltYWRhcyBzb2JyZSBlbCBjdWFkcmFkbyBkZWwgcmVzaWR1byBzb24gY2Vyby4KCkVsIHZhbG9yIGRlIHAgPSBgciByb3VuZChCb3gudGVzdChlcnJvcl4yLCBsYWcgPSAyLHR5cGUgPSAiTGp1bmctQm94IikkcC52YWx1ZSwgMylgIGVzIG1heW9yIHF1ZSBlbCBuaXZlbCBkZSBzaWduaWZpY2F0aXZpZGFkIDAuMDUuIE5vIHNlIHJlY2hhemEgbGEgIGhpcMOzdGVzaXMgZGUgaG9tb2NlZGFzdGljaWRhZCwgaGFzdGEgZWwgb3JkZW4gMi4KCmBgYHtyfQpCb3gudGVzdChlcnJvcl4yLCBsYWcgPSAyLCB0eXBlID0gIkxqdW5nLUJveCIpCmBgYAoKRGUgbnVldm8sIGxhIGVsZWNjacOzbiBkZSBkb3MgcmV0YXJkb3MgZXMgdG90YWxtZW50ZSBhcmJpdHJhcmlhIHkgc2Vyw61hIG1lam9yIHJlYWxpemFyIGxhIHBydWViYSBwYXJhIHVuIHJhbmdvIGRlIHZhbG9yZXMgZGUgJGskLgogICAgCmBgYHtyLGVjaG8gPSBGQUxTRX0KcHAgPC0gcmVwKDAsNCkKZm9yIChpIGluIDE6NCkgcHBbaV0gPC0gcm91bmQoQm94LnRlc3QoZXJyb3JeMiwgbGFnID0gaSwgdHlwZSA9ICJManVuZy1Cb3giKSRwLnZhbHVlLCAzKQpkYXRhLmZyYW1lKGsgPSAxOjQsICJ2YWxvciBkZSBwIiA9IHBwKQpgYGAKClwKCiMjIyMgTm9ybWFsaWRhZCB7LX0gCgpSZWN1ZXJkYSBxdWUgdG9kb3MgbGFzIHBydWViYXMgZGUgbm9ybWFsaWRhZCBzb24gbXV5IHNlbnNpYmxlcyBhbCB0YW1hw7FvIGRlIGxhIG11ZXN0cmEuIFNpZW1wcmUgZXMgcmVjb21lbmRhYmxlIGVtcGV6YXIgcG9yIHVuIGFuw6FsaXNpcyBncsOhZmljbyAoaGlzdG9ncmFtYSwgZ3LDoWZpY28gUFAsIGdyw6FmaWNvIFFRKS4KClNpbiBlbWJhcmdvLCBjdWFuZG8gZXMgbmVjZXNhcmlvIHVuIGNyaXRlcmlvIG3DoXMgb2JqZXRpdm8gbyBzZSBwcmVjaXNhIGRlIHVuIHByb2Nlc28gYXV0b23DoXRpY28sIGVudG9uY2VzIHNpIGxhIG11ZXN0cmEgZXMgcmVkdWNpZGEgKDMwIGEgNTAgb2JzZXJ2YWNpb25lcyBzZWfDum4gYXV0b3Jlcykgc2UgYXBsaWNhIGxhIHBydWViYSBkZSBTaGFwaXJvLVdpbGs7IGVuIG90cm8gY2FzbyBzZSBhcGxpY2EgbGEgcHJ1ZWJhIGRlIEphcnF1ZS1CZXJhIChgdHNlcmllc2ApIG8gS29sbW9nb3Jvdi1TbWlybm92LiBFbiBudWVzdHJvIGVqZW1wbG8sIGNvbiAyNiBkYXRvcywgbG8gY29ycmVjdG8gZXMgYXBsaWNhciBsYSBwcnVlYmEgZGUgU2hhcGlyby1XaWxrLiBUYW1iacOpbiBoZW1vcyBhcGxpY2FkbyBKYXJxdWUtQmVyYSBwYXJhIHF1ZSB2ZWFzIGNvbW8gbGEgY29uY2x1c2nDs24gZGlmaWVyZSBzZWfDum4gbGEgcHJ1ZWJhIGVtcGxlYWRhLgoKYGBge3J9CnNoYXBpcm8udGVzdChlcnJvcikKamFycXVlLmJlcmEudGVzdChlcnJvcikKYGBgCgpcCgojIyMjIEludGVydmVuY2nDs24gey19CgpTZSBhbmFsaXphIHNpIHBhcmEgYWxnw7puIGHDsW8gc2Ugb2JzZXJ2YSB1biBlcnJvciBhdMOtcGljbyAgKHBvciBlamVtcGxvIDMgdmVjZXMgc3VwZXJpb3IgYWwgZXJyb3IgZXN0w6FuZGFyKS4gTGEgZmlndXJhIDE2IG11ZXN0cmEgcXVlIGVuIGVzdGUgY2FzbyBlbiBkb3MgcGVyaW9kb3MsIGHDsW9zIDIwMDggeSAyMDEzLCBlbCByZXNpZHVvIHNvYnJlcGFzYSBsb3MgZG9zIGVycm9yZXMgZXN0w6FuZGFyIHBlcm8gcXVlZGEgbGVqb3MgZGUgbG9zIHRyZXMgZXJyb3JlcyBlc3TDoW5kYXIgYXPDrSBxdWUgYXN1bWlyZW1vcyBxdWUgbm8gaGF5IHZhbG9yZXMgYXTDrXBpY29zLgoKYGBge3J9CnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDE2LiBFcnJvciArIEludGVydmVuY2nDs24iKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMywgLTIsIDIsIDMpKnNkZXJyb3IsIAogICAgICAgICAgICAgY29sb3VyID0gYygicmVkIiwgImdyZWVuIiwgImdyZWVuIiwgInJlZCIpLCAKICAgICAgICAgICAgIGx0eSA9IDIpICsgCiAgZ2VvbV9wb2ludCgpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk5MywgMjAxOSwgMikpIApgYGAKCiMjIyBQcmVkaWNjacOzbiB7LX0KClVuYSB2ZXogdmFsaWRhZG8gZWwgbW9kZWxvIHBvZGVtb3MgcGFzYXIgYSByZWFsaXphciBfX3ByZWRpY2Npb25lc19fLCBlbiBlc3RlIGNhc28gYSA1IGHDsW9zIHZpc3RhLgoKYGBge3J9CnBhcmltYTAxMCA8LSBmb3JlY2FzdChhcmltYTAxMCwgaCA9IDUsIGxldmVsID0gOTUpCnBhcmltYTAxMApgYGAKCmBgYHtyfQphdXRvcGxvdChwYXJpbWEwMTAsIAogICAgICAgICB4bGFiID0gIiIsIAogICAgICAgICB5bGFiID0gIlTDrXR1bG9zIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmUgMTcuIExpYnJvcyAoMTk5My0yMDE4KSB5IHByZWRpY2Npw7NuICgyMDE5LTIwMjMpIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTkzLCAyMDIzLCAyKSkgCmBgYAoKCkxhIGZpZ3VyYSAxNyBtdWVzdHJhIGxhIHNlcmllLCBsYSBwcmV2aXNpw7NuIHkgZWwgaW50ZXJ2YWxvIGRlIGNvbmZpYW56YSBhbCA5NSUuIExhIHByZWRpY2Npw7NuIGVzIGNvbnN0YW50ZSBlIGlndWFsIGFsIMO6bHRpbW8gZGF0by4gRW4gbGFzIHNlcmllcyBkaWZlcmVuY2lhZGFzIGVsIGludGVydmFsbyBkZSBjb25maWFuemEgZGUgbGFzIHByZWRpY2Npb25lcyBjcmVjZSBtdXkgcsOhcGlkYW1lbnRlIHBvcnF1ZSBsb3MgZXJyb3JlcyBzZSB2YW4gYWN1bXVsYW5kbyBzaW4gbmluZ8O6biB0aXBvIGRlIGFtb3J0aWd1YW1pZW50by4gCgojIyMgSWRlbnRpZmljYWNpw7NuIGF1dG9tw6F0aWNhIHstfQoKRWwgcGFxdWV0ZSBgZm9yZWNhc3RgIGRpc3BvbmUgZGUgbGEgZnVuY2nDs24gYGF1dG8uYXJpbWEoKWAgcXVlIGxvY2FsaXphIGVsIG1lam9yIG1vZGVsbyBiYXPDoW5kb3NlIGVuIGVsIEFJQyBjb3JyZWdpZG8gcGFyYSBwZXF1ZcOxYXMgbXVlc3RyYXMgKGBBSUNjYCkuIE5vIGhheSBxdWUgZmlhcnNlIGNpZWdhbWVudGUgZGUgbG9zIHJlc3VsdGFkb3MgZGUgZXN0YSBmdW5jacOzbiwgcGVybyBheXVkYSBlbiBsYSBpZGVudGlmaWNhY2nDs24uIELDoXNpY2FtZW50ZSBlbCBhbGdvcml0bW8gc2VndWlkbyBlcyBlbCBzaWd1aWVudGU6CgoxLiBEZXRlcm1pbmEgZWwgb3JkZW4gZGUgZGlmZXJlbmNpYWNpw7NuIHJlZ3VsYXIgJDAgXGxlcSBkIFxsZXEgMiQgdXNhbmRvIGxhIGZ1bmNpw7NuIGBuZGlmZnNgLCBxdWUgdXNhIGxhIHBydWViYSBLUFNTIHJlcGV0aWRhcyB2ZWNlcy4gCjIuIFRyYXMgZGlmZXJlbmNpYXIgbGEgc2VyaWU6CiAgICAqIHNlIGVzdGltYW4gdW5hIHNlcmllIGRlIG1vZGVsb3MgYsOhc2ljb3MgcHJlZGV0ZXJtaW5hZG9zLiAKICAgICogc2UgdXNhIGVsIGNyaXRlcmlvIEFJQ2MgcGFyYSBzZWxlY2Npb25hciBlbCBtZWpvciBkZSBlc3RvcyBtb2RlbG9zLiAKICAgICogYSBwYXJ0aXIgZGVsIG1vZGVsbyBzZWxlY2Npb25hZG8sIHNlIGhhY2VuIHBlcXVlw7FhcyB2YXJpYWNpb25lcyBtb2RpZmljYW5kbyBlbiB1bmEgdW5pZGFkIF9wXyB5IF9xXyB5IGHDsWFkaWVuZG8vcXVpdGFuZG8gbGEgY29uc3RhbnRlIHkgc2UgdnVlbHZlIGEgc2VsZWNjaW9uYXIgZWwgbWVqb3IgZGUgbG9zIG51ZXZvcyBtb2RlbG9zLgozLiBTZSByZXBpdGUgZWwgcGFzbyAyIGhhc3RhIHF1ZSBubyBzZSBwdWVkZSBtZWpvcmFyIGVsIEFJQ2MuIAoKQ3VhbmRvIHVzZW1vcyBlc3RhIGZ1bmNpw7NuLCBkZWJlbW9zIHRlbmVyIGN1ZW50YSBxdWU6CgoqIExhIGZ1bmNpw7NuIGBhdXRvLmFyaW1hYCBubyBwZXJtaXRlIGNvbnRhbnRlIHNpIGxhIHN1bWEgZGUgbGFzIGRpZmVyZW5jaWFjaW9uZXMgZXMgMiBvIHN1cGVyaW9yLiAKKiBTaSBzZSBkZXNlYSBoYWNlciB1bmEgYsO6c3F1ZWRhIGV4aGF1c3RpdmEgZW50cmUgdG9kb3MgbG9zIHBvc2libGVzIG1vZGVsb3Mgc2UgZGViZSB1c2FyIGVsIGFyZ3VtZW50byBgc3RlcHdpc2UgPSBGQUxTRWAuCiogU2kgc2UgZGVzZWEgcXVlIGVsIGPDoWxjdWxvIGRlIEFJQ2Mgc2VhIGV4YWN0byAocG9yIGRlZmVjdG8gcGFyYSBnYW5hciB0aWVtcG8gY2FsY3VsYSB1bmEgYXByb3hpbWFjacOzbiksIHNlIGRlYmUgdXNhciBlbCBhcmd1bWVudG8gYGFwcHJveGltYXRpb24gPSBGQUxTRWAuCiogU2kgc2UgZGVzZWEgdmVyIHBhcmEgdG9kb3MgbG9zIG1vZGVsb3MgYW5hbGl6YWRvcyBlbCB2YWxvciBkZSBBSUNjLCBzZSBkZWJlIGluY2x1aXIgZWwgYXJndW1lbnRvIGB0cmFjZSA9IFRSVUVgLgoKTGEgZnVuY2nDs24gYGF1dG8uYXJpbWFgIHRpZW5kZSBhIHNvYnJlLXBhcmFtZXRyaXphciBsb3MgbW9kZWxvcyB5IGVzIG11eSByZWNvbWVuZGFibGUgX2F5dWRhcmxhXyBpbmRpY2FuZG8gbGFzIGRpZmVyZW5jaWFjaW9uZXMsIGxvcyBwb3NpYmxlcyB2YWxvcmVzIGV4dHJlbW9zLi4uIAoKCmBgYHtyfQphdXRvLmFyaW1hKGxpYnJvcywgdHJhY2UgPSBUUlVFKQpgYGAKCk9ic2VydmEgY29tbyBsYSBpZGVudGlmaWNhY2nDs24gYXV0b23DoXRpY2EgZGEgY29tbyBtZWpvciBtb2RlbG8gdW4gQVJJTUEoMCwxLDApLCBxdWUgZXMgZWwgaGFiw61hbW9zIGlkZW50aWZpY2FkbywgeSBjb21vIHNlZ3VuZGEgb3BjacOzbiBlbCBtaXNtbyBtb2RlbG8sIHBlcm8gY29uIGRlcml2YS4KICAKXAoKIyMgQWZvcm8gZGUgdmVow61jdWxvcwoKVmFtb3MgYSBhcGxpY2FyIGRlIG51ZXZvIGxhIG1ldG9kb2xvZ8OtYSBkZSBCb3gtSmVua2lucyBhIGxhIHNlcmllIF9fYWZvcm8gZGUgdmVow61jdWxvc19fIHBvciBPcm9wZXNhLCBjYXJyZXRlcmEgTi0zNDAsIGttLiA5OTYsNDggKGZ1ZW50ZSBNaW5pc3RlcmlvIGRlIEZvbWVudG8pLiBMYSBzZXJpZSBlcyBhbnVhbCBkZSAxOTYwIGEgMjAxOCAoNTkgZGF0b3MpLgogICAgCmBgYHtyfQphZm9ybyA8LSByZWFkLmNzdjIoIi4vc2VyaWVzL2Fmb3JvX29yb3Blc2EuY3N2IiwgaGVhZGVyID0gVFJVRSkKYWZvcm8gPC0gdHMoYWZvcm8sIHN0YXJ0ID0gMTk2MCwgZnJlcSA9IDEpCgphdXRvcGxvdChhZm9ybywgCiAgICAgICAgIHhsYWIgPSAiIiwgCiAgICAgICAgIHlsYWIgPSAiVmVow61jdWxvcyAoMDAwKSIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDE4LiBBZm9ybyBkZSB2ZWjDrWN1bG9zIGVuIE4tMzQwLCBPcm9wZXNhIikKYGBgCgoKRW4gZXN0ZSBlamVtcGxvIGluY2x1aXJlbW9zLCBwb3IgcHJpbWVyYSB2ZXosIGludGVydmVuY2nDs24geSB2ZXJlbW9zIGNvbW8gX19sYSBwcmVzZW5jaWEgZGUgdmFsb3JlcyBhdMOtcGljb3MgcHVlZGUgZGlzdG9yc2lvbmFyIGVsIHByb2Nlc28gZGUgaWRlbnRpZmljYWNpw7NuX18uIFBvciBlbGxvLCBlcyBjb252ZW5pZW50ZSByZWFsaXphciBlbiBwYXJhbGVsbyBhbWJhcyBhY3RpdmlkYWRlcywgaWRlbnRpZmljYXIgZWwgcHJvY2VzbyB5IGRldGVjdGFyIHZhbG9yZXMgYXTDrXBpY29zLgogICAgICAKIyMjIFRyYW5zZm9ybWFjacOzbiBkZSBsYSBzZXJpZSB7LX0KCkxhIGZpZ3VyYSAxOCBtdWVzdHJhIHF1ZSBsYSBzZXJpZSBBZm9ybyBubyBlcyBlc3RhY2lvbmFyaWEuIEFzw60sIGVsIHByaW1lciBwYXNvIGVzIHRyYW5zZm9ybWFyIGxhIHNlcmllIG9yaWdpbmFsIHBhcmEgcXVlIGxvIHNlYS4gTGEgZmlndXJhIDE5IG5vIGRlamEgY2xhcm8gc2kgbGEgcHJpbWVyYSBkaWZlcmVuY2lhIGVzIHN1ZmljaWVudGUgcGFyYSBhbGNhbnphciBsYSBlc3RhY2lvbmFyaWVkYWQgKGdyw6FmaWNvcyBkZSBsYSBzZWd1bmRhIGNvbHVtbmEpIG8gc2kgZXMgbmVjZXNhcmlhIHVuYSBzZWd1bmRhIGRpZmVyZW5jaWFjacOzbiAoZ3LDoWZpY29zIGRlIGxhIHRlcmNlcmEgY29sdW1uYSkuIERpZmVyZW5jaWFyIG3DoXMgdmVjZXMgZGUgbGFzIG5lY2VzYXJpYXMgcHVlZGUgZGlmaWN1bHRhciBsYSBpZGVudGlmaWNhY2nDs24geSBsYSBpbnRlcnByZXRhY2nDs24uIEFkZW3DoXMsIGxhIGZ1bmNpw7NuIGBuZGlmZnNgIGFjb25zZWphIHVuYSBkaWZlcmVuY2lhY2nDs24uIEFzw60sIG9wdGFtb3MgcG9yIGZpamFyICRkID0gMSQuCgpgYGB7ciwgZXZhbCA9IEZBTFNFfQphdXRvcGxvdChhZm9ybywgCiAgICAgICAgIHhsYWIgPSAiQWZvcm8iLCB5bGFiID0gIiIsIG1haW4gPSAiIikKYXV0b3Bsb3QoZGlmZihhZm9ybyksIAogICAgICAgICB4bGFiID0gIlVuYSBkaWZlcmVuY2lhIGRlIEFmb3JvIiwgeWxhYiA9ICIiLCBtYWluID0gIiIpCmF1dG9wbG90KGRpZmYoYWZvcm8sIGRpZmZlcmVuY2VzID0gMiksIAogICAgICAgICB4bGFiID0gIkRvcyBkaWZlcmVuY2lhcyBkZSBBZm9ybyIsIHlsYWIgPSAiIiwgbWFpbiA9ICIiKQpnZ0FjZihhZm9ybywgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIikKZ2dBY2YoZGlmZihhZm9ybyksIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpCmdnQWNmKGRpZmYoYWZvcm8sIGRpZmZlcmVuY2VzID0gMiksIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpCmBgYAoKYGBge3IsIGVjaG8gPSBGQUxTRX0KZ3JpZC5hcnJhbmdlKAogIGF1dG9wbG90KGFmb3JvLCB4bGFiID0gIkFmb3JvIiwgeWxhYiA9ICIiLCBtYWluID0gIkZpZ3VyYSAxMi4gQWZvcm8gZGUgdmVow61jdWxvcyIpLAogIGF1dG9wbG90KGRpZmYoYWZvcm8pLCB4bGFiID0gIlVuYSBkaWZlcmVuY2lhIGRlIEFmb3JvIiwgeWxhYiA9ICIiLCBtYWluID0gIiIpLAogIGF1dG9wbG90KGRpZmYoYWZvcm8sIGRpZmZlcmVuY2VzID0gMiksIHhsYWIgPSAiRG9zIGRpZmVyZW5jaWFzIGRlIEFmb3JvIiwgeWxhYiA9ICIiLCBtYWluID0gIiIpLAogIGdnQWNmKGFmb3JvLCB4bGFiID0gIiIsIHlsYWIgPSAiRkFDIiwgbWFpbiA9ICIiKSwKICBnZ0FjZihkaWZmKGFmb3JvKSwgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIiksCiAgZ2dBY2YoZGlmZihhZm9ybywgZGlmZmVyZW5jZXMgPSAyKSwgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIiksCiAgbnJvdyA9IDIKKQpgYGAKCmBgYHtyfQpuZGlmZnMoYWZvcm8pCmBgYAoKCiMjIyBJZGVudGlmaWNhY2nDs24gey19CgpWZWFtb3MgYWhvcmEgYSBpZGVudGlmaWNhciBsb3MgdmFsb3JlcyBkZSAkcCQgeSAkcSQgYSBwYXJ0aXIgZGUgbGEgRkFDIHkgbGEgRkFDUC4gTGEgRkFDIHBvZGVtb3MgY29uc2lkZXJhciBxdWUgdGllbmUgdW5hIHNvbGEgYXV0b2NvcnJlbGFjacOzbiBzaWduaWZpY2F0aXZhIGVuIGVsIG9yZGVuIDEsIHkgbGEgRkFDUCBxdWUgcHJlc2VudGEgZGVjcmVjaW1pZW50by4gUG9kcsOtYSB0cmF0YXJzZSBkZSB1biBwcm9jZXNvIE1BKDEpLgoKYGBge3J9IApnZ3RzZGlzcGxheShkaWZmKGFmb3JvLCBkaWZmZXJlbmNlcyA9IDEpLCAKICAgICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMjAuIEFmb3JvICh1bmEgZGlmZXJlbmNpYSkiKQpgYGAKCsK/UXXDqSByZWNvbWllbmRhIGBhdXRvLmFyaW1hYD8gU3VnaWVyZSB1biBwcm9jZXNvIEFSSU1BKDIsMSwyKSwgY29uIHRvZG9zIGxvcyBjb2VmaWNpZW50ZXMgYXBhcmVudGVtZW50ZSBzaWduaWZpY2F0aXZvcy4KCmBgYHtyfSAKYXV0by5hcmltYShhZm9ybykKYGBgCgoKVmFtb3MgYSB2ZXIgbGEgZ3LDoWZpY2EgZGUgbG9zIHJlc2lkdW9zIGRlbCBtb2RlbG8gQVJJTUEoMiwxLDIpLCB2YW1vcyBhIGlkZW50aWZpY2FyIGxvcyB2YWxvcmVzIGV4dHJlbW9zIChpbnRlcnZlbmNpw7NuKSB5IHZhbW9zIGEgc29saWNpdGFyIHVuYSB2ZXogbcOhcyBsYSBhdXRvLWlkZW50aWZpY2FjacOzbiBwZXJvIGluY2x1eWVuZG8gbGFzIHZhcmlhYmxlcyBmaWN0aWNpYXMgYXNvY2lhZGFzIGEgY2FkYSB2YWxvciBleHRyZW1vLgoKCmBgYHtyfQphcmltYTIxMiA8LSBBcmltYShhZm9ybywgCiAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAxLCAyKSkKCmVycm9yIDwtIHJlc2lkdWFscyhhcmltYTIxMikKc2RlcnJvciA8LSBzZChlcnJvcikKCmF1dG9wbG90KGVycm9yLCBzZXJpZXM9IkVycm9yIiwKICAgICAgICAgY29sb3VyID0gImJsYWNrIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIkVycm9yIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMjEuIEVycm9yICsgSW50ZXJ2ZW5jacOzbiIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKC0zLCAtMiwgMiwgMykqc2RlcnJvciwgCiAgICAgICAgICAgICBjb2xvdXIgPSBjKCJyZWQiLCAiZ3JlZW4iLCAiZ3JlZW4iLCAicmVkIiksIAogICAgICAgICAgICAgbHR5ID0gMikgKyAKICBnZW9tX3BvaW50KCkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTYwLCAyMDE0LCA0KSkgCgojdGltZShlcnJvcilbYWJzKGVycm9yKSA+IDIuNSpzZGVycm9yXQpgYGAKClNlIGlkZW50aWZpY2FuIGRvcyBwb3NpYmxlcyB2YWxvcmVzIGV4dHJlbW9zIGVuIGxvcyBhw7FvcyAxOTc5IHkgMjAxMS4gQXPDrSwgY3JlYW1vcyB1bmEgdmFyaWFibGUgZmljdGljaWEgYXNvY2lhZGEgYSBjYWRhIGHDsW8sIHF1ZSBsYXMgZGVub21pbmFyZW1vcyBkMTk3OSB5IGQyMDExLCB5IGxhcyBpbmNsdWltb3MgZW4gbGEgYXV0by1pZGVudGlmaWNhY2nDs24uCgpgYGB7cn0KZDE5NzkgPC0gMSoodGltZShlcnJvcikgPT0gMTk3OSkKZDIwMTEgPC0gMSoodGltZShlcnJvcikgPT0gMjAxMSkKCmF1dG8uYXJpbWEoYWZvcm8sCiAgICAgICAgICAgeHJlZyA9IGNiaW5kKGQxOTc5LCAgZDIwMTEpKQpgYGAKCk9ic2VydmEgY29tbyBsYSBpbmNsdXNpw7NuIGRlIGludGVydmVuY2nDs24gbW9kaWZpY2EgbGEgYXV0by1pZGVudGlmaWNhY2nDs24sIHF1ZSBhaG9yYSBlcyB1biBwcm9jZXNvIEFSSU1BKDIsMSwwKS4KCiMjIyBFc3RpbWFjacOzbiB7LX0KCmBgYHtyfQphcmltYTIxMCA8LSBBcmltYShhZm9ybywgCiAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAxLCAwKSwgCiAgICAgICAgICAgICAgICAgIHhyZWcgPSBjYmluZChkMTk3OSwgIGQyMDExKSkKYXJpbWEyMTAKYGBgCgpTZSBwdWVkZSBjb21wcm9iYXIgcXVlIHRvZGFzIGxhcyB2YXJpYWJsZXMgc29uIHNpZ25pZmljYXRpdmFzLgoKYGBge3J9CmFuY2hvIDwtIG1heChuY2hhcihuYW1lcyhjb2VmKGFyaW1hMjEwKSkpKSArIDIKZm9yKGkgaW4gMTpsZW5ndGgoY29lZihhcmltYTIxMCkpKSB7CiAgd3QgPC0gd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMjEwKSwgCiAgICAgICAgICAgICAgICAgIFNpZ21hID0gdmNvdihhcmltYTIxMCksIAogICAgICAgICAgICAgICAgICBUZXJtcyA9IGkpCiAgY2F0KCJcbkNvZWZpY2llbnRlOiAiLCBmb3JtYXQobmFtZXMoY29lZihhcmltYTIxMCkpW2ldLCB3aWR0aCA9IGFuY2hvKSwgInZhbG9yIGRlIHA6ICIsIAogICAgICBmb3JtYXRDKHd0JHJlc3VsdCRjaGkyWzNdLCBkaWdpdHMgPSA0LCBmb3JtYXQgPSAiZiIpKQp9CmBgYAoKTGFzIGRvcyB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbiBzb24gc2lnbmlmaWNhdGl2YXMgeSBlbCBjb2VmaWNpZW50ZSAkXHBoaV8yJCAoYGFyMmApIHRhbWJpw6luLiBObyBlcyBzaWduaWZpY2F0aXZvIGVsIGNvZWZpY2llbnRlICRccGhpXzEkIChgYXIxYCksIHBlcm8gbm8gbG8gcG9kZW1vcyBlbGltaW5hci4gTG9zIG1vZGVsb3MgQXJpbWEgc29uIG1vZGVsb3MgamVyw6FycXVpY29zIGRvbmRlIGxhIHByZXNlbmNpYSBkZSB1biBjb2VmaWNpZW50ZSBzaWduaWZpY2F0aXZvIGRlIGNpZXJ0byBvcmRlbiBleGlnZSBxdWUgbG9zIGNvZWZpY2llbnRlIGRlIG9yZGVuIGluZmVyaW9yIGVzdMOpbiBwcmVzZW50ZXMsIHNlYW4gbyBubyBzaWduaWZpY2F0aXZvcy4gRW4gbnVlc3RybyBjYXNvLCBjb21vIGVsIGNvZWZpY2llbnRlICRccGhpXzIkIGVzIHNpZ25pZmljYXRpdm8sIHNlIGRlYmUgZGVqYXIgZW4gZWwgbW9kZWxvIGVsIGNvZWZpY2llbnRlICAkXHBoaV8xJC4KCiMjIyBWYWxpZGFjacOzbiB7LX0KClZlYW1vcyBxdWUgZWwgcmVzaWR1byB2ZXJpZmljYSB0b2RhcyBsYXMgaGlww7N0ZXNpcy4KCiMjIyMgSW50ZXJ2ZW5jacOzbiB7LX0KCkxhIGZpZ3VyYSAyMiBtdWVzdHJhIHF1ZSBwYXJhIG5pbmfDum4gYcOxbyBzZSBvYnNlcnZhIHVuIGVycm9yIGF0w61waWNvLiBTaSBzZSBpbmNsdXllIHVuYSBpbnRlcnZlbmNpw7NuIGFzb2NpYWRhIGFsIHJlc2lkdW8gbcOhcyBlbGV2YWRvIGVuIDE5ODQsIG5vIHJlc3VsdGEgc2lnbmlmaWNhdGl2YS4KCmBgYHtyfQplcnJvciA8LSByZXNpZHVhbHMoYXJpbWEyMTApCnNkZXJyb3IgPC0gc2QoZXJyb3IpCgphdXRvcGxvdChlcnJvciwgc2VyaWVzPSJFcnJvciIsCiAgICAgICAgIGNvbG91ciA9ICJibGFjayIsCiAgICAgICAgIHhsYWIgPSAiIiwKICAgICAgICAgeWxhYiA9ICJFcnJvciIsCiAgICAgICAgIG1haW4gPSAiRmlndXJhIDIyLiBFcnJvciArIEludGVydmVuY2nDs24iKSArCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gYygtMywgLTIsIDIsIDMpKnNkZXJyb3IsIAogICAgICAgICAgICAgY29sb3VyID0gYygicmVkIiwgImdyZWVuIiwgImdyZWVuIiwgInJlZCIpLCAKICAgICAgICAgICAgIGx0eSA9IDIpICsgCiAgZ2VvbV9wb2ludCgpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk2MCwgMjAxNCwgNCkpIApgYGAKClwKCiMjIyMgTWVkaWRhcyBkZSBlcnJvciB7LX0KCkVsIGVycm9yIG1lZGlvIGVzIGByIHJvdW5kKGFjY3VyYWN5KGFyaW1hMjEwKVsyXSwwKWAgbWlsZXMgZGUgdmVow61jdWxvcyAoUk1TRSkgeSBlbCBlcnJvciBwb3JjZW50dWFsIG1lZGlvIChNQVBFKSBlcyBgciByb3VuZChhY2N1cmFjeShhcmltYTIxMClbNV0sMilgJS4KCmBgYHtyLCBldmFsPUZBTFNFfQphY2N1cmFjeShhcmltYTIxMCkKYGBgCgpgYGB7cixlY2hvPUZBTFNFfQpyb3VuZChhY2N1cmFjeShhcmltYTIxMCksMikKYGBgCgpcCgojIyMjIEluY29ycmVsYWNpw7NuLCBIb21vY2VkYXN0aWNpZGFkIHkgTm9ybWFsaWRhZCB7LX0gCgpWZWFtb3MgYWhvcmEgc2kgZWwgcmVzaWR1byBlcyBydWlkbyBibGFuY286CgpgYGB7cn0KQm94LnRlc3QoZXJyb3IsIGxhZyA9IDIsIHR5cGUgPSAiTGp1bmctQm94IikKQm94LnRlc3QoZXJyb3JeMiwgbGFnID0gMiwgdHlwZSA9ICJManVuZy1Cb3giKSAKamFycXVlLmJlcmEudGVzdChlcnJvcikKYGBgCgpMYXMgaGlww7N0ZXNpcyBkZSBpbmNvcnJlbGFjacOzbiB5IGhvbW9jZWRhc3RpY2lkYWQgc2UgYWNlcHRhbi4gVGFtYmnDqW4gc2UgYWNlcHRhcsOtYW4gcGFyYSBvdHJvcyB2YWxvcmVzIGRlICRrJCByYXpvbmFibGVzLiBJZ3VhbG1lbnRlLCBzZSBhY2VwdGEgbGEgaGlww7N0ZXNpcyBkZSBub3JtYWxpZGFkLiAKClwKCkNvbmZpcm1hbW9zIHF1ZSAkYWZvcm9fdCBcc2ltIEFSSU1BKDIsMSwwKSQgY29uIGludGVydmVuY2nDs24uCgojIyMgSW50ZXJwcmV0YWNpw7NuIGRlbCBtb2RlbG8gey19CgpFbCBfX21vZGVsbyB0ZcOzcmljb19fIGVzICRhZm9yb190IFxzaW0gQVJJTUEoMiwxLDApICsgZDE5NzkgKyBkMjAxMSQ6CiQkKDEgLSBccGhpXzEgTCAtIFxwaGlfMiBMXjIpKDEgLSBMKWFmb3JvX3QgPSAgXHZhcmVwc2lsb25fdCArIFxnYW1tYV8xIFxjZG90IGQxOTc5ICsgXGdhbW1hXzIgXGNkb3QgZDIwMTEuJCQKClNpIGRlc2Fycm9sbGFtb3MsIHF1ZWRhOgokJGFmb3JvX3QgPSBhZm9yb197dC0xfSArIFxwaGlfMShhZm9yb197dC0xfS1hZm9yb197dC0yfSkgKyBccGhpXzIoYWZvcm9fe3QtMn0tYWZvcm9fe3QtM30pICsgXGdhbW1hXzEgXGNkb3QgZDE5NzkgKyAgXGdhbW1hXzIgXGNkb3QgZDIwMTEgKyBcdmFyZXBzaWxvbl90LiQkCgpGaW5hbG1lbnRlLCBlbCBfX21vZGVsbyBlc3RpbWFkb19fIGVzOgokJFx3aWRlaGF0e2Fmb3JvfV90ID0gYWZvcm9fe3QtMX0gKyAwLjE5KGFmb3JvX3t0LTF9LWFmb3JvX3t0LTJ9KSArIDAuNDQoYWZvcm9fe3QtMn0tYWZvcm9fe3QtM30pIC0xNzE4IFxjZG90IGQxOTc5IC0xMTk1IFxjZG90IGQyMDExJCQKQ2FkYSBhw7FvIGVsIGFmb3JvIGVzIGVsIG1pc21vIHF1ZSBlbCBhZm9ybyBkZWwgYcOxbyBwYXNhZG8gbcOhcyB1biAxOSUgZGVsIMO6bHRpbW8gaW5jcmVtZW50byBvYnNlcnZhZG8geSB1biA0NCUgZGVsIGluY3JlbWVudG8gYW50ZXJpb3IuCiAgICAKUmVzcGVjdG8gZGUgbGEgaW50ZXJ2ZW5jacOzbiwgZW4gMTk3OSBodWJvIHVuIDEuNyBtaWxsb25lcyBtZW5vcyBkZSB2ZWjDrWN1bG9zIGRlIGxvIGVzcGVyYWRvIHkgZW4gMjAxMSAxLjIgbWlsbG9uZXMgbWVub3MuCiAgICAgIAoKIyMjIFByZWRpY2Npw7NuIHstfQoKQ29tbyBoZW1vcyBpbmNsdWlkbyBkb3MgdmFyaWFibGVzIGZpY3RpY2lhcyBlbiBlbCBhanVzdGUsIGRlIGNhcmEgYSBwcmVkZWNpciBlbCBhZm9ybyBoZW1vcyBkZSBpbmRpY2FyIGN1YWxlcyBzZXLDoW4gbG9zIHZhbG9yZXMgZnV0dXJvcyBwYXJhIGVzdGFzIHZhcmlhYmxlcy4gRW4gZXN0ZSBjYXNvIHNlcsOhbiBjZXJvcyBwdWVzdG8gcXVlIHNvbiBpbnRlcnZlbmNpb25lcyBxdWUgbm8gcmVzcG9uZGVuIGEgZWZlY3RvcyBjYWxlbmRhcmlvLgogIApFbiBgUmAgZXN0byBzZSBoYWNlIGluY2x1eWVuZG8gZW4gZWwgY29tYW5kbyBgZm9yZWNhc3RgIGVsIGFyZ3VtZW50byBgeHJlZyA9IGNiaW5kKHJlcCgwLCA1KSwgcmVwKDAsIDUpKWAgcXVlIGHDsWFkZSBjaW5jbyBjZXJvcyBwb3IgY2FkYSB2YXJpYWJsZSBkZSBpbnRlcnZlbmNpw7NuIHBvcnF1ZSBsYSBwcmVkaWNjacOzbiB2YSBhIHNlciBhIGNpbmNvIGHDsW9zIHZpc3RhLgoKYGBge3J9CnBhcmltYTIxMCA8LSBmb3JlY2FzdChhcmltYTIxMCwgCiAgICAgICAgICAgICAgICAgICAgICBoID0gNSwgCiAgICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IDk1LAogICAgICAgICAgICAgICAgICAgICAgeHJlZyA9IGNiaW5kKGQxOTc5PXJlcCgwLCA1KSwgZDE5ODE9cmVwKDAsIDUpKSkKcGFyaW1hMjEwCmBgYAoKYGBge3J9CmF1dG9wbG90KHBhcmltYTIxMCwgCiAgICAgeWxhYiA9ICdWZWjDrWN1bG9zICgwMDApJywKICAgICBtYWluID0gJ0ZpZ3VyYSAyMy4gQWZvcm8gKDE5NjAtMjAxOCkgeSBwcmVkaWNjacOzbiAoMjAxOS0yMDIzKScpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk2MCwgMjAyMywgNCkpIApgYGAKClwKCiMjIyBWYWxpZGFjacOzbiBjb24gb3JpZ2VuIGRlIHByZWRpY2Npw7NuIG3Ds3ZpbCB7LX0KClZhbW9zIGEgY2FsY3VsYXIgZWwgZXJyb3IgZXh0cmEtbXVlc3RyYWwgc2Vnw7puIGVsIGhvcml6b250ZSB0ZW1wb3JhbCBkZSBwcmV2aXNpw7NuLiBFbiBlc3RlIGNhc28sIGxhIHByZXNlbmNpYSBkZSB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbiB5IGxhIHBvc2liaWxpZGFkIGRlIHF1ZSBsYSBmdW5jacOzbiBgQXJpbWFgIGZhbGxlIGEgbGEgaG9yYSBkZSBlc3RpbWFyIGxvcyBwYXLDoW1ldHJvcyBoYWNlIGVsIGPDs2RpZ28gYWxnbyBtw6FzIGNvbXBsZWpvLiAKCkFzdW1pcmVtb3MgcXVlIHNlIHByZWNpc2FuIDMwIGHDsW9zIHBhcmEgZXN0aW1hciBlbCBtb2RlbG8sIGZpamFyZW1vcyBlbCBob3Jpem9udGUgdGVtcG9yYWwgZW4gNSBhw7FvcyB5IGNhbGN1bGFyZW1vcyBlbCBlcnJvciBNQVBFLCBxdWUgcGFyYSBsYSBwcmVkaWNjacOzbiBpbnRyYS1tdWVzdHJhbCBlcmEgZGUgNS43JS4KCgpgYGB7cn0KayA8LSAzMCAgICAgICAgICAgICAgICAgIApoIDwtIDUgICAgICAgICAgICAgICAgICAgIApUIDwtIGxlbmd0aChhZm9ybykgICAgIApzIDwtIFQgLSBrIC0gaCAgICAKCm1hcGVBcmltYSA8LSBtYXRyaXgoTkEsIHMgKyAxLCBoKQoKWCA8LSBkYXRhLmZyYW1lKGNiaW5kKGQxOTc5LCBkMjAxMSkpCgpmb3IgKGkgaW4gMDpzKSB7CiAgdHJhaW4uc2V0IDwtIHN1YnNldChhZm9ybywgc3RhcnQgPSBpICsgMSwgZW5kID0gaSArIGspCiAgdGVzdC5zZXQgPC0gIHN1YnNldChhZm9ybywgc3RhcnQgPSBpICsgayArIDEsIGVuZCA9IGkgKyBrICsgaCkgCiAgCiAgWC50cmFpbiA8LSBkYXRhLmZyYW1lKFhbKGkgKyAxKTooaSArIGspLF0pCiAgaGF5IDwtIGNvbFN1bXMoWC50cmFpbikKICBYLnRyYWluIDwtIFgudHJhaW5bLCBoYXk+MF0KICAKICBYLnRlc3QgPC0gZGF0YS5mcmFtZShYWyhpICsgayArIDEpOihpICsgayArIGgpLF0pCiAgWC50ZXN0IDwtIFgudGVzdFssIGhheT4wXQogIAogIGlmIChsZW5ndGgoWC50cmFpbikgPiAwKSB7CiAgICBmaXQgPC0gdHJ5KEFyaW1hKHRyYWluLnNldCwgCiAgICAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAxLCAwKSwKICAgICAgICAgICAgICAgICAgICAgeHJlZz1hcy5tYXRyaXgoWC50cmFpbikpKQogIH0gZWxzZSB7CiAgICBmaXQgPC0gdHJ5KEFyaW1hKHRyYWluLnNldCwgCiAgICAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygyLCAxLCAwKSkpCiAgfQogIAogIGlmICghaXMuZWxlbWVudCgidHJ5LWVycm9yIiwgY2xhc3MoZml0KSkpIHsKICAgIGlmIChsZW5ndGgoWC50cmFpbikgPiAwKSAKICAgICAgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCwgeHJlZyA9IGFzLm1hdHJpeChYLnRlc3QpKSBlbHNlCiAgICAgICAgZmNhc3QgPC0gZm9yZWNhc3QoZml0LCBoID0gaCkKICAgICAgbWFwZUFyaW1hW2kgKyAxLF0gPC0gMTAwKmFicyh0ZXN0LnNldCAtIGZjYXN0JG1lYW4pL3Rlc3Quc2V0CiAgfQp9CgptYXBlQXJpbWEgPC0gY29sTWVhbnMobWFwZUFyaW1hLCBuYS5ybSA9IFRSVUUpCm1hcGVBcmltYQpgYGAKCkVsIGVycm9yIGRlIHByZXZpc2nDs24gZXh0cmEtbXVlc3RyYWwgY3JlY2Ugbm90YWJsZW1lbnRlIGNvbiBlbCBob3Jpem9udGUgdGVtcG9yYWwuIEVsIGVycm9yIGRlIGxhcyBwcmV2aXNpb25lcyBhIHVuIGHDsW8gdmlzdGEgZXMgZGVsIDUuOCUsIHByw6FjdGljYW1lbnRlIGlndWFsIGFsIGVycm9yIGludHJhLW11ZXN0cmFsLCBwZXJvIHBhcmEgZG9zIGHDsW9zIHZpc3RhIGNhc2kgYWxjYW56YSBlbCAxMCUgeSBhIGNpbmNvIGHDsW9zIHZpc3RhIHN1cGVyYSBlbCAyMCUuCgpcCgojIyBDb25zdW1vIGRlIGFsaW1lbnRvcyBlbiBlbCBob2dhciBwZXIgY8OhcGl0YQoKQW5hbGl6YXJlbW9zIGVsIF9fY29uc3VtbyBhbGltZW50YXJpbyBlbiBob2dhciBwZXIgY8OhcGl0YV9fIGVuIEVzcGHDsWEuIEVzdGEgc2VyaWUgZXN0w6EgY29uc3RydWlkYSBhIHBhcnRpciBkZSBsYSBzZXJpZSBkZSBjb25zdW1vIGFsaW1lbnRhcmlvIGVuIGhvZ2FyIChkaXNwb25pYmxlIGVuIGVsIE1pbmlzdGVyaW8gZGUgQWdyaWN1bHR1cmEsIEFsaW1lbnRhY2nDs24geSBNZWRpbyBBbWJpZW50ZSksIHkgbGEgc2VyaWUgZGUgcG9ibGFjacOzbiAoZGlzcG9uaWJsZSBlbiBlbCBJbnN0aXR1dG8gTmFjaW9uYWwgZGUgRXN0YWTDrXN0aWNhKS4gRXMgdW5hIHNlcmllIGFudWFsIGRlIDE5ODcgYSAyMDE4ICgzMiBkYXRvcykgeSBsYSB1bmlkYWQgZXMgZWwgS2cgcGVyIGPDoXBpdGEuIExhIGZpZ3VyYSAyNCBtdWVzdHJhIHF1ZSBlcyB1bmEgc2VyaWUgZXN0YWNpb25hcmlhLgoKYGBge3J9CmFsaW1lbnRvc3BjIDwtIHJlYWQuY3N2MigiLi9zZXJpZXMvYWxpbWVudGFjaW9ucGMuY3N2IiwgaGVhZGVyID0gVFJVRSkKYWxpbWVudG9zcGMgPC0gdHMoYWxpbWVudG9zcGMsIHN0YXJ0ID0gMTk4NywgZnJlcSA9IDEpCiAgICAKYXV0b3Bsb3QoYWxpbWVudG9zcGMsIAogICAgICAgICB4bGFiID0gIiIsIAogICAgICAgICB5bGFiID0gIktnIHBlciBjw6FwaXRhIiwKICAgICAgICAgeWxpbSA9IGMoMCwgNzAwKSwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMjQuIENvbnN1bW8gYWxpbWVudGFyaW8gZW4gaG9nYXIiKQpgYGAKCiMjIyBUcmFuc2Zvcm1hY2nDs24gZGUgbGEgc2VyaWUgey19CgpMYSBmaWd1cmEgMjUgaW5kaWNhIHF1ZSBsYSBzZXJpZSBvcmlnaW5hbCB5YSBlcyBlc3RhY2lvbmFyaWEuIEVsIGNvbnRyYXN0ZSBLUFNTIGFzw60gbG8gY29uZmlybWEsIHBvciB0YW50byBhc3VtaW1vcyBxdWUgJGQ9MCQgbyAkYWxpbWVudG9zcGNfdCBcc2ltIEkoMCkkLgoKYGBge3IsIGV2YWwgPSBGQUxTRX0KYXV0b3Bsb3QoYWxpbWVudG9zcGMsIHhsYWIgPSAiIiwgeWxhYiA9ICIiLCBtYWluID0gIkFsaW1lbnRvcyIpCmF1dG9wbG90KGRpZmYoYWxpbWVudG9zcGMpLCB4bGFiID0gIiIsIHlsYWIgPSAiIiwgbWFpbiA9ICJEaWZlcmVuY2lhIGFsaW1lbnRvcyIpCmdnQWNmKGFsaW1lbnRvc3BjLCB4bGFiID0gIiIsIHlsYWIgPSAiRkFDIiwgbWFpbiA9ICIiKQpnZ0FjZihkaWZmKGFsaW1lbnRvc3BjKSwgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIikKYGBgCgpgYGB7ciwgZWNobyA9IEZBTFNFfQpncmlkLmFycmFuZ2UoCiAgYXV0b3Bsb3QoYWxpbWVudG9zcGMsIHhsYWIgPSAiQWxpbWVudG9zIiwgeWxhYiA9ICIiLCBtYWluID0gIkZpZ3VyYSAyNS4gQ29uc3VtbyBkZSBhbGltZW50b3MiKSwKICBhdXRvcGxvdChkaWZmKGFsaW1lbnRvc3BjKSwgeGxhYiA9ICJEaWZlcmVuY2lhIGRlIGFsaW1lbnRvcyIsIHlsYWIgPSAiIiwgbWFpbiA9ICIiKSwKICBnZ0FjZihhbGltZW50b3NwYywgeGxhYiA9ICIiLCB5bGFiID0gIkZBQyIsIG1haW4gPSAiIiksCiAgZ2dBY2YoZGlmZihhbGltZW50b3NwYyksIHhsYWIgPSAiIiwgeWxhYiA9ICJGQUMiLCBtYWluID0gIiIpLAogIG5yb3cgPSAyCikKYGBgCgpgYGB7cn0KbmRpZmZzKGFsaW1lbnRvc3BjKQpgYGAKCiMjIyBJZGVudGlmaWNhY2nDs24gey19CgpQYXJhIGlkZW50aWZpY2FyIGxvcyB2YWxvcmVzIGRlICRwJCB5ICRxJCBhbmFsaXphcmVtb3MgbGEgRkFDIHkgbGEgRkFDUCB5IHZlcmVtb3MgcXVlIG5vcyBzdWdpZXJlIGBhdXRvLmFyaW1hYCA6CgpgYGB7cn0gCmdndHNkaXNwbGF5KGFsaW1lbnRvc3BjLCBtYWluID0gIkZpZ3VyYSAyNi4gQ29uc3VtbyBkZSBhbGltZW50b3MgcGVyIGPDoXBpdGEiKQpgYGAKCgpgYGB7cn0gCmF1dG8uYXJpbWEoYWxpbWVudG9zcGMpCmBgYAoKRXMgZGlmw61jaWwgcmVhbGl6YXIgdW5hIGlkZW50aWZpY2FjacOzbiBhIHBhcnRpciBkZWwgYW7DoWxpc2lzIGRlIGxhIEZBQyB5IEZBQ1AuIExhIGlkZW50aWZpY2FjacOzbiBhdXRvbcOhdGljYSBzdWdpZXJlIHVuIHByb2Nlc28gQVIoMSkgY29uIGNvbnN0YW50ZSB5IGFtYm9zIGNvZWZpY2llbnRlcyBwYXJlY2VuIHNpZ25pZmljYXRpdm9zIC0tc3UgdmFsb3Igc3VwZXJhIGRvcyB2ZWNlcyBzdSBlcnJvciBlc3TDoW5kYXIuCgpWYW1vcyBhIHZlciBsYSBncsOhZmljYSBkZSBsb3MgcmVzaWR1b3MgZGUgZXN0ZSBwcm9jZXNvIHBhcmEgaWRlbnRpZmljYXIgcsOhcGlkYW1lbnRlIHNpIGhheSB2YWxvcmVzIGV4dHJlbW9zIChmaWd1cmEgMjcpLgoKYGBge3J9CmFyaW1hMTAwIDwtIEFyaW1hKGFsaW1lbnRvc3BjLCAKICAgICAgICAgICAgICAgICAgaW5jbHVkZS5jb25zdGFudCA9IFRSVUUsCiAgICAgICAgICAgICAgICAgIG9yZGVyID0gYygxLCAwLCAwKSkKCmVycm9yIDwtIHJlc2lkdWFscyhhcmltYTEwMCkKc2RlcnJvciA8LSBzZChlcnJvcikKCmF1dG9wbG90KGVycm9yLCBzZXJpZXM9IkVycm9yIiwKICAgICAgICAgY29sb3VyID0gImJsYWNrIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIkVycm9yIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMjcuIEVycm9yICsgSW50ZXJ2ZW5jacOzbiIpICsKICBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBjKC0zLCAtMiwgMiwgMykqc2RlcnJvciwgCiAgICAgICAgICAgICBjb2xvdXIgPSBjKCJyZWQiLCAiZ3JlZW4iLCAiZ3JlZW4iLCAicmVkIiksIAogICAgICAgICAgICAgbHR5ID0gMikgKyAKICBnZW9tX3BvaW50KCkgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTg3LCAyMDE4LCAzKSkgCmBgYAoKSGF5IGRvcyBwb3NpYmxlcyB2YWxvcmVzIGV4dHJlbW9zIGVuIGxvcyBhw7FvcyAxOTk1IHkgMjAwOS4gQWRlbcOhcywgdHJhcyBpbmNsdWlybGFzIHkgZXN0aW1hciBlbCBudWV2byBtb2RlbG8gYXBhcmVjZSBvdHJhIHZhcmlhYmxlIGRlIGludGVydmVuY2nDs24gcGFyYSAxOTkzLiBBdW5xdWUgbmluZ3VuYSBzdXBlcmEgbGFzIDIuNSBkZXN2aWFjaW9uZXMgdMOtcGljYXMsIHN1IGVmZWN0byBlcyBzaWduaWZpY2F0aXZvLgoKYGBge3J9CmQxOTkzIDwtIDEqICh0aW1lKGFsaW1lbnRvc3BjKSA9PSAxOTkzKQpkMTk5NSA8LSAxKiAodGltZShhbGltZW50b3NwYykgPT0gMTk5NSkKZDIwMDkgPC0gMSogKHRpbWUoYWxpbWVudG9zcGMpID09IDIwMDkpCgphcmltYTEwMCA8LSBBcmltYShhbGltZW50b3NwYywgCiAgICAgICAgICAgICAgICAgIGluY2x1ZGUuY29uc3RhbnQgPSBUUlVFLAogICAgICAgICAgICAgICAgICBvcmRlciA9IGMoMSwgMCwgMCksCiAgICAgICAgICAgICAgICAgIHhyZWcgPSBjYmluZChkMTk5MywgZDE5OTUsIGQyMDA5KSkKYXJpbWExMDAKYGBgCgojIyMgVmFsaWRhY2nDs24gey19CgojIyMjIENvZWZpY2llbnRlcyBzaWduaWZpY2F0aXZvcyB7LX0KClRhbnRvICRccGhpXzEkIGNvbW8gZWwgaW50ZXJjZXB0byAkXG11JCB5IGxhcyB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbiBzb24gc2lnbmlmaWNhdGl2YXMuCgpgYGB7cn0KYW5jaG8gPC0gbWF4KG5jaGFyKG5hbWVzKGNvZWYoYXJpbWExMDApKSkpICsgMgpmb3IoaSBpbiAxOmxlbmd0aChjb2VmKGFyaW1hMTAwKSkpIHsKICB3dCA8LSB3YWxkLnRlc3QoYiA9IGNvZWYoYXJpbWExMDApLCAKICAgICAgICAgICAgICAgICAgU2lnbWEgPSB2Y292KGFyaW1hMTAwKSwgCiAgICAgICAgICAgICAgICAgIFRlcm1zID0gaSkKICBjYXQoIlxuQ29lZmljaWVudGU6ICIsIGZvcm1hdChuYW1lcyhjb2VmKGFyaW1hMTAwKSlbaV0sIHdpZHRoID0gYW5jaG8pLCAidmFsb3IgZGUgcDogIiwgCiAgICAgIGZvcm1hdEMod3QkcmVzdWx0JGNoaTJbM10sIGRpZ2l0cyA9IDQsIGZvcm1hdCA9ICJmIikpCn0KYGBgCgpcCgojIyMjIE1lZGlkYXMgZGUgZXJyb3Igey19CgpFbCBlcnJvciBtZWRpbyBlcyAkUk1TRT0kIGByIHJvdW5kKGFjY3VyYWN5KGFyaW1hMTAwKVsyXSwwKWAga2lsb3MgcGVyIGPDoXBpdGEgeSBlbCBlcnJvciBwb3JjZW50dWFsIG1lZGlvIGVzICRNQVBFPSQgYHIgcm91bmQoYWNjdXJhY3koYXJpbWExMDApWzVdLDEpYCUuCgpgYGB7ciwgZXZhbD1GQUxTRX0KYWNjdXJhY3koYXJpbWExMDApCmBgYAoKYGBge3IsZWNobz1GQUxTRX0Kcm91bmQoYWNjdXJhY3koYXJpbWExMDApLDIpCmBgYAoKXAoKIyMjIyBJbmNvcnJlbGFjacOzbiwgSG9tb2NlZGFzdGljaWRhZCB5IE5vcm1hbGlkYWQgey19CgpWZWFtb3MgYWhvcmEgc2kgZWwgcmVzaWR1byBlcyBydWlkbyBibGFuY286CgpgYGB7cn0KZXJyb3IgPC0gcmVzaWR1YWxzKGFyaW1hMTAwKQpCb3gudGVzdChlcnJvciwgbGFnID0gMiwgdHlwZSA9ICJManVuZy1Cb3giKQpCb3gudGVzdChlcnJvcl4yLCBsYWcgPSAyLCB0eXBlID0gIkxqdW5nLUJveCIpIApqYXJxdWUuYmVyYS50ZXN0KGVycm9yKQpgYGAKCgpMYXMgaGlww7N0ZXNpcyBkZSBpbmNvcnJlbGFjacOzbiB5IGhvbW9jZWRhc3RpY2lkYWQgc2UgYWNlcHRhbi4gVGFtYmnDqW4gc2UgYWNlcHRhcsOtYW4gcGFyYSBvdHJvcyB2YWxvcmVzIGRlICRrJCByYXpvbmFibGVzLiAKCkxhIGhpcMOzdGVzaXMgZGUgbm9ybWFsaWRhZCB0YW1iacOpbiBlcyBhY2VwdGEgYWwgNSUuCgojIyMgSW50ZXJwcmV0YWNpw7NuIGRlbCBtb2RlbG8gey19CgpFbCBfX21vZGVsbyB0ZcOzcmljb19fIGlkZW50aWZpY2FkbyBlczoKJCQoMSAtIFxwaGlfMSBMKSBhbGltZW50b3NwY190ID0gYyArIFxnYW1tYV8xIGQxOTkzICsgXGdhbW1hXzIgZDE5OTUgKyBcZ2FtbWFfMyBkMjAwOSArIFx2YXJlcHNpbG9uX3QsJCQKcXVlIGRlc2Fycm9sbGFuZG8gcXVlZGE6CiQkYWxpbWVudG9zcGNfdCA9IGMgKyBccGhpXzEgYWxpbWVudG9zcGNfe3QtMX0gKyBcZ2FtbWFfMSBkMTk5MyArIFxnYW1tYV8yIGQxOTk1ICsgXGdhbW1hXzMgZDIwMDkgKyBcdmFyZXBzaWxvbl90LiQkCgpGaW5hbG1lbnRlLCBlbCBfX21vZGVsbyBlc3RpbWFkb19fIGVzOgokJFx3aWRlaGF0e2FsaW1lbnRvc3BjfV90ID0gMTI5LjUgKyAwLjgwIFxjZG90IGFsaW1lbnRvc3BjX3t0LTF9ICsgMjEuOTRcY2RvdCBkMTk5MyAtIDE1Ljg3XGNkb3QgZDE5OTUgKzIxLjM4XGNkb3QgZDIwMDkkJAoKX19PYnNlcnZhY2nDs25fXzogRWwgdMOpcm1pbm8gY29udGFudGUgJFxtdSQgcXVlIGVzdGltYSBSIG5vIGVsIHZhbG9yICJjIiBxdWUgaGVtb3MgdmlzdG8gZW4gbGEgdGVvcsOtYS4gUGFyYSBjb252ZXJ0aXIgbGEgY29udGFudGUgZXN0aW1hZGEgcG9yIFIgZW4gImMiIGhlbW9zIGRlIG11bHRpcGxpY2FybGEgcG9yIGVsIHBvbGlub21pbyBhdXRvcnJlZ3Jlc2l2by4gRW4gZXN0ZSBjYXNvLAokJGMgPSAoMSAtIFxwaGlfMSlcY2RvdFxtdSA9ICgxIC0gMC43OTc0KVxjZG90NjM5LjE5MjQgPSAxMjkuNSQkCgpDYWRhIGHDsW8gZWwgY29uc3VtbyBkZSBhbGltZW50b3MgcGVyIGPDoXBpdGEgZW4gZWwgaG9nYXIgZXMgMTI5LjUga2lsb3MgbcOhcyB1biA4MCUgZGVsIGNvbnN1bW8gZGVsIGHDsW8gcGFzYWRvLgoKRW4gMTk5MyB5IDIwMDkgZWwgY29uc3VtbyBtZWRpbyBkZSBhbGltZW50b3MgcGVyIGPDoXBpdGEgZnVlIGVudHJlIDIxIHkgMjIga2cuIHN1cGVyaW9yIGEgbG9zIGVzcGVyYWRvLCBtaWVudHJhcyBxdWUgZWwgMTk5NSBmdWUgMTYga2cuIG1lbm9yIGRlIGxvIGVzcGVyYWRvLgoKIyMjIFByZWRpY2Npb25lcyBkZSBsYSBzZXJpZSB7LX0KCmBgYHtyfQpwYXJpbWExMDAgPC0gZm9yZWNhc3QoYXJpbWExMDAsIAogICAgICAgICAgICAgICAgICAgICAgaCA9IDUsIAogICAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSA5NSwKICAgICAgICAgICAgICAgICAgICAgIHhyZWcgPSBjYmluZChyZXAoMCwgNSksIHJlcCgwLCA1KSwgcmVwKDAsIDUpKSkKCnBhcmltYTEwMApgYGAKClB1ZWRlcyBjb21wcm9iYXIgcXVlIGNhZGEgdmFsb3IgZGUgbGEgcHJlZGljY2nDs24gc2UgaGEgb2J0ZW5pZG8gYSBwYXJ0aXIgZGVsIG1vZGVsbyBlc3RpbWFkbywgZG9uZGUgJGFsaW1lbnRvc3BjX3t0LTF9JCBzZSBzdXN0aXR1eWUgcG9yIGxhIHByZWRpY2Npw7NuIGRlbCBhw7FvIHByZWNlZGVudGUuCgpgYGB7cn0KYXV0b3Bsb3QocGFyaW1hMTAwLCAKICAgICB5bGFiID0gIktpbG9zIHBlciBjw6FwaXRhIiwKICAgICBtYWluID0gIkZpZ3VyYSAyOC4gQ29uc3VtbyBkZSBhbGltZW50b3MgeSBwcmVkaWNjacOzbiIpICsKICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzPSBzZXEoMTk4NywgMjAyMywgNCkpIApgYGAKClwKCiMjIENvbXBhcmFjacOzbiBjb24gYWxpc2FkbyBleHBvbmVuY2lhbAoKVmVhbW9zIHVuYSBjb21wYXJhdGl2YSwgcGFyYSBsb3MgdHJlcyBlamVtcGxvcyB2aXN0b3MsIGVudHJlIGxvcyByZXN1bHRhZG9zIG9idGVuaWRvcyBjb24gQVJJTUEgeSBjb24gQWxpc2FkbyBleHBvbmVuY2lhbC4KICAKKiBMaWJyb3M6CiAgICArIE1BUEUgQVJJTUE6ICQ3LjAyXCUkIC0gQVJJTUEoMCwxLDApIHNpbiBkZXJpdmEKICAgIAogICAgKyBNQVBFIEVUUzogICAkNy4wNVwlJCAtIEVUUyhNLE4sTiksICRcYWxwaGE9MSQKICAgIAogICAgKyBBbWJvcyBtw6l0b2RvcyBoYW4gZXN0aW1hZG8gZWwgbWlzbW8gbW9kZWxvLgoKXHZzcGFjZXsuNWNtfQoKKiBBZm9ybzoKICAgICsgTUFQRSBBUklNQTogJDUuNzJcJSQgLSBBUklNQSgyLDEsMCkgc2luIGRlcml2YSwgY29uIGludGVydmVuY2nDs24KICAgIAogICAgKyBNQVBFIEVUUzogICAkNi4xOFwlJCAtIEVUUyhNLEEsTiksICRcYWxwaGE9MSQsICRcYmV0YT0wLjEwJAogICAgCiAgICArIENhZGEgbcOpdG9kbyBlc3RpbWEgdW4gbW9kZWxvIGRpZmVyZW50ZQogICAgCiAgICArIEFSSU1BIHRpZW5lIG1lbm9yIGVycm9yIGEgY29zdGEgZGUgaW5jbHVpciB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbgoKXHZzcGFjZXsuNWNtfQoKKiBBbGltZW50b3MgcGVyIGPDoXBpdGE6CiAgICArIE1BUEUgQVJJTUE6ICQxLjE5XCUkIC0gQVJJTUEoMSwwLDApIGNvbiBjb25zdGFudGUgZSBpbnRlcnZlbmNpw7NuCiAgICAKICAgICsgTUFQRSBFVFM6ICAgJDEuNDNcJSQgLSBFVFMoTSxOLE4pLCAkXGFscGhhID0gMC45OCQKICAgIAogICAgKyBDYWRhIG3DqXRvZG8gaGEgZXN0aW1hZG8gdW4gbW9kZWxvIGRpZmVyZW50ZQogICAgCiAgICArIEFSSU1BIHRpZW5lIG1lbm9yIGVycm9yIGEgY29zdGEgZGUgaW5jbHVpciB2YXJpYWJsZXMgZGUgaW50ZXJ2ZW5jacOzbgogICAgClwKXAoKIyBSZXN1bWVuIGRlIGxvcyBjb21hbmRvcyB1dGlsaXphZG9zCgoKfEZ1bmNpw7NuICAgICAgICB8UGFxdWV0ZSB8ICBEZXNjcmlwY2nDs24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8Cnw6LS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLS0tLS0tLS18Oi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18CnxgYXJpbWEuc2ltYCAgICB8c3RhdHMgIHxnZW5lcmEgdW5hIHNpbXVsYWNpw7NuIGRlIHVuIHByb2Nlc28gQVJJTUEgICAgICAgICAgICAgICB8CnxgQXJpbWFgICAgICAgICB8Zm9yZWNhc3QgIHxlc3RpbWEgdW4gcHJvY2VzbyBBUklNQSB8CnxgYXV0by5hcmltYWAgICB8Zm9yZWNhc3QgIHxpZGVudGlmaWNhY2nDs24gYXV0b23DoXRpY2EgZGUgdW4gbW9kZWxvIEFSSU1BICAgICAgICAgIHwKfGB3YWxkLnRlc3RgICAgIHxhb2QgICAgfGNvbnRyYXN0YSBsYSBzaWduaWZpY2F0aXZpZGFkIGNvbmp1bnRhIGRlIHZhcmlvcyBwYXLDoW1ldHJvc3wKfGBmb3JlY2FzdGAgICAgIHxmb3JlY2FzdCAgfHJlYWxpemEgdW5hIHByZWRpY2Npw7NuIGRlIHVuIG1vZGVsb3wKfGBCb3gudGVzdGAgICAgIHxzdGF0cyAgfHBydWViYSBkZSBpbmRlcGVuZGVuY2lhIGRlIHVuYSBzZXJpZSB0ZW1wb3JhbCAgICAgICAgICAgfAp8YHNoYXBpcm8udGVzdGAgfHN0YXRzICB8cHJ1ZWJhIGRlIG5vcm1hbGlkYWQgZGUgU2hhcGlyby1XaWxrcyAgICAgICAgICAgICAgICAgICB8CnxgamFycXVlLmJlcmEudGVzdGAgfHRzZXJpZXMgICAgfHBydWViYSBkZSBub3JtYWxpZGFkIGRlIEphcnF1ZS1CZXJhICAgICAgICAgIHwKClwKXAoKCiMgUmVmZXJlbmNpYXMKCiogQm94LCBHLiBFLlAuIHkgSmVua2lucywgRy4gKDE5NzYpLiBfVGltZSBTZXJpZXMgQW5hbHlzaXM6IEZvcmVjYXN0aW5nIGFuZCBDb250cm9sXyAgRWRpdGFkbyBwb3IgSG9sZGVuLURheSwgU2FuIEZyYW5jaXNjbywgQ0EKClwKXApcClwKCgo=</div>
<footer class="footer">
  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<br>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.  <div class="text-muted">Website created by Iv&aacute;n Arribas. &copy;  2020. If you find any bugs please report them to <a href="mailto:ivan.arribas@uv.es"> ivan.arribas@uv.es</a>.</div>
  
</footer>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("03-04-Tema4.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
