<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Iván Arribas (Depto. Análisis Económico. Universitat de València)" />


<title>Defunciones por Enfermedades Cerebrovasculares</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Series Temporales</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="01-Guia-curso.html">
    <span class="fa fa-graduation-cap"></span>
     
    Guía del curso
  </a>
</li>
<li>
  <a href="02-Logistica.html">
    <span class="fa fa-laptop"></span>
     
    Logística
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Diapos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Teoría</li>
    <li>
      <a href="03-01-Tema1.html">Tema 1: Introducción</a>
    </li>
    <li>
      <a href="03-02-Tema2.html">Tema 2: Alisado</a>
    </li>
    <li>
      <a href="03-03-Tema3.html">Tema 3: Procesos estocásticos</a>
    </li>
    <li>
      <a href="03-04-Tema4.html">Tema 4: ARIMA</a>
    </li>
    <li>
      <a href="03-05-Tema5.html">Tema 5: SARIMA</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Ejemplo de aplicación</li>
    <li>
      <a href="03-06-Ejemplo1.html">Ejemplo Tema 1</a>
    </li>
    <li>
      <a href="03-07-Ejemplo2.html">Ejemplo Tema 2</a>
    </li>
    <li>
      <a href="03-08-Ejemplo3.html">Ejemplo Tema 3</a>
    </li>
    <li>
      <a href="03-09-Ejemplo4.html">Ejemplo Tema 4</a>
    </li>
    <li>
      <a href="03-10-Ejemplo5.html">Ejemplo Tema 5</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otro ejemplo</li>
    <li>
      <a href="03-11-Ejemplo-Pasajeros.html">Ejemplo de Pasajeros</a>
    </li>
  </ul>
</li>
<li>
  <a href="04-Recursos-R.html">
    <span class="fa fa-code"></span>
     
    Recursos de R
  </a>
</li>
<li>
  <a href="05-Practica.html">
    <span class="fa fa-edit"></span>
     
    Practica
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-download"></span>
     
    Más
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">R</li>
    <li>
      <a href="https://cran.r-project.org">Dónde está R</a>
    </li>
    <li>
      <a href="https://rstudio.com">Donde está RStudio</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Markdown</li>
    <li>
      <a href="https://bookdown.org/yihui/rmarkdown/">Markdown</a>
    </li>
    <li>
      <a href="https://rmarkdown.rstudio.com/lesson-1.html">R Markdown</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Otros</li>
    <li>
      <a href="https://www.r-bloggers.com">Blog sobre R</a>
    </li>
    <li>
      <a href="https://bookdown.org">Libros online que debes conocer</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Defunciones por Enfermedades Cerebrovasculares</h1>
<h3 class="subtitle">Procesos ARIMA (sin estacionalidad)</h3>
<h4 class="author">Iván Arribas (Depto. Análisis Económico. Universitat de València)</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introducción"><span class="toc-section-number">1</span> Introducción</a></li>
<li><a href="#transformación-de-la-serie"><span class="toc-section-number">2</span> Transformación de la serie</a></li>
<li><a href="#identificación"><span class="toc-section-number">3</span> Identificación</a></li>
<li><a href="#validación"><span class="toc-section-number">4</span> Validación</a></li>
<li><a href="#interpretación-del-modelo"><span class="toc-section-number">5</span> Interpretación del modelo</a></li>
<li><a href="#predicción"><span class="toc-section-number">6</span> Predicción</a></li>
<li><a href="#calidad-de-las-previsiones-extra-muestrales-según-horizonte-temporal"><span class="toc-section-number">7</span> Calidad de las previsiones extra-muestrales según horizonte temporal</a></li>
<li><a href="#comparación-con-un-modelo-de-alisado"><span class="toc-section-number">8</span> Comparación con un modelo de Alisado</a></li>
</ul>
</div>

<p><br />
<br />
</p>
<div id="introducción" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción</h1>
<p>Consideremos de nuevo la serie temporal correspondiente al número de defunciones causadas por enfermedades cerebrovasculares, Esta serie está disponible en el Instituto Nacional de Estadística desde enero de 1980 hasta diciembre de 2018, un total de 39 años o 468 meses</p>
<p>En la descriptiva vimos que la descomposición revelaba la presencia de varios valores atípicos concentrados al inicio de la serie. Por este motivo, para su análisis por modelos ARIMA vamos a recortar la serie, que empezará el enero de 1988 y a anualizarla (31 años).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>DefEnfCer <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./series/Enfermedades cerebrovasculares.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>DefEnfCer <span class="ot">&lt;-</span> <span class="fu">ts</span>(DefEnfCer[,<span class="dv">2</span>],<span class="at">start =</span> <span class="dv">1980</span>, <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>DefEnfCer <span class="ot">&lt;-</span> <span class="fu">window</span>(DefEnfCer, <span class="at">start =</span> <span class="dv">1988</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>DefEnfCer <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(DefEnfCer, <span class="at">FUN =</span> sum)</span></code></pre></div>
<p><br />
<br />
</p>
</div>
<div id="transformación-de-la-serie" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Transformación de la serie</h1>
<p>Por un lado, el parámetro <span class="math inline">\(\lambda\)</span> óptimo en la transformación de Box-Cox es -0.81, así que no se realizará ninguna transformación logarítmica.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BoxCox.lambda</span>(DefEnfCer)</span></code></pre></div>
<pre><code>[1] -0.8126561</code></pre>
<p>Por otro lado, en el análisis previo se vio que la serie anual hay que diferenciarla una vez para que sea estacionaria. Por tanto, se opta por considerar <span class="math inline">\(d=1\)</span> o <span class="math inline">\(DefEnfCer \sim I(1)\)</span>.</p>
<p><br />
<br />
</p>
</div>
<div id="identificación" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Identificación</h1>
<p>Veamos ahora a identificar los valores de <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a partir de la FAC y la FACP. Difícil decidirse entre un AR(1), un MA(1) o incluso un ARMA(1, 1).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtsdisplay</span>(<span class="fu">diff</span>(DefEnfCer), <span class="at">main =</span> <span class="st">&quot;Figura 1. Def. por enf. cerebrovasculares (dif.)&quot;</span>)</span></code></pre></div>
<p><img src="03-09-Ejemplo4_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>¿Qué recomienda <code>auto.arima</code>? Un ARIMA(1, 1, 0) con deriva.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(DefEnfCer, <span class="at">d =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Series: DefEnfCer 
ARIMA(1,1,0) with drift 

Coefficients:
          ar1      drift
      -0.5696  -606.8375
s.e.   0.1435    93.5852

sigma^2 estimated as 676809:  log likelihood=-243.1
AIC=492.21   AICc=493.13   BIC=496.41</code></pre>
<p>La estimación de este modelo muestra que los dos coeficientes estimados son aparentemente significativos y que nos hay valores extremos (figura 2).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>arima110 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(DefEnfCer, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">residuals</span>(arima110)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sderror <span class="ot">&lt;-</span> <span class="fu">sd</span>(error)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(error, <span class="at">series=</span><span class="st">&quot;Error&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;Error&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">&quot;Figura 2. Error + Intervención&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)<span class="sc">*</span>sderror, </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1988</span>, <span class="dv">2018</span>, <span class="dv">4</span>)) </span></code></pre></div>
<p><img src="03-09-Ejemplo4_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
<br />
</p>
</div>
<div id="validación" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Validación</h1>
<div id="variables-son-significativas" class="section level3 unnumbered">
<h3 class="unnumbered">Variables son significativas</h3>
<p>Los dos coeficientes estimados (<span class="math inline">\(\phi_1\)</span> y <span class="math inline">\(\mu\)</span>) son significativos.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: phi1 = 0</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima110), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima110), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 15.7, df = 1, P(&gt; X2) = 7.2e-05</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: deriva</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima110), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima110), <span class="at">Terms =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 42.0, df = 1, P(&gt; X2) = 8.9e-11</code></pre>
<p><br />
</p>
</div>
<div id="medidas-de-error" class="section level3 unnumbered">
<h3 class="unnumbered">Medidas de error</h3>
<p>El error medio es 782 defunciones (RMSE) y el error porcentual medio es 1.7% (MAPE).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(arima110)</span></code></pre></div>
<pre><code>                ME   RMSE    MAE   MPE MAPE MASE  ACF1
Training set -0.71 781.86 591.48 -0.01  1.7 0.62 -0.12</code></pre>
<p><br />
</p>
</div>
<div id="incorrelación-homocedasticidad-y-normalidad" class="section level3 unnumbered">
<h3 class="unnumbered">Incorrelación, Homocedasticidad y Normalidad</h3>
<p>Veamos ahora si el residuo es ruido blanco:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error
X-squared = 2.0985, df = 2, p-value = 0.3502</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(error<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>) </span></code></pre></div>
<pre><code>
    Box-Ljung test

data:  error^2
X-squared = 2.6067, df = 2, p-value = 0.2716</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(error)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  error
W = 0.90145, p-value = 0.007838</code></pre>
<p>Las hipótesis de incorrelación y homocedasticidad se aceptan. También se aceptarían para otros valores de <span class="math inline">\(k\)</span> razonables. Sin embargo, no se acepta la hipótesis de normalidad, por lo que toda la inferencia realizada queda invalidada. Sin embargo, esto no impide usar el modelo ARIMA para predecir.</p>
<p><br />
<br />
</p>
</div>
</div>
<div id="interpretación-del-modelo" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Interpretación del modelo</h1>
<p>El <strong>modelo teórico</strong> es <span class="math inline">\(DefEnfCer \sim ARIMA(1,1,0)\)</span> + constante: <span class="math display">\[(1 - \phi_1 L)(1 - L) DefEnfCer_t =  c + \varepsilon_t.\]</span></p>
<p>Desarrollando queda: <span class="math display">\[DefEnfCer_t = c + DefEnfCer_{t-1} + \phi_1(DefEnfCer_{t-1}-DefEnfCer_{t-2}) + \varepsilon_t\]</span></p>
<p>Finalmente. el <strong>modelo estimado</strong> es (recuerda que <span class="math inline">\(c = (1 - \phi_1)\mu\)</span>): <span class="math display">\[\widehat{DefEnfCer}_t = -952.49 + DefEnfCer_{t-1} - 0.57(DefEnfCer_{t-1}-DefEnfCer_{t-2}) \]</span> Cada año el número de defunciones por enfermedades cerebrovasculares es el mismo que el año previo, menos 952.5 casos, menos un 57% de la ultima variación observada.</p>
<p><br />
<br />
</p>
</div>
<div id="predicción" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Predicción</h1>
<p>Podemos usar el modelo estimado para predecir los casos de defunciones por enfermedad cerebrovascular para los próximos 5 años.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>parima110 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima110, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">h =</span> <span class="dv">5</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">level =</span> <span class="dv">95</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>parima110</span></code></pre></div>
<pre><code>     Point Forecast    Lo 95    Hi 95
2019       25761.99 24149.56 27374.42
2020       25184.30 23428.85 26939.75
2021       24560.86 22424.74 26696.98
2022       23963.48 21637.99 26288.97
2023       23351.26 20783.46 25919.06</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(parima110, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Defunciones&quot;</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Figura 3. Defunciones por enfermedades cerebrovasculares&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span> <span class="fu">seq</span>(<span class="dv">1988</span>, <span class="dv">2023</span>, <span class="dv">4</span>)) </span></code></pre></div>
<p><img src="03-09-Ejemplo4_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>El modelo predice un descenso anual en el número de defunciones de aproximadamente 600 casos.</p>
<p><br />
<br />
</p>
</div>
<div id="calidad-de-las-previsiones-extra-muestrales-según-horizonte-temporal" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> Calidad de las previsiones extra-muestrales según horizonte temporal</h1>
<p>Vamos a aplicar la metodología de origen de predicción móvil a la serie. Asumimos que se precisan veinte años para hacer una buena estimación, <span class="math inline">\(k=20\)</span>, y que el horizonte temporal es cinco años, <span class="math inline">\(h = 5\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">20</span>                   </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">5</span>                    </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>TT <span class="ot">&lt;-</span> <span class="fu">length</span>(DefEnfCer)   </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> TT<span class="sc">-</span>k<span class="sc">-</span>h               </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mapeArima <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, s <span class="sc">+</span> <span class="dv">1</span>, h)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>s) {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  train.set <span class="ot">&lt;-</span> <span class="fu">subset</span>(DefEnfCer, <span class="at">start =</span> i <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  test.set <span class="ot">&lt;-</span>  <span class="fu">subset</span>(DefEnfCer, <span class="at">start =</span> i <span class="sc">+</span> k <span class="sc">+</span> <span class="dv">1</span>, <span class="at">end =</span> i <span class="sc">+</span> k <span class="sc">+</span> h)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">Arima</span>(train.set, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),<span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  fcast<span class="ot">&lt;-</span><span class="fu">forecast</span>(fit, <span class="at">h =</span> h)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  mapeArima[i <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">abs</span>(test.set <span class="sc">-</span> fcast<span class="sc">$</span>mean)<span class="sc">/</span>test.set</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>errorArima <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(mapeArima)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>errorArima</span></code></pre></div>
<pre><code>[1] 1.494510 2.388923 2.822362 3.334597 3.864334</code></pre>
<p>Se observa que: i) el error de predicción extra-muestral a un periodo vista (1.5%) es algo inferior al intra-muestral (1.7%); ii) conforme aumenta el horizonte temporal de previsión el error aumenta; y iii) en todo caso el error se mantiene bajo.</p>
<p><br />
<br />
</p>
</div>
<div id="comparación-con-un-modelo-de-alisado" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> Comparación con un modelo de Alisado</h1>
<p>Si estimamos la serie anual de Defunciones por enfermedades cerebrovasculares aplicando técnicas de alisado exponencial nos encontramos con un modelo con error y pendiente aditivas ETS(A,A,N). Además, <span class="math inline">\(\alpha = \beta = 0\)</span>. Si aplicamos estos valores a las ecuaciones iterativas de actualización tenemos que <span class="math inline">\(l_t = l_0\)</span> y que <span class="math inline">\(b_t = b_0\)</span>. Por tanto <span class="math inline">\(\widehat{y}_t = l_0 + t b_0\)</span>, un modelo lineal (<span class="math inline">\(\widehat{y}_t = 45808.75 - 655.37\cdot t\)</span>).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(alisado <span class="ot">&lt;-</span> <span class="fu">ets</span>(DefEnfCer))</span></code></pre></div>
<pre><code>ETS(A,A,N) 

Call:
 ets(y = DefEnfCer) 

  Smoothing parameters:
    alpha = 1e-04 
    beta  = 1e-04 

  Initial states:
    l = 45808.7528 
    b = -655.3721 

  sigma:  799.9925

     AIC     AICc      BIC 
526.6163 529.0163 533.7862 

Training set error measures:
                    ME     RMSE      MAE        MPE     MAPE      MASE
Training set -116.3082 746.5983 616.4059 -0.2799447 1.811351 0.6496918
                  ACF1
Training set 0.1025637</code></pre>
<p>La calidad del ajuste del modelo de alisado es similar a la del modelo ARIMA: MAPE de 1.8% para el primero frente a 1.7% para el segundo; RMSE de 747 para el primero frente a 782 para el segundo. Más aún, si se aplica la metodología de origen de predicción móvil al modelo de alisado, el error a un periodo vista es del 2.1%, pero a cinco periodos vista se mantiene en el 3%. Es resumen, el mejor modelo depende del criterio considerado y del horizonte temporal de previsión.</p>
<p>Finalmente, las predicciones realizadas con ambos modelos son prácticamente las mismas como se puede observar.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>palisado <span class="ot">&lt;-</span> <span class="fu">forecast</span>(alisado, <span class="at">h =</span> <span class="dv">5</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(DefEnfCer,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">series =</span> <span class="st">&quot;Defunciones Enf. Cerebrovasculares&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="st">&quot;Figura 4. Defunciones Enf. Cerebrovasculares y previsión&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">&quot;Defunciones&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(parima110<span class="sc">$</span>mean, <span class="at">series =</span> <span class="st">&quot;Previsión con Arima&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(palisado<span class="sc">$</span>mean, <span class="at">series =</span> <span class="st">&quot;Previsión con Alisado&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Predicción&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">0.98</span>), <span class="at">legend.justification=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="03-09-Ejemplo4_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>En definitiva, para esta serie, que es corta y aparentemente sencilla, la aproximación por la metodología ARIMA no mejora sustancialmente el modelo de Alisado exponencial, más fácil de obtener e interpretar.</p>
<p><br />
<br />
<br />
<br />
</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGVmdW5jaW9uZXMgcG9yIEVuZmVybWVkYWRlcyBDZXJlYnJvdmFzY3VsYXJlcyIKc3VidGl0bGU6ICJQcm9jZXNvcyBBUklNQSAoc2luIGVzdGFjaW9uYWxpZGFkKSIKYXV0aG9yOiAiSXbDoW4gQXJyaWJhcyAoRGVwdG8uIEFuw6FsaXNpcyBFY29uw7NtaWNvLiBVbml2ZXJzaXRhdCBkZSBWYWzDqG5jaWEpIgpvdXRwdXQ6IAogIGh0bWxfZG9jdW1lbnQ6CiAgICB0aGVtZTogY2VydWxlYW4KICAgIGhpZ2hsaWdodDogcHlnbWVudHMgCiAgICBmaWdfY2FwdGlvbjogZmFsc2UKICAgIGRmX3ByaW50OiBrYWJsZQogICAgdG9jOiB0cnVlCiAgICB0b2NfZGVwdGg6IDIKICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQogICAgc2VsZl9jb250YWluZWQ6IHRydWUKICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgpgYGB7ciBjaHVua19zZXR1cCwgZWNobyA9IEZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQod2FybmluZyA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGQUxTRSwgCiAgICAgICAgICAgICAgICAgICAgICBjb21tZW50ID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIiwgCiAgICAgICAgICAgICAgICAgICAgICBmaWcuc2hvdyA9ICJob2xkIiwKICAgICAgICAgICAgICAgICAgICAgIGZpZy5oZWlnaHQgPSA0LAogICAgICAgICAgICAgICAgICAgICAgZmlnLndpZHRoID0gOCwKICAgICAgICAgICAgICAgICAgICAgIG91dC53aWR0aCA9ICI4MCUiKSAKYGBgCgpgYGB7ciBsaWJyZXJpYXMsIGVjaG8gPSBGQUxTRX0KbGlicmFyeShmb3JlY2FzdCkKbGlicmFyeShnZ3Bsb3QyKTsgdGhlbWVfc2V0KHRoZW1lX2J3KCkpCmxpYnJhcnkoZ3JpZEV4dHJhKQpsaWJyYXJ5KGdyaWQpCmxpYnJhcnkodHNlcmllcykKbGlicmFyeShhb2QpCmBgYAoKXApcCgojIEludHJvZHVjY2nDs24KCkNvbnNpZGVyZW1vcyBkZSBudWV2byBsYSBzZXJpZSB0ZW1wb3JhbCBjb3JyZXNwb25kaWVudGUgYWwgbsO6bWVybyBkZSBkZWZ1bmNpb25lcyBjYXVzYWRhcyBwb3IgZW5mZXJtZWRhZGVzIGNlcmVicm92YXNjdWxhcmVzLCBFc3RhIHNlcmllIGVzdMOhIGRpc3BvbmlibGUgZW4gZWwgSW5zdGl0dXRvIE5hY2lvbmFsIGRlIEVzdGFkw61zdGljYSBkZXNkZSBlbmVybyBkZSAxOTgwIGhhc3RhIGRpY2llbWJyZSBkZSAyMDE4LCB1biB0b3RhbCBkZSAzOSBhw7FvcyBvIDQ2OCBtZXNlcwoKRW4gbGEgZGVzY3JpcHRpdmEgdmltb3MgcXVlIGxhIGRlc2NvbXBvc2ljacOzbiByZXZlbGFiYSBsYSBwcmVzZW5jaWEgZGUgdmFyaW9zIHZhbG9yZXMgYXTDrXBpY29zIGNvbmNlbnRyYWRvcyBhbCBpbmljaW8gZGUgbGEgc2VyaWUuIFBvciBlc3RlIG1vdGl2bywgcGFyYSBzdSBhbsOhbGlzaXMgcG9yIG1vZGVsb3MgQVJJTUEgdmFtb3MgYSByZWNvcnRhciBsYSBzZXJpZSwgcXVlIGVtcGV6YXLDoSBlbCBlbmVybyBkZSAxOTg4IHkgYSBhbnVhbGl6YXJsYSAoMzEgYcOxb3MpLgoKYGBge3J9CkRlZkVuZkNlciA8LSByZWFkLmNzdjIoIi4vc2VyaWVzL0VuZmVybWVkYWRlcyBjZXJlYnJvdmFzY3VsYXJlcy5jc3YiLCBoZWFkZXIgPSBUUlVFKQpEZWZFbmZDZXIgPC0gdHMoRGVmRW5mQ2VyWywyXSxzdGFydCA9IDE5ODAsIGZyZXEgPSAxMikKRGVmRW5mQ2VyIDwtIHdpbmRvdyhEZWZFbmZDZXIsIHN0YXJ0ID0gMTk4OCkKRGVmRW5mQ2VyIDwtIGFnZ3JlZ2F0ZShEZWZFbmZDZXIsIEZVTiA9IHN1bSkKYGBgCgpcClwKCiMgVHJhbnNmb3JtYWNpw7NuIGRlIGxhIHNlcmllCgpQb3IgdW4gbGFkbywgZWwgcGFyw6FtZXRybyAkXGxhbWJkYSQgw7NwdGltbyBlbiBsYSB0cmFuc2Zvcm1hY2nDs24gZGUgQm94LUNveCBlcyAtMC44MSwgYXPDrSBxdWUgbm8gc2UgcmVhbGl6YXLDoSBuaW5ndW5hIHRyYW5zZm9ybWFjacOzbiBsb2dhcsOtdG1pY2EuCgpgYGB7cn0KQm94Q294LmxhbWJkYShEZWZFbmZDZXIpCmBgYAoKUG9yIG90cm8gbGFkbywgZW4gZWwgYW7DoWxpc2lzIHByZXZpbyBzZSB2aW8gcXVlIGxhIHNlcmllIGFudWFsIGhheSBxdWUgZGlmZXJlbmNpYXJsYSB1bmEgdmV6IHBhcmEgcXVlIHNlYSBlc3RhY2lvbmFyaWEuIFBvciB0YW50bywgc2Ugb3B0YSBwb3IgY29uc2lkZXJhciAkZD0xJCBvICREZWZFbmZDZXIgXHNpbSBJKDEpJC4KClwKXAoKIyBJZGVudGlmaWNhY2nDs24KClZlYW1vcyBhaG9yYSBhIGlkZW50aWZpY2FyIGxvcyB2YWxvcmVzIGRlICRwJCB5ICRxJCBhIHBhcnRpciBkZSBsYSBGQUMgeSBsYSBGQUNQLiBEaWbDrWNpbCBkZWNpZGlyc2UgZW50cmUgdW4gQVIoMSksIHVuIE1BKDEpIG8gaW5jbHVzbyB1biBBUk1BKDEsIDEpLgoKYGBge3J9IApnZ3RzZGlzcGxheShkaWZmKERlZkVuZkNlciksIG1haW4gPSAiRmlndXJhIDEuIERlZi4gcG9yIGVuZi4gY2VyZWJyb3Zhc2N1bGFyZXMgKGRpZi4pIikKYGBgCgrCv1F1w6kgcmVjb21pZW5kYSBgYXV0by5hcmltYWA/IFVuIEFSSU1BKDEsIDEsIDApIGNvbiBkZXJpdmEuCgpgYGB7cn0gCmF1dG8uYXJpbWEoRGVmRW5mQ2VyLCBkID0gMSkKYGBgCgpMYSBlc3RpbWFjacOzbiBkZSBlc3RlIG1vZGVsbyBtdWVzdHJhIHF1ZSBsb3MgZG9zIGNvZWZpY2llbnRlcyBlc3RpbWFkb3Mgc29uIGFwYXJlbnRlbWVudGUgc2lnbmlmaWNhdGl2b3MgeSBxdWUgbm9zIGhheSB2YWxvcmVzIGV4dHJlbW9zIChmaWd1cmEgMikuCgpgYGB7cn0KYXJpbWExMTAgPC0gQXJpbWEoRGVmRW5mQ2VyLCAKICAgICAgICAgICAgICAgICAgb3JkZXIgPSBjKDEsIDEsIDApLAogICAgICAgICAgICAgICAgICBpbmNsdWRlLmNvbnN0YW50ID0gVFJVRSkKCmVycm9yIDwtIHJlc2lkdWFscyhhcmltYTExMCkKc2RlcnJvciA8LSBzZChlcnJvcikKCmF1dG9wbG90KGVycm9yLCBzZXJpZXM9IkVycm9yIiwKICAgICAgICAgY29sb3VyID0gImJsYWNrIiwKICAgICAgICAgeGxhYiA9ICIiLAogICAgICAgICB5bGFiID0gIkVycm9yIiwKICAgICAgICAgbWFpbiA9ICJGaWd1cmEgMi4gRXJyb3IgKyBJbnRlcnZlbmNpw7NuIikgKwogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IGMoLTMsIC0yLCAyLCAzKSpzZGVycm9yLCAKICAgICAgICAgICAgIGNvbG91ciA9IGMoInJlZCIsICJncmVlbiIsICJncmVlbiIsICJyZWQiKSwgCiAgICAgICAgICAgICBsdHkgPSAyKSArIAogIGdlb21fcG9pbnQoKSArCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcz0gc2VxKDE5ODgsIDIwMTgsIDQpKSAKYGBgCgpcClwKCiMgVmFsaWRhY2nDs24KCiMjIyBWYXJpYWJsZXMgc29uIHNpZ25pZmljYXRpdmFzIHstfQoKTG9zIGRvcyBjb2VmaWNpZW50ZXMgZXN0aW1hZG9zICgkXHBoaV8xJCB5ICRcbXUkKSBzb24gc2lnbmlmaWNhdGl2b3MuCgpgYGB7cn0KIyBIMDogcGhpMSA9IDAKd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMTEwKSwgU2lnbWEgPSB2Y292KGFyaW1hMTEwKSwgVGVybXMgPSAxKQojIEgwOiBkZXJpdmEKd2FsZC50ZXN0KGIgPSBjb2VmKGFyaW1hMTEwKSwgU2lnbWEgPSB2Y292KGFyaW1hMTEwKSwgVGVybXMgPSAyKQpgYGAKClwKCiMjIyBNZWRpZGFzIGRlIGVycm9yIHstfQoKRWwgZXJyb3IgbWVkaW8gZXMgYHIgcm91bmQoYWNjdXJhY3koYXJpbWExMTApWzJdLDApYCBkZWZ1bmNpb25lcyAoUk1TRSkgeSBlbCBlcnJvciBwb3JjZW50dWFsIG1lZGlvIGVzIGByIHJvdW5kKGFjY3VyYWN5KGFyaW1hMTEwKVs1XSwyKWAlIChNQVBFKS4KCmBgYHtyLCBldmFsPUZBTFNFfQphY2N1cmFjeShhcmltYTExMCkKYGBgCgpgYGB7cixlY2hvPUZBTFNFfQpyb3VuZChhY2N1cmFjeShhcmltYTExMCksMikKYGBgCgpcCgojIyMgSW5jb3JyZWxhY2nDs24sIEhvbW9jZWRhc3RpY2lkYWQgeSBOb3JtYWxpZGFkIHstfSAgCgpWZWFtb3MgYWhvcmEgc2kgZWwgcmVzaWR1byBlcyBydWlkbyBibGFuY286CgpgYGB7cn0KQm94LnRlc3QoZXJyb3IsIGxhZyA9IDIsIHR5cGUgPSAiTGp1bmctQm94IikKQm94LnRlc3QoZXJyb3JeMiwgbGFnID0gMiwgdHlwZSA9ICJManVuZy1Cb3giKSAKc2hhcGlyby50ZXN0KGVycm9yKQpgYGAKCgpMYXMgaGlww7N0ZXNpcyBkZSBpbmNvcnJlbGFjacOzbiB5IGhvbW9jZWRhc3RpY2lkYWQgc2UgYWNlcHRhbi4gVGFtYmnDqW4gc2UgYWNlcHRhcsOtYW4gcGFyYSBvdHJvcyB2YWxvcmVzIGRlICRrJCByYXpvbmFibGVzLiBTaW4gZW1iYXJnbywgbm8gc2UgYWNlcHRhIGxhIGhpcMOzdGVzaXMgZGUgbm9ybWFsaWRhZCwgcG9yIGxvIHF1ZSB0b2RhIGxhIGluZmVyZW5jaWEgcmVhbGl6YWRhIHF1ZWRhIGludmFsaWRhZGEuIFNpbiBlbWJhcmdvLCBlc3RvIG5vIGltcGlkZSB1c2FyIGVsIG1vZGVsbyBBUklNQSBwYXJhIHByZWRlY2lyLiAKClwKXAoKIyBJbnRlcnByZXRhY2nDs24gZGVsIG1vZGVsbwoKRWwgX19tb2RlbG8gdGXDs3JpY29fXyBlcyAkRGVmRW5mQ2VyIFxzaW0gQVJJTUEoMSwxLDApJCArIGNvbnN0YW50ZToKJCQoMSAtIFxwaGlfMSBMKSgxIC0gTCkgRGVmRW5mQ2VyX3QgPSAgYyArIFx2YXJlcHNpbG9uX3QuJCQKCkRlc2Fycm9sbGFuZG8gcXVlZGE6CiQkRGVmRW5mQ2VyX3QgPSBjICsgRGVmRW5mQ2VyX3t0LTF9ICsgXHBoaV8xKERlZkVuZkNlcl97dC0xfS1EZWZFbmZDZXJfe3QtMn0pICsgXHZhcmVwc2lsb25fdCQkCgpGaW5hbG1lbnRlLiBlbCBfX21vZGVsbyBlc3RpbWFkb19fIGVzIChyZWN1ZXJkYSBxdWUgJGMgPSAoMSAtIFxwaGlfMSlcbXUkKToKJCRcd2lkZWhhdHtEZWZFbmZDZXJ9X3QgPSAtOTUyLjQ5ICsgRGVmRW5mQ2VyX3t0LTF9IC0gMC41NyhEZWZFbmZDZXJfe3QtMX0tRGVmRW5mQ2VyX3t0LTJ9KSAkJApDYWRhIGHDsW8gZWwgbsO6bWVybyBkZSBkZWZ1bmNpb25lcyBwb3IgZW5mZXJtZWRhZGVzIGNlcmVicm92YXNjdWxhcmVzIGVzIGVsIG1pc21vIHF1ZSBlbCBhw7FvIHByZXZpbywgbWVub3MgOTUyLjUgY2Fzb3MsIG1lbm9zIHVuIDU3JSBkZSBsYSB1bHRpbWEgdmFyaWFjacOzbiBvYnNlcnZhZGEuCgpcClwKCiMgUHJlZGljY2nDs24KClBvZGVtb3MgdXNhciBlbCBtb2RlbG8gZXN0aW1hZG8gcGFyYSBwcmVkZWNpciBsb3MgY2Fzb3MgZGUgZGVmdW5jaW9uZXMgcG9yIGVuZmVybWVkYWQgY2VyZWJyb3Zhc2N1bGFyIHBhcmEgbG9zIHByw7N4aW1vcyA1IGHDsW9zLgoKYGBge3J9CnBhcmltYTExMCA8LSBmb3JlY2FzdChhcmltYTExMCwgCiAgICAgICAgICAgICAgICAgICAgICBoID0gNSwgCiAgICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IDk1KQpwYXJpbWExMTAKYGBgCgpgYGB7cn0KYXV0b3Bsb3QocGFyaW1hMTEwLCAKICAgICB5bGFiID0gIkRlZnVuY2lvbmVzIiwKICAgICBtYWluID0gIkZpZ3VyYSAzLiBEZWZ1bmNpb25lcyBwb3IgZW5mZXJtZWRhZGVzIGNlcmVicm92YXNjdWxhcmVzIikgKwogIHNjYWxlX3hfY29udGludW91cyhicmVha3M9IHNlcSgxOTg4LCAyMDIzLCA0KSkgCmBgYAoKRWwgbW9kZWxvIHByZWRpY2UgdW4gZGVzY2Vuc28gYW51YWwgZW4gZWwgbsO6bWVybyBkZSBkZWZ1bmNpb25lcyBkZSBhcHJveGltYWRhbWVudGUgNjAwIGNhc29zLiAKClwKXAoKIyBDYWxpZGFkIGRlIGxhcyBwcmV2aXNpb25lcyBleHRyYS1tdWVzdHJhbGVzIHNlZ8O6biBob3Jpem9udGUgdGVtcG9yYWwKClZhbW9zIGEgYXBsaWNhciBsYSBtZXRvZG9sb2fDrWEgZGUgb3JpZ2VuIGRlIHByZWRpY2Npw7NuIG3Ds3ZpbCBhIGxhIHNlcmllLiBBc3VtaW1vcyBxdWUgc2UgcHJlY2lzYW4gdmVpbnRlIGHDsW9zIHBhcmEgaGFjZXIgdW5hIGJ1ZW5hIGVzdGltYWNpw7NuLCAkaz0yMCQsIHkgcXVlIGVsIGhvcml6b250ZSB0ZW1wb3JhbCBlcyBjaW5jbyBhw7FvcywgJGggPSA1JC4KICAKYGBge3J9ICAKayA8LSAyMCAgICAgICAgICAgICAgICAgICAKaCA8LSA1ICAgICAgICAgICAgICAgICAgICAKVFQgPC0gbGVuZ3RoKERlZkVuZkNlcikgICAKcyA8LSBUVC1rLWggICAgICAgICAgICAgICAKCm1hcGVBcmltYSA8LSBtYXRyaXgoTkEsIHMgKyAxLCBoKQpmb3IgKGkgaW4gMDpzKSB7CiAgdHJhaW4uc2V0IDwtIHN1YnNldChEZWZFbmZDZXIsIHN0YXJ0ID0gaSArIDEsIGVuZCA9IGkgKyBrKQogIHRlc3Quc2V0IDwtICBzdWJzZXQoRGVmRW5mQ2VyLCBzdGFydCA9IGkgKyBrICsgMSwgZW5kID0gaSArIGsgKyBoKQogIAogIGZpdCA8LSBBcmltYSh0cmFpbi5zZXQsIG9yZGVyID0gYygxLCAxLCAwKSxpbmNsdWRlLmNvbnN0YW50ID0gVFJVRSkKICBmY2FzdDwtZm9yZWNhc3QoZml0LCBoID0gaCkKICBtYXBlQXJpbWFbaSArIDEsXSA8LSAxMDAqYWJzKHRlc3Quc2V0IC0gZmNhc3QkbWVhbikvdGVzdC5zZXQKfQoKZXJyb3JBcmltYSA8LSBjb2xNZWFucyhtYXBlQXJpbWEpCmVycm9yQXJpbWEKYGBgCgpTZSBvYnNlcnZhIHF1ZTogaSkgZWwgZXJyb3IgZGUgcHJlZGljY2nDs24gZXh0cmEtbXVlc3RyYWwgYSB1biBwZXJpb2RvIHZpc3RhICgxLjUlKSBlcyBhbGdvIGluZmVyaW9yIGFsIGludHJhLW11ZXN0cmFsICgxLjclKTsgaWkpIGNvbmZvcm1lIGF1bWVudGEgZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGRlIHByZXZpc2nDs24gZWwgZXJyb3IgYXVtZW50YTsgeSBpaWkpIGVuIHRvZG8gY2FzbyBlbCBlcnJvciBzZSBtYW50aWVuZSBiYWpvLgoKXApcCgojIENvbXBhcmFjacOzbiBjb24gdW4gbW9kZWxvIGRlIEFsaXNhZG8KClNpIGVzdGltYW1vcyBsYSBzZXJpZSBhbnVhbCBkZSBEZWZ1bmNpb25lcyBwb3IgZW5mZXJtZWRhZGVzIGNlcmVicm92YXNjdWxhcmVzIGFwbGljYW5kbyB0w6ljbmljYXMgZGUgYWxpc2FkbyBleHBvbmVuY2lhbCBub3MgZW5jb250cmFtb3MgY29uIHVuIG1vZGVsbyBjb24gZXJyb3IgeSBwZW5kaWVudGUgYWRpdGl2YXMgRVRTKEEsQSxOKS4gQWRlbcOhcywgJFxhbHBoYSA9IFxiZXRhID0gMCQuIFNpIGFwbGljYW1vcyBlc3RvcyB2YWxvcmVzIGEgbGFzIGVjdWFjaW9uZXMgaXRlcmF0aXZhcyBkZSBhY3R1YWxpemFjacOzbiB0ZW5lbW9zIHF1ZSAkbF90ID0gbF8wJCB5IHF1ZSAkYl90ID0gYl8wJC4gUG9yIHRhbnRvICRcd2lkZWhhdHt5fV90ID0gbF8wICsgdCBiXzAkLCB1biBtb2RlbG8gbGluZWFsICgkXHdpZGVoYXR7eX1fdCA9IDQ1ODA4Ljc1IC0gNjU1LjM3XGNkb3QgdCQpLgoKYGBge3J9CnN1bW1hcnkoYWxpc2FkbyA8LSBldHMoRGVmRW5mQ2VyKSkKYGBgCgpMYSBjYWxpZGFkIGRlbCBhanVzdGUgZGVsIG1vZGVsbyBkZSBhbGlzYWRvIGVzIHNpbWlsYXIgYSBsYSBkZWwgbW9kZWxvIEFSSU1BOiBNQVBFIGRlIDEuOCUgcGFyYSBlbCBwcmltZXJvIGZyZW50ZSBhIDEuNyUgcGFyYSBlbCBzZWd1bmRvOyBSTVNFIGRlIDc0NyBwYXJhIGVsIHByaW1lcm8gZnJlbnRlIGEgNzgyIHBhcmEgZWwgc2VndW5kby4gTcOhcyBhw7puLCBzaSBzZSBhcGxpY2EgbGEgbWV0b2RvbG9nw61hIGRlIG9yaWdlbiBkZSBwcmVkaWNjacOzbiBtw7N2aWwgYWwgbW9kZWxvIGRlIGFsaXNhZG8sIGVsIGVycm9yIGEgdW4gcGVyaW9kbyB2aXN0YSBlcyBkZWwgMi4xJSwgcGVybyBhIGNpbmNvIHBlcmlvZG9zIHZpc3RhIHNlIG1hbnRpZW5lIGVuIGVsIDMlLiBFcyByZXN1bWVuLCBlbCBtZWpvciBtb2RlbG8gZGVwZW5kZSBkZWwgY3JpdGVyaW8gY29uc2lkZXJhZG8geSBkZWwgaG9yaXpvbnRlIHRlbXBvcmFsIGRlIHByZXZpc2nDs24uCgpGaW5hbG1lbnRlLCBsYXMgcHJlZGljY2lvbmVzIHJlYWxpemFkYXMgY29uIGFtYm9zIG1vZGVsb3Mgc29uIHByw6FjdGljYW1lbnRlIGxhcyBtaXNtYXMgY29tbyBzZSBwdWVkZSBvYnNlcnZhci4KCmBgYHtyfQpwYWxpc2FkbyA8LSBmb3JlY2FzdChhbGlzYWRvLCBoID0gNSkKYXV0b3Bsb3QoRGVmRW5mQ2VyLAogICAgICAgICBzZXJpZXMgPSAiRGVmdW5jaW9uZXMgRW5mLiBDZXJlYnJvdmFzY3VsYXJlcyIsCiAgICAgICAgIG1haW49IkZpZ3VyYSA0LiBEZWZ1bmNpb25lcyBFbmYuIENlcmVicm92YXNjdWxhcmVzIHkgcHJldmlzacOzbiIsCiAgICAgICAgIHhsYWI9IiIsIAogICAgICAgICB5bGFiPSJEZWZ1bmNpb25lcyIpICsKICBhdXRvbGF5ZXIocGFyaW1hMTEwJG1lYW4sIHNlcmllcyA9ICJQcmV2aXNpw7NuIGNvbiBBcmltYSIpICsKICBhdXRvbGF5ZXIocGFsaXNhZG8kbWVhbiwgc2VyaWVzID0gIlByZXZpc2nDs24gY29uIEFsaXNhZG8iKSArCiAgZ3VpZGVzKGNvbG91ciA9IGd1aWRlX2xlZ2VuZCh0aXRsZSA9ICJQcmVkaWNjacOzbiIpKSArIAogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbj1jKDAuOTgsMC45OCksIGxlZ2VuZC5qdXN0aWZpY2F0aW9uPWMoMSwxKSkKYGBgCgpFbiBkZWZpbml0aXZhLCBwYXJhIGVzdGEgc2VyaWUsIHF1ZSBlcyBjb3J0YSB5IGFwYXJlbnRlbWVudGUgc2VuY2lsbGEsIGxhIGFwcm94aW1hY2nDs24gcG9yIGxhIG1ldG9kb2xvZ8OtYSBBUklNQSBubyBtZWpvcmEgc3VzdGFuY2lhbG1lbnRlIGVsIG1vZGVsbyBkZSBBbGlzYWRvIGV4cG9uZW5jaWFsLCBtw6FzIGbDoWNpbCBkZSBvYnRlbmVyIGUgaW50ZXJwcmV0YXIuCgpcClwKXApcCg==</div>
<footer class="footer">
  
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a>
<br>
This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.  <div class="text-muted">Website created by Iv&aacute;n Arribas. &copy;  2020. If you find any bugs please report them to <a href="mailto:ivan.arribas@uv.es"> ivan.arribas@uv.es</a>.</div>
  
</footer>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("03-09-Ejemplo4.Rmd");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
